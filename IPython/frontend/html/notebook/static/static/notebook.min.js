var CodeMirror=(function(){function CodeMirror(place,givenOptions){var options={},defaults=CodeMirror.defaults;for(var opt in defaults)
if(defaults.hasOwnProperty(opt))
options[opt]=(givenOptions&&givenOptions.hasOwnProperty(opt)?givenOptions:defaults)[opt];var wrapper=document.createElement("div");wrapper.className="CodeMirror"+(options.lineWrapping?" CodeMirror-wrap":"");wrapper.innerHTML='<div style="overflow: hidden; position: relative; width: 3px; height: 0px;">'+'<textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" '+'autocorrect="off" autocapitalize="off"></textarea></div>'+'<div class="CodeMirror-scrollbar">'+'<div class="CodeMirror-scrollbar-inner">'+'</div></div>'+'<div class="CodeMirror-scroll" tabindex="-1">'+'<div style="position: relative">'+'<div style="position: relative">'+'<div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text"></div></div>'+'<div class="CodeMirror-lines"><div style="position: relative; z-index: 0">'+'<div style="position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden;"></div>'+'<pre class="CodeMirror-cursor">&#160;</pre>'+'<pre class="CodeMirror-cursor" style="visibility: hidden">&#160;</pre>'+'<div style="position: relative; z-index: -1"></div><div></div>'+'</div></div></div></div></div>';if(place.appendChild)place.appendChild(wrapper);else place(wrapper);var inputDiv=wrapper.firstChild,input=inputDiv.firstChild,scroller=wrapper.lastChild,code=scroller.firstChild,mover=code.firstChild,gutter=mover.firstChild,gutterText=gutter.firstChild,lineSpace=gutter.nextSibling.firstChild,measure=lineSpace.firstChild,cursor=measure.nextSibling,widthForcer=cursor.nextSibling,selectionDiv=widthForcer.nextSibling,lineDiv=selectionDiv.nextSibling,scrollbar=inputDiv.nextSibling,scrollbarInner=scrollbar.firstChild;themeChanged();keyMapChanged();if(ios)input.style.width="0px";if(!webkit)scroller.draggable=true;lineSpace.style.outline="none";if(options.tabindex!=null)input.tabIndex=options.tabindex;if(options.autofocus)focusInput();if(!options.gutter&&!options.lineNumbers)gutter.style.display="none";if(khtml)inputDiv.style.height="1px",inputDiv.style.position="absolute";if(mac_geLion){scrollbar.className+=(overlapScrollbars()?" cm-sb-overlap":" cm-sb-nonoverlap");}else if(ie_lt8){scrollbar.className+=" cm-sb-ie7";}
try{stringWidth("x");}
catch(e){if(e.message.match(/runtime/i))
e=new Error("A CodeMirror inside a P-style element does not work in Internet Explorer. (innerHTML bug)");throw e;}
var poll=new Delayed(),highlight=new Delayed(),blinker;var mode,doc=new BranchChunk([new LeafChunk([new Line("")])]),work,focused;loadMode();var sel={from:{line:0,ch:0},to:{line:0,ch:0},inverted:false};var shiftSelecting,lastClick,lastDoubleClick,lastScrollTop=0,lastScrollLeft=0,draggingText,overwrite=false,suppressEdits=false;var updateInput,userSelChange,changes,textChanged,selectionChanged,leaveInputAlone,gutterDirty,callbacks;var displayOffset=0,showingFrom=0,showingTo=0,lastSizeC=0;var bracketHighlighted;var maxLine="",updateMaxLine=false,maxLineChanged=true;var tabCache={};operation(function(){setValue(options.value||"");updateInput=false;})();var history=new History();connect(scroller,"mousedown",operation(onMouseDown));connect(scroller,"dblclick",operation(onDoubleClick));connect(lineSpace,"selectstart",e_preventDefault);if(!gecko)connect(scroller,"contextmenu",onContextMenu);connect(scroller,"scroll",onScroll);connect(scrollbar,"scroll",onScroll);connect(scrollbar,"mousedown",function(){if(focused)setTimeout(focusInput,0);});connect(scroller,"mousewheel",onMouseWheel);connect(scroller,"DOMMouseScroll",onMouseWheel);connect(window,"resize",function(){updateDisplay(true);});connect(input,"keyup",operation(onKeyUp));connect(input,"input",fastPoll);connect(input,"keydown",operation(onKeyDown));connect(input,"keypress",operation(onKeyPress));connect(input,"focus",onFocus);connect(input,"blur",onBlur);if(options.dragDrop){connect(scroller,"dragstart",onDragStart);function drag_(e){if(options.onDragEvent&&options.onDragEvent(instance,addStop(e)))return;e_stop(e);}
connect(scroller,"dragenter",drag_);connect(scroller,"dragover",drag_);connect(scroller,"drop",operation(onDrop));}
connect(scroller,"paste",function(){focusInput();fastPoll();});connect(input,"paste",fastPoll);connect(input,"cut",operation(function(){if(!options.readOnly)replaceSelection("");}));if(khtml)connect(code,"mouseup",function(){if(document.activeElement==input)input.blur();focusInput();});var hasFocus;try{hasFocus=(document.activeElement==input);}catch(e){}
if(hasFocus||options.autofocus)setTimeout(onFocus,20);else onBlur();function isLine(l){return l>=0&&l<doc.size;}
var instance=wrapper.CodeMirror={getValue:getValue,setValue:operation(setValue),getSelection:getSelection,replaceSelection:operation(replaceSelection),focus:function(){window.focus();focusInput();onFocus();fastPoll();},setOption:function(option,value){var oldVal=options[option];options[option]=value;if(option=="mode"||option=="indentUnit")loadMode();else if(option=="readOnly"&&value=="nocursor"){onBlur();input.blur();}
else if(option=="readOnly"&&!value){resetInput(true);}
else if(option=="theme")themeChanged();else if(option=="lineWrapping"&&oldVal!=value)operation(wrappingChanged)();else if(option=="tabSize")updateDisplay(true);else if(option=="keyMap")keyMapChanged();if(option=="lineNumbers"||option=="gutter"||option=="firstLineNumber"||option=="theme"){gutterChanged();updateDisplay(true);}},getOption:function(option){return options[option];},undo:operation(undo),redo:operation(redo),indentLine:operation(function(n,dir){if(typeof dir!="string"){if(dir==null)dir=options.smartIndent?"smart":"prev";else dir=dir?"add":"subtract";}
if(isLine(n))indentLine(n,dir);}),indentSelection:operation(indentSelected),historySize:function(){return{undo:history.done.length,redo:history.undone.length};},clearHistory:function(){history=new History();},setHistory:function(histData){history=new History();history.done=histData.done;history.undone=histData.undone;},getHistory:function(){history.time=0;return{done:history.done.concat([]),undone:history.undone.concat([])};},matchBrackets:operation(function(){matchBrackets(true);}),getTokenAt:operation(function(pos){pos=clipPos(pos);return getLine(pos.line).getTokenAt(mode,getStateBefore(pos.line),pos.ch);}),getStateAfter:function(line){line=clipLine(line==null?doc.size-1:line);return getStateBefore(line+1);},cursorCoords:function(start,mode){if(start==null)start=sel.inverted;return this.charCoords(start?sel.from:sel.to,mode);},charCoords:function(pos,mode){pos=clipPos(pos);if(mode=="local")return localCoords(pos,false);if(mode=="div")return localCoords(pos,true);return pageCoords(pos);},coordsChar:function(coords){var off=eltOffset(lineSpace);return coordsChar(coords.x-off.left,coords.y-off.top);},markText:operation(markText),setBookmark:setBookmark,findMarksAt:findMarksAt,setMarker:operation(addGutterMarker),clearMarker:operation(removeGutterMarker),setLineClass:operation(setLineClass),hideLine:operation(function(h){return setLineHidden(h,true);}),showLine:operation(function(h){return setLineHidden(h,false);}),onDeleteLine:function(line,f){if(typeof line=="number"){if(!isLine(line))return null;line=getLine(line);}
(line.handlers||(line.handlers=[])).push(f);return line;},lineInfo:lineInfo,addWidget:function(pos,node,scroll,vert,horiz){pos=localCoords(clipPos(pos));var top=pos.yBot,left=pos.x;node.style.position="absolute";code.appendChild(node);if(vert=="over")top=pos.y;else if(vert=="near"){var vspace=Math.max(scroller.offsetHeight,doc.height*textHeight()),hspace=Math.max(code.clientWidth,lineSpace.clientWidth)-paddingLeft();if(pos.yBot+node.offsetHeight>vspace&&pos.y>node.offsetHeight)
top=pos.y-node.offsetHeight;if(left+node.offsetWidth>hspace)
left=hspace-node.offsetWidth;}
node.style.top=(top+paddingTop())+"px";node.style.left=node.style.right="";if(horiz=="right"){left=code.clientWidth-node.offsetWidth;node.style.right="0px";}else{if(horiz=="left")left=0;else if(horiz=="middle")left=(code.clientWidth-node.offsetWidth)/2;node.style.left=(left+paddingLeft())+"px";}
if(scroll)
scrollIntoView(left,top,left+node.offsetWidth,top+node.offsetHeight);},lineCount:function(){return doc.size;},clipPos:clipPos,getCursor:function(start){if(start==null)start=sel.inverted;return copyPos(start?sel.from:sel.to);},somethingSelected:function(){return!posEq(sel.from,sel.to);},setCursor:operation(function(line,ch,user){if(ch==null&&typeof line.line=="number")setCursor(line.line,line.ch,user);else setCursor(line,ch,user);}),setSelection:operation(function(from,to,user){(user?setSelectionUser:setSelection)(clipPos(from),clipPos(to||from));}),getLine:function(line){if(isLine(line))return getLine(line).text;},getLineHandle:function(line){if(isLine(line))return getLine(line);},setLine:operation(function(line,text){if(isLine(line))replaceRange(text,{line:line,ch:0},{line:line,ch:getLine(line).text.length});}),removeLine:operation(function(line){if(isLine(line))replaceRange("",{line:line,ch:0},clipPos({line:line+1,ch:0}));}),replaceRange:operation(replaceRange),getRange:function(from,to,lineSep){return getRange(clipPos(from),clipPos(to),lineSep);},triggerOnKeyDown:operation(onKeyDown),execCommand:function(cmd){return commands[cmd](instance);},moveH:operation(moveH),deleteH:operation(deleteH),moveV:operation(moveV),toggleOverwrite:function(){if(overwrite){overwrite=false;cursor.className=cursor.className.replace(" CodeMirror-overwrite","");}else{overwrite=true;cursor.className+=" CodeMirror-overwrite";}},posFromIndex:function(off){var lineNo=0,ch;doc.iter(0,doc.size,function(line){var sz=line.text.length+1;if(sz>off){ch=off;return true;}
off-=sz;++lineNo;});return clipPos({line:lineNo,ch:ch});},indexFromPos:function(coords){if(coords.line<0||coords.ch<0)return 0;var index=coords.ch;doc.iter(0,coords.line,function(line){index+=line.text.length+1;});return index;},scrollTo:function(x,y){if(x!=null)scroller.scrollLeft=x;if(y!=null)scrollbar.scrollTop=y;updateDisplay([]);},getScrollInfo:function(){return{x:scroller.scrollLeft,y:scrollbar.scrollTop,height:scrollbar.scrollHeight,width:scroller.scrollWidth};},setSize:function(width,height){function interpret(val){val=String(val);return/^\d+$/.test(val)?val+"px":val;}
if(width!=null)wrapper.style.width=interpret(width);if(height!=null)scroller.style.height=interpret(height);},operation:function(f){return operation(f)();},compoundChange:function(f){return compoundChange(f);},refresh:function(){updateDisplay(true,null,lastScrollTop);if(scrollbar.scrollHeight>lastScrollTop)
scrollbar.scrollTop=lastScrollTop;},getInputField:function(){return input;},getWrapperElement:function(){return wrapper;},getScrollerElement:function(){return scroller;},getGutterElement:function(){return gutter;}};function getLine(n){return getLineAt(doc,n);}
function updateLineHeight(line,height){gutterDirty=true;var diff=height-line.height;for(var n=line;n;n=n.parent)n.height+=diff;}
function setValue(code){var top={line:0,ch:0};updateLines(top,{line:doc.size-1,ch:getLine(doc.size-1).text.length},splitLines(code),top,top);updateInput=true;}
function getValue(lineSep){var text=[];doc.iter(0,doc.size,function(line){text.push(line.text);});return text.join(lineSep||"\n");}
function onScroll(e){if(scroller.scrollTop){scrollbar.scrollTop+=scroller.scrollTop;scroller.scrollTop=0;}
if(lastScrollTop!=scrollbar.scrollTop||lastScrollLeft!=scroller.scrollLeft){lastScrollTop=scrollbar.scrollTop;lastScrollLeft=scroller.scrollLeft;updateDisplay([]);if(options.fixedGutter)gutter.style.left=scroller.scrollLeft+"px";if(options.onScroll)options.onScroll(instance);}}
function onMouseDown(e){setShift(e_prop(e,"shiftKey"));for(var n=e_target(e);n!=wrapper;n=n.parentNode)
if(n.parentNode==code&&n!=mover)return;for(var n=e_target(e);n!=wrapper;n=n.parentNode)
if(n.parentNode==gutterText){if(options.onGutterClick)
options.onGutterClick(instance,indexOf(gutterText.childNodes,n)+showingFrom,e);return e_preventDefault(e);}
var start=posFromMouse(e);switch(e_button(e)){case 3:if(gecko)onContextMenu(e);return;case 2:if(start)setCursor(start.line,start.ch,true);setTimeout(focusInput,20);e_preventDefault(e);return;}
if(!start){if(e_target(e)==scroller)e_preventDefault(e);return;}
if(!focused)onFocus();var now=+new Date,type="single";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start)){type="triple";e_preventDefault(e);setTimeout(focusInput,20);selectLine(start.line);}else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type="double";lastDoubleClick={time:now,pos:start};e_preventDefault(e);var word=findWordAt(start);setSelectionUser(word.from,word.to);}else{lastClick={time:now,pos:start};}
var last=start,going;if(options.dragDrop&&dragAndDrop&&!options.readOnly&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&type=="single"){if(webkit)scroller.draggable=true;function dragEnd(e2){if(webkit)scroller.draggable=false;draggingText=false;up();drop();if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);setCursor(start.line,start.ch,true);focusInput();}}
var up=connect(document,"mouseup",operation(dragEnd),true);var drop=connect(scroller,"drop",operation(dragEnd),true);draggingText=true;if(scroller.dragDrop)scroller.dragDrop();return;}
e_preventDefault(e);if(type=="single")setCursor(start.line,start.ch,true);var startstart=sel.from,startend=sel.to;function doSelect(cur){if(type=="single"){setSelectionUser(start,cur);}else if(type=="double"){var word=findWordAt(cur);if(posLess(cur,startstart))setSelectionUser(word.from,startend);else setSelectionUser(startstart,word.to);}else if(type=="triple"){if(posLess(cur,startstart))setSelectionUser(startend,clipPos({line:cur.line,ch:0}));else setSelectionUser(startstart,clipPos({line:cur.line+1,ch:0}));}}
function extend(e){var cur=posFromMouse(e,true);if(cur&&!posEq(cur,last)){if(!focused)onFocus();last=cur;doSelect(cur);updateInput=false;var visible=visibleLines();if(cur.line>=visible.to||cur.line<visible.from)
going=setTimeout(operation(function(){extend(e);}),150);}}
function done(e){clearTimeout(going);var cur=posFromMouse(e);if(cur)doSelect(cur);e_preventDefault(e);focusInput();updateInput=true;move();up();}
var move=connect(document,"mousemove",operation(function(e){clearTimeout(going);e_preventDefault(e);if(!ie&&!e_button(e))done(e);else extend(e);}),true);var up=connect(document,"mouseup",operation(done),true);}
function onDoubleClick(e){for(var n=e_target(e);n!=wrapper;n=n.parentNode)
if(n.parentNode==gutterText)return e_preventDefault(e);e_preventDefault(e);}
function onDrop(e){if(options.onDragEvent&&options.onDragEvent(instance,addStop(e)))return;e.preventDefault();var pos=posFromMouse(e,true),files=e.dataTransfer.files;if(!pos||options.readOnly)return;if(files&&files.length&&window.FileReader&&window.File){function loadFile(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result;if(++read==n){pos=clipPos(pos);operation(function(){var end=replaceRange(text.join(""),pos,pos);setSelectionUser(pos,end);})();}};reader.readAsText(file);}
var n=files.length,text=Array(n),read=0;for(var i=0;i<n;++i)loadFile(files[i],i);}else{if(draggingText&&!(posLess(pos,sel.from)||posLess(sel.to,pos)))return;try{var text=e.dataTransfer.getData("Text");if(text){compoundChange(function(){var curFrom=sel.from,curTo=sel.to;setSelectionUser(pos,pos);if(draggingText)replaceRange("",curFrom,curTo);replaceSelection(text);focusInput();});}}
catch(e){}}}
function onDragStart(e){var txt=getSelection();e.dataTransfer.setData("Text",txt);if(gecko||chrome||opera){var img=document.createElement('img');img.scr='data:image/gif;base64,R0lGODdhAgACAIAAAAAAAP///ywAAAAAAgACAAACAoRRADs=';e.dataTransfer.setDragImage(img,0,0);}}
function doHandleBinding(bound,dropShift){if(typeof bound=="string"){bound=commands[bound];if(!bound)return false;}
var prevShift=shiftSelecting;try{if(options.readOnly)suppressEdits=true;if(dropShift)shiftSelecting=null;bound(instance);}catch(e){if(e!=Pass)throw e;return false;}finally{shiftSelecting=prevShift;suppressEdits=false;}
return true;}
function handleKeyBinding(e){var startMap=getKeyMap(options.keyMap),next=startMap.auto;clearTimeout(maybeTransition);if(next&&!isModifierKey(e))maybeTransition=setTimeout(function(){if(getKeyMap(options.keyMap)==startMap){options.keyMap=(next.call?next.call(null,instance):next);}},50);var name=keyNames[e_prop(e,"keyCode")],handled=false;if(name==null||e.altGraphKey)return false;if(e_prop(e,"altKey"))name="Alt-"+name;if(e_prop(e,"ctrlKey"))name="Ctrl-"+name;if(e_prop(e,"metaKey"))name="Cmd-"+name;var stopped=false;function stop(){stopped=true;}
if(e_prop(e,"shiftKey")){handled=lookupKey("Shift-"+name,options.extraKeys,options.keyMap,function(b){return doHandleBinding(b,true);},stop)||lookupKey(name,options.extraKeys,options.keyMap,function(b){if(typeof b=="string"&&/^go[A-Z]/.test(b))return doHandleBinding(b);},stop);}else{handled=lookupKey(name,options.extraKeys,options.keyMap,doHandleBinding,stop);}
if(stopped)handled=false;if(handled){e_preventDefault(e);restartBlink();if(ie){e.oldKeyCode=e.keyCode;e.keyCode=0;}}
return handled;}
function handleCharBinding(e,ch){var handled=lookupKey("'"+ch+"'",options.extraKeys,options.keyMap,function(b){return doHandleBinding(b,true);});if(handled){e_preventDefault(e);restartBlink();}
return handled;}
var lastStoppedKey=null,maybeTransition;function onKeyDown(e){if(!focused)onFocus();if(ie&&e.keyCode==27){e.returnValue=false;}
if(pollingFast){if(readInput())pollingFast=false;}
if(options.onKeyEvent&&options.onKeyEvent(instance,addStop(e)))return;var code=e_prop(e,"keyCode");setShift(code==16||e_prop(e,"shiftKey"));var handled=handleKeyBinding(e);if(opera){lastStoppedKey=handled?code:null;if(!handled&&code==88&&e_prop(e,mac?"metaKey":"ctrlKey"))
replaceSelection("");}}
function onKeyPress(e){if(pollingFast)readInput();if(options.onKeyEvent&&options.onKeyEvent(instance,addStop(e)))return;var keyCode=e_prop(e,"keyCode"),charCode=e_prop(e,"charCode");if(opera&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return;}
if(((opera&&(!e.which||e.which<10))||khtml)&&handleKeyBinding(e))return;var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(options.electricChars&&mode.electricChars&&options.smartIndent&&!options.readOnly){if(mode.electricChars.indexOf(ch)>-1)
setTimeout(operation(function(){indentLine(sel.to.line,"smart");}),75);}
if(handleCharBinding(e,ch))return;fastPoll();}
function onKeyUp(e){if(options.onKeyEvent&&options.onKeyEvent(instance,addStop(e)))return;if(e_prop(e,"keyCode")==16)shiftSelecting=null;}
function onFocus(){if(options.readOnly=="nocursor")return;if(!focused){if(options.onFocus)options.onFocus(instance);focused=true;if(scroller.className.search(/\bCodeMirror-focused\b/)==-1)
scroller.className+=" CodeMirror-focused";if(!leaveInputAlone)resetInput(true);}
slowPoll();restartBlink();}
function onBlur(){if(focused){if(options.onBlur)options.onBlur(instance);focused=false;if(bracketHighlighted)
operation(function(){if(bracketHighlighted){bracketHighlighted();bracketHighlighted=null;}})();scroller.className=scroller.className.replace(" CodeMirror-focused","");}
clearInterval(blinker);setTimeout(function(){if(!focused)shiftSelecting=null;},150);}
function chopDelta(delta){if(delta>0.0&&delta<1.0)return 1;else if(delta>-1.0&&delta<0.0)return-1;else return Math.round(delta);}
function onMouseWheel(e){var deltaX=0,deltaY=0;if(e.type=="DOMMouseScroll"){var delta=-e.detail*8.0;if(e.axis==e.HORIZONTAL_AXIS)deltaX=delta;else if(e.axis==e.VERTICAL_AXIS)deltaY=delta;}else if(e.wheelDeltaX!==undefined&&e.wheelDeltaY!==undefined){deltaX=e.wheelDeltaX/3.0;deltaY=e.wheelDeltaY/3.0;}else if(e.wheelDelta!==undefined){deltaY=e.wheelDelta/3.0;}
var scrolled=false;deltaX=chopDelta(deltaX);deltaY=chopDelta(deltaY);if((deltaX>0&&scroller.scrollLeft>0)||(deltaX<0&&scroller.scrollLeft+scroller.clientWidth<scroller.scrollWidth)){scroller.scrollLeft-=deltaX;scrolled=true;}
if((deltaY>0&&scrollbar.scrollTop>0)||(deltaY<0&&scrollbar.scrollTop+scrollbar.clientHeight<scrollbar.scrollHeight)){scrollbar.scrollTop-=deltaY;scrolled=true;}
if(scrolled)e_stop(e);}
function updateLines(from,to,newText,selFrom,selTo){if(suppressEdits)return;if(history){var old=[];doc.iter(from.line,to.line+1,function(line){old.push(line.text);});history.addChange(from.line,newText.length,old);while(history.done.length>options.undoDepth)history.done.shift();}
updateLinesNoUndo(from,to,newText,selFrom,selTo);}
function unredoHelper(from,to){if(!from.length)return;var set=from.pop(),out=[];for(var i=set.length-1;i>=0;i-=1){var change=set[i];var replaced=[],end=change.start+change.added;doc.iter(change.start,end,function(line){replaced.push(line.text);});out.push({start:change.start,added:change.old.length,old:replaced});var pos={line:change.start+change.old.length-1,ch:editEnd(replaced[replaced.length-1],change.old[change.old.length-1])};updateLinesNoUndo({line:change.start,ch:0},{line:end-1,ch:getLine(end-1).text.length},change.old,pos,pos);}
updateInput=true;to.push(out);}
function undo(){unredoHelper(history.done,history.undone);}
function redo(){unredoHelper(history.undone,history.done);}
function updateLinesNoUndo(from,to,newText,selFrom,selTo){if(suppressEdits)return;var recomputeMaxLength=false,maxLineLength=maxLine.length;if(!options.lineWrapping)
doc.iter(from.line,to.line+1,function(line){if(!line.hidden&&line.text.length==maxLineLength){recomputeMaxLength=true;return true;}});if(from.line!=to.line||newText.length>1)gutterDirty=true;var nlines=to.line-from.line,firstLine=getLine(from.line),lastLine=getLine(to.line);if(from.ch==0&&to.ch==0&&newText[newText.length-1]==""){var added=[],prevLine=null;if(from.line){prevLine=getLine(from.line-1);prevLine.fixMarkEnds(lastLine);}else lastLine.fixMarkStarts();for(var i=0,e=newText.length-1;i<e;++i)
added.push(Line.inheritMarks(newText[i],prevLine));if(nlines)doc.remove(from.line,nlines,callbacks);if(added.length)doc.insert(from.line,added);}else if(firstLine==lastLine){if(newText.length==1)
firstLine.replace(from.ch,to.ch,newText[0]);else{lastLine=firstLine.split(to.ch,newText[newText.length-1]);firstLine.replace(from.ch,null,newText[0]);firstLine.fixMarkEnds(lastLine);var added=[];for(var i=1,e=newText.length-1;i<e;++i)
added.push(Line.inheritMarks(newText[i],firstLine));added.push(lastLine);doc.insert(from.line+1,added);}}else if(newText.length==1){firstLine.replace(from.ch,null,newText[0]);lastLine.replace(null,to.ch,"");firstLine.append(lastLine);doc.remove(from.line+1,nlines,callbacks);}else{var added=[];firstLine.replace(from.ch,null,newText[0]);lastLine.replace(null,to.ch,newText[newText.length-1]);firstLine.fixMarkEnds(lastLine);for(var i=1,e=newText.length-1;i<e;++i)
added.push(Line.inheritMarks(newText[i],firstLine));if(nlines>1)doc.remove(from.line+1,nlines-1,callbacks);doc.insert(from.line+1,added);}
if(options.lineWrapping){var perLine=Math.max(5,scroller.clientWidth/charWidth()-3);doc.iter(from.line,from.line+newText.length,function(line){if(line.hidden)return;var guess=Math.ceil(line.text.length/perLine)||1;if(guess!=line.height)updateLineHeight(line,guess);});}else{doc.iter(from.line,from.line+newText.length,function(line){var l=line.text;if(!line.hidden&&l.length>maxLineLength){maxLine=l;maxLineLength=l.length;maxLineChanged=true;recomputeMaxLength=false;}});if(recomputeMaxLength)updateMaxLine=true;}
var newWork=[],lendiff=newText.length-nlines-1;for(var i=0,l=work.length;i<l;++i){var task=work[i];if(task<from.line)newWork.push(task);else if(task>to.line)newWork.push(task+lendiff);}
var hlEnd=from.line+Math.min(newText.length,500);highlightLines(from.line,hlEnd);newWork.push(hlEnd);work=newWork;startWorker(100);changes.push({from:from.line,to:to.line+1,diff:lendiff});var changeObj={from:from,to:to,text:newText};if(textChanged){for(var cur=textChanged;cur.next;cur=cur.next){}
cur.next=changeObj;}else textChanged=changeObj;function updateLine(n){return n<=Math.min(to.line,to.line+lendiff)?n:n+lendiff;}
setSelection(clipPos(selFrom),clipPos(selTo),updateLine(sel.from.line),updateLine(sel.to.line));}
function needsScrollbar(){var realHeight=doc.height*textHeight()+2*paddingTop();return realHeight-1>scroller.offsetHeight?realHeight:false;}
function updateVerticalScroll(scrollTop){var scrollHeight=needsScrollbar();scrollbar.style.display=scrollHeight?"block":"none";if(scrollHeight){scrollbarInner.style.height=scrollHeight+"px";scrollbar.style.height=scroller.offsetHeight+"px";if(scrollTop!=null)scrollbar.scrollTop=scrollTop;}
mover.style.top=(displayOffset*textHeight()-scrollbar.scrollTop)+"px";}
function overlapScrollbars(){var tmpSb=document.createElement('div'),tmpSbInner=document.createElement('div');tmpSb.className="CodeMirror-scrollbar";tmpSb.style.cssText="position: absolute; left: -9999px; height: 100px;";tmpSbInner.className="CodeMirror-scrollbar-inner";tmpSbInner.style.height="200px";tmpSb.appendChild(tmpSbInner);document.body.appendChild(tmpSb);var result=(tmpSb.offsetWidth<=1);document.body.removeChild(tmpSb);return result;}
function computeMaxLength(){var maxLineLength=0;maxLine="";maxLineChanged=true;doc.iter(0,doc.size,function(line){var l=line.text;if(!line.hidden&&l.length>maxLineLength){maxLineLength=l.length;maxLine=l;}});updateMaxLine=false;}
function replaceRange(code,from,to){from=clipPos(from);if(!to)to=from;else to=clipPos(to);code=splitLines(code);function adjustPos(pos){if(posLess(pos,from))return pos;if(!posLess(to,pos))return end;var line=pos.line+code.length-(to.line-from.line)-1;var ch=pos.ch;if(pos.line==to.line)
ch+=code[code.length-1].length-(to.ch-(to.line==from.line?from.ch:0));return{line:line,ch:ch};}
var end;replaceRange1(code,from,to,function(end1){end=end1;return{from:adjustPos(sel.from),to:adjustPos(sel.to)};});return end;}
function replaceSelection(code,collapse){replaceRange1(splitLines(code),sel.from,sel.to,function(end){if(collapse=="end")return{from:end,to:end};else if(collapse=="start")return{from:sel.from,to:sel.from};else return{from:sel.from,to:end};});}
function replaceRange1(code,from,to,computeSel){var endch=code.length==1?code[0].length+from.ch:code[code.length-1].length;var newSel=computeSel({line:from.line+code.length-1,ch:endch});updateLines(from,to,code,newSel.from,newSel.to);}
function getRange(from,to,lineSep){var l1=from.line,l2=to.line;if(l1==l2)return getLine(l1).text.slice(from.ch,to.ch);var code=[getLine(l1).text.slice(from.ch)];doc.iter(l1+1,l2,function(line){code.push(line.text);});code.push(getLine(l2).text.slice(0,to.ch));return code.join(lineSep||"\n");}
function getSelection(lineSep){return getRange(sel.from,sel.to,lineSep);}
var pollingFast=false;function slowPoll(){if(pollingFast)return;poll.set(options.pollInterval,function(){startOperation();readInput();if(focused)slowPoll();endOperation();});}
function fastPoll(){var missed=false;pollingFast=true;function p(){startOperation();var changed=readInput();if(!changed&&!missed){missed=true;poll.set(60,p);}
else{pollingFast=false;slowPoll();}
endOperation();}
poll.set(20,p);}
var prevInput="";function readInput(){if(leaveInputAlone||!focused||hasSelection(input)||options.readOnly)return false;var text=input.value;if(text==prevInput)return false;shiftSelecting=null;var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput[same]==text[same])++same;if(same<prevInput.length)
sel.from={line:sel.from.line,ch:sel.from.ch-(prevInput.length-same)};else if(overwrite&&posEq(sel.from,sel.to))
sel.to={line:sel.to.line,ch:Math.min(getLine(sel.to.line).text.length,sel.to.ch+(text.length-same))};replaceSelection(text.slice(same),"end");if(text.length>1000){input.value=prevInput="";}
else prevInput=text;return true;}
function resetInput(user){if(!posEq(sel.from,sel.to)){prevInput="";input.value=getSelection();selectInput(input);}else if(user)prevInput=input.value="";}
function focusInput(){if(options.readOnly!="nocursor")input.focus();}
function scrollEditorIntoView(){var rect=cursor.getBoundingClientRect();if(ie&&rect.top==rect.bottom)return;var winH=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);if(rect.top<0||rect.bottom>winH)scrollCursorIntoView();}
function scrollCursorIntoView(){var coords=calculateCursorCoords();return scrollIntoView(coords.x,coords.y,coords.x,coords.yBot);}
function calculateCursorCoords(){var cursor=localCoords(sel.inverted?sel.from:sel.to);var x=options.lineWrapping?Math.min(cursor.x,lineSpace.offsetWidth):cursor.x;return{x:x,y:cursor.y,yBot:cursor.yBot};}
function scrollIntoView(x1,y1,x2,y2){var scrollPos=calculateScrollPos(x1,y1,x2,y2),scrolled=false;if(scrollPos.scrollLeft!=null){scroller.scrollLeft=scrollPos.scrollLeft;scrolled=true;}
if(scrollPos.scrollTop!=null){scrollbar.scrollTop=scrollPos.scrollTop;scrolled=true;}
if(scrolled&&options.onScroll)options.onScroll(instance);}
function calculateScrollPos(x1,y1,x2,y2){var pl=paddingLeft(),pt=paddingTop();y1+=pt;y2+=pt;x1+=pl;x2+=pl;var screen=scroller.clientHeight,screentop=scrollbar.scrollTop,result={};var docBottom=scroller.scrollHeight;var atTop=y1<pt+10,atBottom=y2+pt>docBottom-10;;if(y1<screentop)result.scrollTop=atTop?0:Math.max(0,y1);else if(y2>screentop+screen)result.scrollTop=(atBottom?docBottom:y2)-screen;var screenw=scroller.clientWidth,screenleft=scroller.scrollLeft;var gutterw=options.fixedGutter?gutter.clientWidth:0;var atLeft=x1<gutterw+pl+10;if(x1<screenleft+gutterw||atLeft){if(atLeft)x1=0;result.scrollLeft=Math.max(0,x1-10-gutterw);}else if(x2>screenw+screenleft-3){result.scrollLeft=x2+10-screenw;}
return result;}
function visibleLines(scrollTop){var lh=textHeight(),top=(scrollTop!=null?scrollTop:scrollbar.scrollTop)-paddingTop();var fromHeight=Math.max(0,Math.floor(top/lh));var toHeight=Math.ceil((top+scroller.clientHeight)/lh);return{from:lineAtHeight(doc,fromHeight),to:lineAtHeight(doc,toHeight)};}
function updateDisplay(changes,suppressCallback,scrollTop){if(!scroller.clientWidth){showingFrom=showingTo=displayOffset=0;return;}
var visible=visibleLines(scrollTop);if(changes!==true&&changes.length==0&&visible.from>showingFrom&&visible.to<showingTo){updateVerticalScroll(scrollTop);return;}
var from=Math.max(visible.from-100,0),to=Math.min(doc.size,visible.to+100);if(showingFrom<from&&from-showingFrom<20)from=showingFrom;if(showingTo>to&&showingTo-to<20)to=Math.min(doc.size,showingTo);var intact=changes===true?[]:computeIntact([{from:showingFrom,to:showingTo,domStart:0}],changes);var intactLines=0;for(var i=0;i<intact.length;++i){var range=intact[i];if(range.from<from){range.domStart+=(from-range.from);range.from=from;}
if(range.to>to)range.to=to;if(range.from>=range.to)intact.splice(i--,1);else intactLines+=range.to-range.from;}
if(intactLines==to-from&&from==showingFrom&&to==showingTo){updateVerticalScroll(scrollTop);return;}
intact.sort(function(a,b){return a.domStart-b.domStart;});var th=textHeight(),gutterDisplay=gutter.style.display;lineDiv.style.display="none";patchDisplay(from,to,intact);lineDiv.style.display=gutter.style.display="";var different=from!=showingFrom||to!=showingTo||lastSizeC!=scroller.clientHeight+th;if(different)lastSizeC=scroller.clientHeight+th;showingFrom=from;showingTo=to;displayOffset=heightAtLine(doc,from);if(lineDiv.childNodes.length!=showingTo-showingFrom)
throw new Error("BAD PATCH! "+JSON.stringify(intact)+" size="+(showingTo-showingFrom)+" nodes="+lineDiv.childNodes.length);function checkHeights(){var curNode=lineDiv.firstChild,heightChanged=false;doc.iter(showingFrom,showingTo,function(line){if(!line.hidden){var height=Math.round(curNode.offsetHeight/th)||1;if(line.height!=height){updateLineHeight(line,height);gutterDirty=heightChanged=true;}}
curNode=curNode.nextSibling;});return heightChanged;}
if(options.lineWrapping){checkHeights();var scrollHeight=needsScrollbar();var shouldHaveScrollbar=scrollHeight?"block":"none";if(scrollbar.style.display!=shouldHaveScrollbar){scrollbar.style.display=shouldHaveScrollbar;if(scrollHeight)scrollbarInner.style.height=scrollHeight+"px";checkHeights();}}
gutter.style.display=gutterDisplay;if(different||gutterDirty){updateGutter()&&options.lineWrapping&&checkHeights()&&updateGutter();}
updateVerticalScroll(scrollTop);updateSelection();if(!suppressCallback&&options.onUpdate)options.onUpdate(instance);return true;}
function computeIntact(intact,changes){for(var i=0,l=changes.length||0;i<l;++i){var change=changes[i],intact2=[],diff=change.diff||0;for(var j=0,l2=intact.length;j<l2;++j){var range=intact[j];if(change.to<=range.from&&change.diff)
intact2.push({from:range.from+diff,to:range.to+diff,domStart:range.domStart});else if(change.to<=range.from||change.from>=range.to)
intact2.push(range);else{if(change.from>range.from)
intact2.push({from:range.from,to:change.from,domStart:range.domStart});if(change.to<range.to)
intact2.push({from:change.to+diff,to:range.to+diff,domStart:range.domStart+(change.to-range.from)});}}
intact=intact2;}
return intact;}
function patchDisplay(from,to,intact){if(!intact.length)lineDiv.innerHTML="";else{function killNode(node){var tmp=node.nextSibling;node.parentNode.removeChild(node);return tmp;}
var domPos=0,curNode=lineDiv.firstChild,n;for(var i=0;i<intact.length;++i){var cur=intact[i];while(cur.domStart>domPos){curNode=killNode(curNode);domPos++;}
for(var j=0,e=cur.to-cur.from;j<e;++j){curNode=curNode.nextSibling;domPos++;}}
while(curNode)curNode=killNode(curNode);}
var nextIntact=intact.shift(),curNode=lineDiv.firstChild,j=from;var scratch=document.createElement("div");doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==j)nextIntact=intact.shift();if(!nextIntact||nextIntact.from>j){if(line.hidden)var html=scratch.innerHTML="<pre></pre>";else{var html='<pre'+(line.className?' class="'+line.className+'"':'')+'>'
+line.getHTML(makeTab)+'</pre>';if(line.bgClassName)
html='<div style="position: relative"><pre class="'+line.bgClassName+'" style="position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: -2">&#160;</pre>'+html+"</div>";}
scratch.innerHTML=html;lineDiv.insertBefore(scratch.firstChild,curNode);}else{curNode=curNode.nextSibling;}
++j;});}
function updateGutter(){if(!options.gutter&&!options.lineNumbers)return;var hText=mover.offsetHeight,hEditor=scroller.clientHeight;gutter.style.height=(hText-hEditor<2?hEditor:hText)+"px";var html=[],i=showingFrom,normalNode;doc.iter(showingFrom,Math.max(showingTo,showingFrom+1),function(line){if(line.hidden){html.push("<pre></pre>");}else{var marker=line.gutterMarker;var text=options.lineNumbers?options.lineNumberFormatter(i+options.firstLineNumber):null;if(marker&&marker.text)
text=marker.text.replace("%N%",text!=null?text:"");else if(text==null)
text="\u00a0";html.push((marker&&marker.style?'<pre class="'+marker.style+'">':"<pre>"),text);for(var j=1;j<line.height;++j)html.push("<br/>&#160;");html.push("</pre>");if(!marker)normalNode=i;}
++i;});gutter.style.display="none";gutterText.innerHTML=html.join("");if(normalNode!=null&&options.lineNumbers){var node=gutterText.childNodes[normalNode-showingFrom];var minwidth=String(doc.size).length,val=eltText(node.firstChild),pad="";while(val.length+pad.length<minwidth)pad+="\u00a0";if(pad)node.insertBefore(document.createTextNode(pad),node.firstChild);}
gutter.style.display="";var resized=Math.abs((parseInt(lineSpace.style.marginLeft)||0)-gutter.offsetWidth)>2;lineSpace.style.marginLeft=gutter.offsetWidth+"px";gutterDirty=false;return resized;}
function updateSelection(){var collapsed=posEq(sel.from,sel.to);var fromPos=localCoords(sel.from,true);var toPos=collapsed?fromPos:localCoords(sel.to,true);var headPos=sel.inverted?fromPos:toPos,th=textHeight();var wrapOff=eltOffset(wrapper),lineOff=eltOffset(lineDiv);inputDiv.style.top=Math.max(0,Math.min(scroller.offsetHeight,headPos.y+lineOff.top-wrapOff.top))+"px";inputDiv.style.left=Math.max(0,Math.min(scroller.offsetWidth,headPos.x+lineOff.left-wrapOff.left))+"px";if(collapsed){cursor.style.top=headPos.y+"px";cursor.style.left=(options.lineWrapping?Math.min(headPos.x,lineSpace.offsetWidth):headPos.x)+"px";cursor.style.display="";selectionDiv.style.display="none";}else{var sameLine=fromPos.y==toPos.y,html="";var clientWidth=lineSpace.clientWidth||lineSpace.offsetWidth;var clientHeight=lineSpace.clientHeight||lineSpace.offsetHeight;function add(left,top,right,height){var rstyle=quirksMode?"width: "+(!right?clientWidth:clientWidth-right-left)+"px":"right: "+right+"px";html+='<div class="CodeMirror-selected" style="position: absolute; left: '+left+'px; top: '+top+'px; '+rstyle+'; height: '+height+'px"></div>';}
if(sel.from.ch&&fromPos.y>=0){var right=sameLine?clientWidth-toPos.x:0;add(fromPos.x,fromPos.y,right,th);}
var middleStart=Math.max(0,fromPos.y+(sel.from.ch?th:0));var middleHeight=Math.min(toPos.y,clientHeight)-middleStart;if(middleHeight>0.2*th)
add(0,middleStart,0,middleHeight);if((!sameLine||!sel.from.ch)&&toPos.y<clientHeight-.5*th)
add(0,toPos.y,clientWidth-toPos.x,th);selectionDiv.innerHTML=html;cursor.style.display="none";selectionDiv.style.display="";}}
function setShift(val){if(val)shiftSelecting=shiftSelecting||(sel.inverted?sel.to:sel.from);else shiftSelecting=null;}
function setSelectionUser(from,to){var sh=shiftSelecting&&clipPos(shiftSelecting);if(sh){if(posLess(sh,from))from=sh;else if(posLess(to,sh))to=sh;}
setSelection(from,to);userSelChange=true;}
function setSelection(from,to,oldFrom,oldTo){goalColumn=null;if(oldFrom==null){oldFrom=sel.from.line;oldTo=sel.to.line;}
if(posEq(sel.from,from)&&posEq(sel.to,to))return;if(posLess(to,from)){var tmp=to;to=from;from=tmp;}
if(from.line!=oldFrom){var from1=skipHidden(from,oldFrom,sel.from.ch);if(!from1)setLineHidden(from.line,false);else from=from1;}
if(to.line!=oldTo)to=skipHidden(to,oldTo,sel.to.ch);if(posEq(from,to))sel.inverted=false;else if(posEq(from,sel.to))sel.inverted=false;else if(posEq(to,sel.from))sel.inverted=true;if(options.autoClearEmptyLines&&posEq(sel.from,sel.to)){var head=sel.inverted?from:to;if(head.line!=sel.from.line&&sel.from.line<doc.size){var oldLine=getLine(sel.from.line);if(/^\s+$/.test(oldLine.text))
setTimeout(operation(function(){if(oldLine.parent&&/^\s+$/.test(oldLine.text)){var no=lineNo(oldLine);replaceRange("",{line:no,ch:0},{line:no,ch:oldLine.text.length});}},10));}}
sel.from=from;sel.to=to;selectionChanged=true;}
function skipHidden(pos,oldLine,oldCh){function getNonHidden(dir){var lNo=pos.line+dir,end=dir==1?doc.size:-1;while(lNo!=end){var line=getLine(lNo);if(!line.hidden){var ch=pos.ch;if(toEnd||ch>oldCh||ch>line.text.length)ch=line.text.length;return{line:lNo,ch:ch};}
lNo+=dir;}}
var line=getLine(pos.line);var toEnd=pos.ch==line.text.length&&pos.ch!=oldCh;if(!line.hidden)return pos;if(pos.line>=oldLine)return getNonHidden(1)||getNonHidden(-1);else return getNonHidden(-1)||getNonHidden(1);}
function setCursor(line,ch,user){var pos=clipPos({line:line,ch:ch||0});(user?setSelectionUser:setSelection)(pos,pos);}
function clipLine(n){return Math.max(0,Math.min(n,doc.size-1));}
function clipPos(pos){if(pos.line<0)return{line:0,ch:0};if(pos.line>=doc.size)return{line:doc.size-1,ch:getLine(doc.size-1).text.length};var ch=pos.ch,linelen=getLine(pos.line).text.length;if(ch==null||ch>linelen)return{line:pos.line,ch:linelen};else if(ch<0)return{line:pos.line,ch:0};else return pos;}
function findPosH(dir,unit){var end=sel.inverted?sel.from:sel.to,line=end.line,ch=end.ch;var lineObj=getLine(line);function findNextLine(){for(var l=line+dir,e=dir<0?-1:doc.size;l!=e;l+=dir){var lo=getLine(l);if(!lo.hidden){line=l;lineObj=lo;return true;}}}
function moveOnce(boundToLine){if(ch==(dir<0?0:lineObj.text.length)){if(!boundToLine&&findNextLine())ch=dir<0?lineObj.text.length:0;else return false;}else ch+=dir;return true;}
if(unit=="char")moveOnce();else if(unit=="column")moveOnce(true);else if(unit=="word"){var sawWord=false;for(;;){if(dir<0)if(!moveOnce())break;if(isWordChar(lineObj.text.charAt(ch)))sawWord=true;else if(sawWord){if(dir<0){dir=1;moveOnce();}break;}
if(dir>0)if(!moveOnce())break;}}
return{line:line,ch:ch};}
function moveH(dir,unit){var pos=dir<0?sel.from:sel.to;if(shiftSelecting||posEq(sel.from,sel.to))pos=findPosH(dir,unit);setCursor(pos.line,pos.ch,true);}
function deleteH(dir,unit){if(!posEq(sel.from,sel.to))replaceRange("",sel.from,sel.to);else if(dir<0)replaceRange("",findPosH(dir,unit),sel.to);else replaceRange("",sel.from,findPosH(dir,unit));userSelChange=true;}
var goalColumn=null;function moveV(dir,unit){var dist=0,pos=localCoords(sel.inverted?sel.from:sel.to,true);if(goalColumn!=null)pos.x=goalColumn;if(unit=="page")dist=Math.min(scroller.clientHeight,window.innerHeight||document.documentElement.clientHeight);else if(unit=="line")dist=textHeight();var target=coordsChar(pos.x,pos.y+dist*dir+2);if(unit=="page")scrollbar.scrollTop+=localCoords(target,true).y-pos.y;setCursor(target.line,target.ch,true);goalColumn=pos.x;}
function findWordAt(pos){var line=getLine(pos.line).text;var start=pos.ch,end=pos.ch;var check=isWordChar(line.charAt(start<line.length?start:start-1))?isWordChar:function(ch){return!isWordChar(ch);};while(start>0&&check(line.charAt(start-1)))--start;while(end<line.length&&check(line.charAt(end)))++end;return{from:{line:pos.line,ch:start},to:{line:pos.line,ch:end}};}
function selectLine(line){setSelectionUser({line:line,ch:0},clipPos({line:line+1,ch:0}));}
function indentSelected(mode){if(posEq(sel.from,sel.to))return indentLine(sel.from.line,mode);var e=sel.to.line-(sel.to.ch?0:1);for(var i=sel.from.line;i<=e;++i)indentLine(i,mode);}
function indentLine(n,how){if(!how)how="add";if(how=="smart"){if(!mode.indent)how="prev";else var state=getStateBefore(n);}
var line=getLine(n),curSpace=line.indentation(options.tabSize),curSpaceString=line.text.match(/^\s*/)[0],indentation;if(how=="smart"){indentation=mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass)how="prev";}
if(how=="prev"){if(n)indentation=getLine(n-1).indentation(options.tabSize);else indentation=0;}
else if(how=="add")indentation=curSpace+options.indentUnit;else if(how=="subtract")indentation=curSpace-options.indentUnit;indentation=Math.max(0,indentation);var diff=indentation-curSpace;var indentString="",pos=0;if(options.indentWithTabs)
for(var i=Math.floor(indentation/options.tabSize);i;--i){pos+=options.tabSize;indentString+="\t";}
while(pos<indentation){++pos;indentString+=" ";}
replaceRange(indentString,{line:n,ch:0},{line:n,ch:curSpaceString.length});}
function loadMode(){mode=CodeMirror.getMode(options,options.mode);doc.iter(0,doc.size,function(line){line.stateAfter=null;});work=[0];startWorker();}
function gutterChanged(){var visible=options.gutter||options.lineNumbers;gutter.style.display=visible?"":"none";if(visible)gutterDirty=true;else lineDiv.parentNode.style.marginLeft=0;}
function wrappingChanged(from,to){if(options.lineWrapping){wrapper.className+=" CodeMirror-wrap";var perLine=scroller.clientWidth/charWidth()-3;doc.iter(0,doc.size,function(line){if(line.hidden)return;var guess=Math.ceil(line.text.length/perLine)||1;if(guess!=1)updateLineHeight(line,guess);});lineSpace.style.width=code.style.width="";widthForcer.style.left="";}else{wrapper.className=wrapper.className.replace(" CodeMirror-wrap","");maxLine="";maxLineChanged=true;doc.iter(0,doc.size,function(line){if(line.height!=1&&!line.hidden)updateLineHeight(line,1);if(line.text.length>maxLine.length)maxLine=line.text;});}
changes.push({from:0,to:doc.size});}
function makeTab(col){var w=options.tabSize-col%options.tabSize,cached=tabCache[w];if(cached)return cached;for(var str='<span class="cm-tab">',i=0;i<w;++i)str+=" ";return(tabCache[w]={html:str+"</span>",width:w});}
function themeChanged(){scroller.className=scroller.className.replace(/\s*cm-s-\S+/g,"")+
options.theme.replace(/(^|\s)\s*/g," cm-s-");}
function keyMapChanged(){var style=keyMap[options.keyMap].style;wrapper.className=wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+
(style?" cm-keymap-"+style:"");}
function TextMarker(){this.set=[];}
TextMarker.prototype.clear=operation(function(){var min=Infinity,max=-Infinity;for(var i=0,e=this.set.length;i<e;++i){var line=this.set[i],mk=line.marked;if(!mk||!line.parent)continue;var lineN=lineNo(line);min=Math.min(min,lineN);max=Math.max(max,lineN);for(var j=0;j<mk.length;++j)
if(mk[j].marker==this)mk.splice(j--,1);}
if(min!=Infinity)
changes.push({from:min,to:max+1});});TextMarker.prototype.find=function(){var from,to;for(var i=0,e=this.set.length;i<e;++i){var line=this.set[i],mk=line.marked;for(var j=0;j<mk.length;++j){var mark=mk[j];if(mark.marker==this){if(mark.from!=null||mark.to!=null){var found=lineNo(line);if(found!=null){if(mark.from!=null)from={line:found,ch:mark.from};if(mark.to!=null)to={line:found,ch:mark.to};}}}}}
return{from:from,to:to};};function markText(from,to,className){from=clipPos(from);to=clipPos(to);var tm=new TextMarker();if(!posLess(from,to))return tm;function add(line,from,to,className){getLine(line).addMark(new MarkedText(from,to,className,tm));}
if(from.line==to.line)add(from.line,from.ch,to.ch,className);else{add(from.line,from.ch,null,className);for(var i=from.line+1,e=to.line;i<e;++i)
add(i,null,null,className);add(to.line,null,to.ch,className);}
changes.push({from:from.line,to:to.line+1});return tm;}
function setBookmark(pos){pos=clipPos(pos);var bm=new Bookmark(pos.ch);getLine(pos.line).addMark(bm);return bm;}
function findMarksAt(pos){pos=clipPos(pos);var markers=[],marked=getLine(pos.line).marked;if(!marked)return markers;for(var i=0,e=marked.length;i<e;++i){var m=marked[i];if((m.from==null||m.from<=pos.ch)&&(m.to==null||m.to>=pos.ch))
markers.push(m.marker||m);}
return markers;}
function addGutterMarker(line,text,className){if(typeof line=="number")line=getLine(clipLine(line));line.gutterMarker={text:text,style:className};gutterDirty=true;return line;}
function removeGutterMarker(line){if(typeof line=="number")line=getLine(clipLine(line));line.gutterMarker=null;gutterDirty=true;}
function changeLine(handle,op){var no=handle,line=handle;if(typeof handle=="number")line=getLine(clipLine(handle));else no=lineNo(handle);if(no==null)return null;if(op(line,no))changes.push({from:no,to:no+1});else return null;return line;}
function setLineClass(handle,className,bgClassName){return changeLine(handle,function(line){if(line.className!=className||line.bgClassName!=bgClassName){line.className=className;line.bgClassName=bgClassName;return true;}});}
function setLineHidden(handle,hidden){return changeLine(handle,function(line,no){if(line.hidden!=hidden){line.hidden=hidden;if(!options.lineWrapping){var l=line.text;if(hidden&&l.length==maxLine.length){updateMaxLine=true;}else if(!hidden&&l.length>maxLine.length){maxLine=l;updateMaxLine=false;}}
updateLineHeight(line,hidden?0:1);var fline=sel.from.line,tline=sel.to.line;if(hidden&&(fline==no||tline==no)){var from=fline==no?skipHidden({line:fline,ch:0},fline,0):sel.from;var to=tline==no?skipHidden({line:tline,ch:0},tline,0):sel.to;if(!to)return;setSelection(from,to);}
return(gutterDirty=true);}});}
function lineInfo(line){if(typeof line=="number"){if(!isLine(line))return null;var n=line;line=getLine(line);if(!line)return null;}else{var n=lineNo(line);if(n==null)return null;}
var marker=line.gutterMarker;return{line:n,handle:line,text:line.text,markerText:marker&&marker.text,markerClass:marker&&marker.style,lineClass:line.className,bgClass:line.bgClassName};}
function stringWidth(str){measure.innerHTML="<pre><span>x</span></pre>";measure.firstChild.firstChild.firstChild.nodeValue=str;return measure.firstChild.firstChild.offsetWidth||10;}
function charFromX(line,x){if(x<=0)return 0;var lineObj=getLine(line),text=lineObj.text;function getX(len){return measureLine(lineObj,len).left;}
var from=0,fromX=0,to=text.length,toX;var estimated=Math.min(to,Math.ceil(x/charWidth()));for(;;){var estX=getX(estimated);if(estX<=x&&estimated<to)estimated=Math.min(to,Math.ceil(estimated*1.2));else{toX=estX;to=estimated;break;}}
if(x>toX)return to;estimated=Math.floor(to*0.8);estX=getX(estimated);if(estX<x){from=estimated;fromX=estX;}
for(;;){if(to-from<=1)return(toX-x>x-fromX)?from:to;var middle=Math.ceil((from+to)/2),middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;}
else{from=middle;fromX=middleX;}}}
var tempId="CodeMirror-temp-"+Math.floor(Math.random()*0xffffff).toString(16);function measureLine(line,ch){if(ch==0)return{top:0,left:0};var wbr=options.lineWrapping&&ch<line.text.length&&spanAffectsWrapping.test(line.text.slice(ch-1,ch+1));measure.innerHTML="<pre>"+line.getHTML(makeTab,ch,tempId,wbr)+"</pre>";var elt=document.getElementById(tempId);var top=elt.offsetTop,left=elt.offsetLeft;if(ie&&top==0&&left==0){var backup=document.createElement("span");backup.innerHTML="x";elt.parentNode.insertBefore(backup,elt.nextSibling);top=backup.offsetTop;}
return{top:top,left:left};}
function localCoords(pos,inLineWrap){var x,lh=textHeight(),y=lh*(heightAtLine(doc,pos.line)-(inLineWrap?displayOffset:0));if(pos.ch==0)x=0;else{var sp=measureLine(getLine(pos.line),pos.ch);x=sp.left;if(options.lineWrapping)y+=Math.max(0,sp.top);}
return{x:x,y:y,yBot:y+lh};}
function coordsChar(x,y){if(y<0)return{line:0,ch:0};var th=textHeight(),cw=charWidth(),heightPos=displayOffset+Math.floor(y/th);var lineNo=lineAtHeight(doc,heightPos);if(lineNo>=doc.size)return{line:doc.size-1,ch:getLine(doc.size-1).text.length};var lineObj=getLine(lineNo),text=lineObj.text;var tw=options.lineWrapping,innerOff=tw?heightPos-heightAtLine(doc,lineNo):0;if(x<=0&&innerOff==0)return{line:lineNo,ch:0};function getX(len){var sp=measureLine(lineObj,len);if(tw){var off=Math.round(sp.top/th);return Math.max(0,sp.left+(off-innerOff)*scroller.clientWidth);}
return sp.left;}
var from=0,fromX=0,to=text.length,toX;var estimated=Math.min(to,Math.ceil((x+innerOff*scroller.clientWidth*.9)/cw));for(;;){var estX=getX(estimated);if(estX<=x&&estimated<to)estimated=Math.min(to,Math.ceil(estimated*1.2));else{toX=estX;to=estimated;break;}}
if(x>toX)return{line:lineNo,ch:to};estimated=Math.floor(to*0.8);estX=getX(estimated);if(estX<x){from=estimated;fromX=estX;}
for(;;){if(to-from<=1)return{line:lineNo,ch:(toX-x>x-fromX)?from:to};var middle=Math.ceil((from+to)/2),middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;}
else{from=middle;fromX=middleX;}}}
function pageCoords(pos){var local=localCoords(pos,true),off=eltOffset(lineSpace);return{x:off.left+local.x,y:off.top+local.y,yBot:off.top+local.yBot};}
var cachedHeight,cachedHeightFor,measureText;function textHeight(){if(measureText==null){measureText="<pre>";for(var i=0;i<49;++i)measureText+="x<br/>";measureText+="x</pre>";}
var offsetHeight=lineDiv.clientHeight;if(offsetHeight==cachedHeightFor)return cachedHeight;cachedHeightFor=offsetHeight;measure.innerHTML=measureText;cachedHeight=measure.firstChild.offsetHeight/50||1;measure.innerHTML="";return cachedHeight;}
var cachedWidth,cachedWidthFor=0;function charWidth(){if(scroller.clientWidth==cachedWidthFor)return cachedWidth;cachedWidthFor=scroller.clientWidth;return(cachedWidth=stringWidth("x"));}
function paddingTop(){return lineSpace.offsetTop;}
function paddingLeft(){return lineSpace.offsetLeft;}
function posFromMouse(e,liberal){var offW=eltOffset(scroller,true),x,y;try{x=e.clientX;y=e.clientY;}catch(e){return null;}
if(!liberal&&(x-offW.left>scroller.clientWidth||y-offW.top>scroller.clientHeight))
return null;var offL=eltOffset(lineSpace,true);return coordsChar(x-offL.left,y-offL.top);}
function onContextMenu(e){var pos=posFromMouse(e),scrollPos=scrollbar.scrollTop;if(!pos||opera)return;if(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))
operation(setCursor)(pos.line,pos.ch);var oldCSS=input.style.cssText;inputDiv.style.position="absolute";input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; "+"border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";leaveInputAlone=true;var val=input.value=getSelection();focusInput();selectInput(input);function rehide(){var newVal=splitLines(input.value).join("\n");if(newVal!=val&&!options.readOnly)operation(replaceSelection)(newVal,"end");inputDiv.style.position="relative";input.style.cssText=oldCSS;if(ie_lt9)scrollbar.scrollTop=scrollPos;leaveInputAlone=false;resetInput(true);slowPoll();}
if(gecko){e_stop(e);var mouseup=connect(window,"mouseup",function(){mouseup();setTimeout(rehide,20);},true);}else{setTimeout(rehide,50);}}
function restartBlink(){clearInterval(blinker);var on=true;cursor.style.visibility="";blinker=setInterval(function(){cursor.style.visibility=(on=!on)?"":"hidden";},650);}
var matching={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function matchBrackets(autoclear){var head=sel.inverted?sel.from:sel.to,line=getLine(head.line),pos=head.ch-1;var match=(pos>=0&&matching[line.text.charAt(pos)])||matching[line.text.charAt(++pos)];if(!match)return;var ch=match.charAt(0),forward=match.charAt(1)==">",d=forward?1:-1,st=line.styles;for(var off=pos+1,i=0,e=st.length;i<e;i+=2)
if((off-=st[i].length)<=0){var style=st[i+1];break;}
var stack=[line.text.charAt(pos)],re=/[(){}[\]]/;function scan(line,from,to){if(!line.text)return;var st=line.styles,pos=forward?0:line.text.length-1,cur;for(var i=forward?0:st.length-2,e=forward?st.length:-2;i!=e;i+=2*d){var text=st[i];if(st[i+1]!=style){pos+=d*text.length;continue;}
for(var j=forward?0:text.length-1,te=forward?text.length:-1;j!=te;j+=d,pos+=d){if(pos>=from&&pos<to&&re.test(cur=text.charAt(j))){var match=matching[cur];if(match.charAt(1)==">"==forward)stack.push(cur);else if(stack.pop()!=match.charAt(0))return{pos:pos,match:false};else if(!stack.length)return{pos:pos,match:true};}}}}
for(var i=head.line,e=forward?Math.min(i+100,doc.size):Math.max(-1,i-100);i!=e;i+=d){var line=getLine(i),first=i==head.line;var found=scan(line,first&&forward?pos+1:0,first&&!forward?pos:line.text.length);if(found)break;}
if(!found)found={pos:null,match:false};var style=found.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";var one=markText({line:head.line,ch:pos},{line:head.line,ch:pos+1},style),two=found.pos!=null&&markText({line:i,ch:found.pos},{line:i,ch:found.pos+1},style);var clear=operation(function(){one.clear();two&&two.clear();});if(autoclear)setTimeout(clear,800);else bracketHighlighted=clear;}
function findStartLine(n){var minindent,minline;for(var search=n,lim=n-40;search>lim;--search){if(search==0)return 0;var line=getLine(search-1);if(line.stateAfter)return search;var indented=line.indentation(options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented;}}
return minline;}
function getStateBefore(n){var start=findStartLine(n),state=start&&getLine(start-1).stateAfter;if(!state)state=startState(mode);else state=copyState(mode,state);doc.iter(start,n,function(line){line.highlight(mode,state,options.tabSize);line.stateAfter=copyState(mode,state);});if(start<n)changes.push({from:start,to:n});if(n<doc.size&&!getLine(n).stateAfter)work.push(n);return state;}
function highlightLines(start,end){var state=getStateBefore(start);doc.iter(start,end,function(line){line.highlight(mode,state,options.tabSize);line.stateAfter=copyState(mode,state);});}
function highlightWorker(){var end=+new Date+options.workTime;var foundWork=work.length;while(work.length){if(!getLine(showingFrom).stateAfter)var task=showingFrom;else var task=work.pop();if(task>=doc.size)continue;var start=findStartLine(task),state=start&&getLine(start-1).stateAfter;if(state)state=copyState(mode,state);else state=startState(mode);var unchanged=0,compare=mode.compareStates,realChange=false,i=start,bail=false;doc.iter(i,doc.size,function(line){var hadState=line.stateAfter;if(+new Date>end){work.push(i);startWorker(options.workDelay);if(realChange)changes.push({from:task,to:i+1});return(bail=true);}
var changed=line.highlight(mode,state,options.tabSize);if(changed)realChange=true;line.stateAfter=copyState(mode,state);var done=null;if(compare){var same=hadState&&compare(hadState,state);if(same!=Pass)done=!!same;}
if(done==null){if(changed!==false||!hadState)unchanged=0;else if(++unchanged>3&&(!mode.indent||mode.indent(hadState,"")==mode.indent(state,"")))
done=true;}
if(done)return true;++i;});if(bail)return;if(realChange)changes.push({from:task,to:i+1});}
if(foundWork&&options.onHighlightComplete)
options.onHighlightComplete(instance);}
function startWorker(time){if(!work.length)return;highlight.set(time,operation(highlightWorker));}
function startOperation(){updateInput=userSelChange=textChanged=null;changes=[];selectionChanged=false;callbacks=[];}
function endOperation(){if(updateMaxLine)computeMaxLength();if(maxLineChanged&&!options.lineWrapping){var cursorWidth=widthForcer.offsetWidth,left=stringWidth(maxLine);widthForcer.style.left=left+"px";lineSpace.style.minWidth=(left+cursorWidth)+"px";maxLineChanged=false;}
var newScrollPos,updated;if(selectionChanged){var coords=calculateCursorCoords();newScrollPos=calculateScrollPos(coords.x,coords.y,coords.x,coords.yBot);}
if(changes.length)updated=updateDisplay(changes,true,(newScrollPos?newScrollPos.scrollTop:null));else{if(selectionChanged)updateSelection();if(gutterDirty)updateGutter();}
if(newScrollPos)scrollCursorIntoView();if(selectionChanged){scrollEditorIntoView();restartBlink();}
if(focused&&!leaveInputAlone&&(updateInput===true||(updateInput!==false&&selectionChanged)))
resetInput(userSelChange);if(selectionChanged&&options.matchBrackets)
setTimeout(operation(function(){if(bracketHighlighted){bracketHighlighted();bracketHighlighted=null;}
if(posEq(sel.from,sel.to))matchBrackets(false);}),20);var sc=selectionChanged,cbs=callbacks;if(textChanged&&options.onChange&&instance)
options.onChange(instance,textChanged);if(sc&&options.onCursorActivity)
options.onCursorActivity(instance);for(var i=0;i<cbs.length;++i)cbs[i](instance);if(updated&&options.onUpdate)options.onUpdate(instance);}
var nestedOperation=0;function operation(f){return function(){if(!nestedOperation++)startOperation();try{var result=f.apply(this,arguments);}
finally{if(!--nestedOperation)endOperation();}
return result;};}
function compoundChange(f){history.startCompound();try{return f();}finally{history.endCompound();}}
for(var ext in extensions)
if(extensions.propertyIsEnumerable(ext)&&!instance.propertyIsEnumerable(ext))
instance[ext]=extensions[ext];return instance;}
CodeMirror.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:false,smartIndent:true,tabSize:4,keyMap:"default",extraKeys:null,electricChars:true,autoClearEmptyLines:false,onKeyEvent:null,onDragEvent:null,lineWrapping:false,lineNumbers:false,gutter:false,fixedGutter:false,firstLineNumber:1,readOnly:false,dragDrop:true,onChange:null,onCursorActivity:null,onGutterClick:null,onHighlightComplete:null,onUpdate:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:false,workTime:100,workDelay:200,pollInterval:100,undoDepth:40,tabindex:null,autofocus:null,lineNumberFormatter:function(integer){return integer;}};var ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var mac=ios||/Mac/.test(navigator.platform);var win=/Win/.test(navigator.platform);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(!CodeMirror.defaults.mode&&name!="null")CodeMirror.defaults.mode=name;if(arguments.length>2){mode.dependencies=[];for(var i=2;i<arguments.length;++i)mode.dependencies.push(arguments[i]);}
modes[name]=mode;};CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec;};CodeMirror.resolveMode=function(spec){if(typeof spec=="string"&&mimeModes.hasOwnProperty(spec))
spec=mimeModes[spec];else if(typeof spec=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))
return CodeMirror.resolveMode("application/xml");if(typeof spec=="string")return{name:spec};else return spec||{name:"null"};};CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");return mfactory(options,spec);};CodeMirror.listModes=function(){var list=[];for(var m in modes)
if(modes.propertyIsEnumerable(m))list.push(m);return list;};CodeMirror.listMIMEs=function(){var list=[];for(var m in mimeModes)
if(mimeModes.propertyIsEnumerable(m))list.push({mime:m,mode:mimeModes[m]});return list;};var extensions=CodeMirror.extensions={};CodeMirror.defineExtension=function(name,func){extensions[name]=func;};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection({line:0,ch:0},{line:cm.lineCount()-1});},killLine:function(cm){var from=cm.getCursor(true),to=cm.getCursor(false),sel=!posEq(from,to);if(!sel&&cm.getLine(from.line).length==from.ch)cm.replaceRange("",from,{line:from.line+1,ch:0});else cm.replaceRange("",from,sel?to:{line:from.line});},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange("",{line:l,ch:0},{line:l});},undo:function(cm){cm.undo();},redo:function(cm){cm.redo();},goDocStart:function(cm){cm.setCursor(0,0,true);},goDocEnd:function(cm){cm.setSelection({line:cm.lineCount()-1},null,true);},goLineStart:function(cm){cm.setCursor(cm.getCursor().line,0,true);},goLineStartSmart:function(cm){var cur=cm.getCursor();var text=cm.getLine(cur.line),firstNonWS=Math.max(0,text.search(/\S/));cm.setCursor(cur.line,cur.ch<=firstNonWS&&cur.ch?0:firstNonWS,true);},goLineEnd:function(cm){cm.setSelection({line:cm.getCursor().line},null,true);},goLineUp:function(cm){cm.moveV(-1,"line");},goLineDown:function(cm){cm.moveV(1,"line");},goPageUp:function(cm){cm.moveV(-1,"page");},goPageDown:function(cm){cm.moveV(1,"page");},goCharLeft:function(cm){cm.moveH(-1,"char");},goCharRight:function(cm){cm.moveH(1,"char");},goColumnLeft:function(cm){cm.moveH(-1,"column");},goColumnRight:function(cm){cm.moveH(1,"column");},goWordLeft:function(cm){cm.moveH(-1,"word");},goWordRight:function(cm){cm.moveH(1,"word");},delCharLeft:function(cm){cm.deleteH(-1,"char");},delCharRight:function(cm){cm.deleteH(1,"char");},delWordLeft:function(cm){cm.deleteH(-1,"word");},delWordRight:function(cm){cm.deleteH(1,"word");},indentAuto:function(cm){cm.indentSelection("smart");},indentMore:function(cm){cm.indentSelection("add");},indentLess:function(cm){cm.indentSelection("subtract");},insertTab:function(cm){cm.replaceSelection("\t","end");},defaultTab:function(cm){if(cm.somethingSelected())cm.indentSelection("add");else cm.replaceSelection("\t","end");},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);if(cur.ch>0&&cur.ch<line.length-1)
cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),{line:cur.line,ch:cur.ch-1},{line:cur.line,ch:cur.ch+1});},newlineAndIndent:function(cm){cm.replaceSelection("\n","end");cm.indentLine(cm.getCursor().line);},toggleOverwrite:function(cm){cm.toggleOverwrite();}};var keyMap=CodeMirror.keyMap={};keyMap.basic={"Left":"goCharLeft","Right":"goCharRight","Up":"goLineUp","Down":"goLineDown","End":"goLineEnd","Home":"goLineStartSmart","PageUp":"goPageUp","PageDown":"goPageDown","Delete":"delCharRight","Backspace":"delCharLeft","Tab":"defaultTab","Shift-Tab":"indentAuto","Enter":"newlineAndIndent","Insert":"toggleOverwrite"};keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordLeft","Ctrl-Delete":"delWordRight","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"};keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordLeft","Ctrl-Alt-Backspace":"delWordRight","Alt-Delete":"delWordRight","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]};keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault;keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageUp","Shift-Ctrl-V":"goPageDown","Ctrl-D":"delCharRight","Ctrl-H":"delCharLeft","Alt-D":"delWordRight","Alt-Backspace":"delWordLeft","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};function getKeyMap(val){if(typeof val=="string")return keyMap[val];else return val;}
function lookupKey(name,extraMap,map,handle,stop){function lookup(map){map=getKeyMap(map);var found=map[name];if(found!=null&&handle(found))return true;if(map.nofallthrough){if(stop)stop();return true;}
var fallthrough=map.fallthrough;if(fallthrough==null)return false;if(Object.prototype.toString.call(fallthrough)!="[object Array]")
return lookup(fallthrough);for(var i=0,e=fallthrough.length;i<e;++i){if(lookup(fallthrough[i]))return true;}
return false;}
if(extraMap&&lookup(extraMap))return true;return lookup(map);}
function isModifierKey(event){var name=keyNames[e_prop(event,"keyCode")];return name=="Ctrl"||name=="Alt"||name=="Shift"||name=="Mod";}
CodeMirror.fromTextArea=function(textarea,options){if(!options)options={};options.value=textarea.value;if(!options.tabindex&&textarea.tabindex)
options.tabindex=textarea.tabindex;if(options.autofocus==null&&textarea.getAttribute("autofocus")!=null)
options.autofocus=true;function save(){textarea.value=instance.getValue();}
if(textarea.form){var rmSubmit=connect(textarea.form,"submit",save,true);if(typeof textarea.form.submit=="function"){var realSubmit=textarea.form.submit;function wrappedSubmit(){save();textarea.form.submit=realSubmit;textarea.form.submit();textarea.form.submit=wrappedSubmit;}
textarea.form.submit=wrappedSubmit;}}
textarea.style.display="none";var instance=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling);},options);instance.save=save;instance.getTextArea=function(){return textarea;};instance.toTextArea=function(){save();textarea.parentNode.removeChild(instance.getWrapperElement());textarea.style.display="";if(textarea.form){rmSubmit();if(typeof textarea.form.submit=="function")
textarea.form.submit=realSubmit;}};return instance;};function copyState(mode,state){if(state===true)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];if(val instanceof Array)val=val.concat([]);nstate[n]=val;}
return nstate;}
CodeMirror.copyState=copyState;function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true;}
CodeMirror.startState=startState;function StringStream(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;}
StringStream.prototype={eol:function(){return this.pos>=this.string.length;},sol:function(){return this.pos==0;},peek:function(){return this.string.charAt(this.pos);},next:function(){if(this.pos<this.string.length)
return this.string.charAt(this.pos++);},eat:function(match){var ch=this.string.charAt(this.pos);if(typeof match=="string")var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));if(ok){++this.pos;return ch;}},eatWhile:function(match){var start=this.pos;while(this.eat(match)){}
return this.pos>start;},eatSpace:function(){var start=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>start;},skipToEnd:function(){this.pos=this.string.length;},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true;}},backUp:function(n){this.pos-=n;},column:function(){return countColumn(this.string,this.start,this.tabSize);},indentation:function(){return countColumn(this.string,null,this.tabSize);},match:function(pattern,consume,caseInsensitive){if(typeof pattern=="string"){function cased(str){return caseInsensitive?str.toLowerCase():str;}
if(cased(this.string).indexOf(cased(pattern),this.pos)==this.pos){if(consume!==false)this.pos+=pattern.length;return true;}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&consume!==false)this.pos+=match[0].length;return match;}},current:function(){return this.string.slice(this.start,this.pos);}};CodeMirror.StringStream=StringStream;function MarkedText(from,to,className,marker){this.from=from;this.to=to;this.style=className;this.marker=marker;}
MarkedText.prototype={attach:function(line){this.marker.set.push(line);},detach:function(line){var ix=indexOf(this.marker.set,line);if(ix>-1)this.marker.set.splice(ix,1);},split:function(pos,lenBefore){if(this.to<=pos&&this.to!=null)return null;var from=this.from<pos||this.from==null?null:this.from-pos+lenBefore;var to=this.to==null?null:this.to-pos+lenBefore;return new MarkedText(from,to,this.style,this.marker);},dup:function(){return new MarkedText(null,null,this.style,this.marker);},clipTo:function(fromOpen,from,toOpen,to,diff){if(fromOpen&&to>this.from&&(to<this.to||this.to==null))
this.from=null;else if(this.from!=null&&this.from>=from)
this.from=Math.max(to,this.from)+diff;if(toOpen&&(from<this.to||this.to==null)&&(from>this.from||this.from==null))
this.to=null;else if(this.to!=null&&this.to>from)
this.to=to<this.to?this.to+diff:from;},isDead:function(){return this.from!=null&&this.to!=null&&this.from>=this.to;},sameSet:function(x){return this.marker==x.marker;}};function Bookmark(pos){this.from=pos;this.to=pos;this.line=null;}
Bookmark.prototype={attach:function(line){this.line=line;},detach:function(line){if(this.line==line)this.line=null;},split:function(pos,lenBefore){if(pos<this.from){this.from=this.to=(this.from-pos)+lenBefore;return this;}},isDead:function(){return this.from>this.to;},clipTo:function(fromOpen,from,toOpen,to,diff){if((fromOpen||from<this.from)&&(toOpen||to>this.to)){this.from=0;this.to=-1;}else if(this.from>from){this.from=this.to=Math.max(to,this.from)+diff;}},sameSet:function(x){return false;},find:function(){if(!this.line||!this.line.parent)return null;return{line:lineNo(this.line),ch:this.from};},clear:function(){if(this.line){var found=indexOf(this.line.marked,this);if(found!=-1)this.line.marked.splice(found,1);this.line=null;}}};function Line(text,styles){this.styles=styles||[text,null];this.text=text;this.height=1;this.marked=this.gutterMarker=this.className=this.bgClassName=this.handlers=null;this.stateAfter=this.parent=this.hidden=null;}
Line.inheritMarks=function(text,orig){var ln=new Line(text),mk=orig&&orig.marked;if(mk){for(var i=0;i<mk.length;++i){if(mk[i].to==null&&mk[i].style){var newmk=ln.marked||(ln.marked=[]),mark=mk[i];var nmark=mark.dup();newmk.push(nmark);nmark.attach(ln);}}}
return ln;}
Line.prototype={replace:function(from,to_,text){var st=[],mk=this.marked,to=to_==null?this.text.length:to_;copyStyles(0,from,this.styles,st);if(text)st.push(text,null);copyStyles(to,this.text.length,this.styles,st);this.styles=st;this.text=this.text.slice(0,from)+text+this.text.slice(to);this.stateAfter=null;if(mk){var diff=text.length-(to-from);for(var i=0;i<mk.length;++i){var mark=mk[i];mark.clipTo(from==null,from||0,to_==null,to,diff);if(mark.isDead()){mark.detach(this);mk.splice(i--,1);}}}},split:function(pos,textBefore){var st=[textBefore,null],mk=this.marked;copyStyles(pos,this.text.length,this.styles,st);var taken=new Line(textBefore+this.text.slice(pos),st);if(mk){for(var i=0;i<mk.length;++i){var mark=mk[i];var newmark=mark.split(pos,textBefore.length);if(newmark){if(!taken.marked)taken.marked=[];taken.marked.push(newmark);newmark.attach(taken);if(newmark==mark)mk.splice(i--,1);}}}
return taken;},append:function(line){var mylen=this.text.length,mk=line.marked,mymk=this.marked;this.text+=line.text;copyStyles(0,line.text.length,line.styles,this.styles);if(mymk){for(var i=0;i<mymk.length;++i)
if(mymk[i].to==null)mymk[i].to=mylen;}
if(mk&&mk.length){if(!mymk)this.marked=mymk=[];outer:for(var i=0;i<mk.length;++i){var mark=mk[i];if(!mark.from){for(var j=0;j<mymk.length;++j){var mymark=mymk[j];if(mymark.to==mylen&&mymark.sameSet(mark)){mymark.to=mark.to==null?null:mark.to+mylen;if(mymark.isDead()){mymark.detach(this);mk.splice(i--,1);}
continue outer;}}}
mymk.push(mark);mark.attach(this);mark.from+=mylen;if(mark.to!=null)mark.to+=mylen;}}},fixMarkEnds:function(other){var mk=this.marked,omk=other.marked;if(!mk)return;outer:for(var i=0;i<mk.length;++i){var mark=mk[i],close=mark.to==null;if(close&&omk){for(var j=0;j<omk.length;++j){var om=omk[j];if(!om.sameSet(mark)||om.from!=null)continue
if(mark.from==this.text.length&&om.to==0){omk.splice(j,1);mk.splice(i--,1);continue outer;}else{close=false;break;}}}
if(close)mark.to=this.text.length;}},fixMarkStarts:function(){var mk=this.marked;if(!mk)return;for(var i=0;i<mk.length;++i)
if(mk[i].from==null)mk[i].from=0;},addMark:function(mark){mark.attach(this);if(this.marked==null)this.marked=[];this.marked.push(mark);this.marked.sort(function(a,b){return(a.from||0)-(b.from||0);});},highlight:function(mode,state,tabSize){var stream=new StringStream(this.text,tabSize),st=this.styles,pos=0;var changed=false,curWord=st[0],prevWord;if(this.text==""&&mode.blankLine)mode.blankLine(state);while(!stream.eol()){var style=mode.token(stream,state);var substr=this.text.slice(stream.start,stream.pos);stream.start=stream.pos;if(pos&&st[pos-1]==style)
st[pos-2]+=substr;else if(substr){if(!changed&&(st[pos+1]!=style||(pos&&st[pos-2]!=prevWord)))changed=true;st[pos++]=substr;st[pos++]=style;prevWord=curWord;curWord=st[pos];}
if(stream.pos>5000){st[pos++]=this.text.slice(stream.pos);st[pos++]=null;break;}}
if(st.length!=pos){st.length=pos;changed=true;}
if(pos&&st[pos-2]!=prevWord)changed=true;return changed||(st.length<5&&this.text.length<10?null:false);},getTokenAt:function(mode,state,ch){var txt=this.text,stream=new StringStream(txt);while(stream.pos<ch&&!stream.eol()){stream.start=stream.pos;var style=mode.token(stream,state);}
return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,state:state};},indentation:function(tabSize){return countColumn(this.text,null,tabSize);},getHTML:function(makeTab,wrapAt,wrapId,wrapWBR){var html=[],first=true,col=0;function span_(text,style){if(!text)return;if(first&&ie&&text.charAt(0)==" ")text="\u00a0"+text.slice(1);first=false;if(text.indexOf("\t")==-1){col+=text.length;var escaped=htmlEscape(text);}else{var escaped="";for(var pos=0;;){var idx=text.indexOf("\t",pos);if(idx==-1){escaped+=htmlEscape(text.slice(pos));col+=text.length-pos;break;}else{col+=idx-pos;var tab=makeTab(col);escaped+=htmlEscape(text.slice(pos,idx))+tab.html;col+=tab.width;pos=idx+1;}}}
if(style)html.push('<span class="',style,'">',escaped,"</span>");else html.push(escaped);}
var span=span_;if(wrapAt!=null){var outPos=0,open="<span id=\""+wrapId+"\">";span=function(text,style){var l=text.length;if(wrapAt>=outPos&&wrapAt<outPos+l){if(wrapAt>outPos){span_(text.slice(0,wrapAt-outPos),style);if(wrapWBR)html.push("<wbr>");}
html.push(open);var cut=wrapAt-outPos;span_(opera?text.slice(cut,cut+1):text.slice(cut),style);html.push("</span>");if(opera)span_(text.slice(cut+1),style);wrapAt--;outPos+=l;}else{outPos+=l;span_(text,style);if(outPos==wrapAt&&outPos==len)
html.push(open+(gecko||(ie&&!ie_lt8)?"&#x200b;":" ")+"</span>");else if(outPos>wrapAt+10&&/\s/.test(text))span=function(){};}}}
var st=this.styles,allText=this.text,marked=this.marked;var len=allText.length;function styleToClass(style){if(!style)return null;return"cm-"+style.replace(/ +/g," cm-");}
if(!allText&&wrapAt==null){span(" ");}else if(!marked||!marked.length){for(var i=0,ch=0;ch<len;i+=2){var str=st[i],style=st[i+1],l=str.length;if(ch+l>len)str=str.slice(0,len-ch);ch+=l;span(str,styleToClass(style));}}else{var pos=0,i=0,text="",style,sg=0;var nextChange=marked[0].from||0,marks=[],markpos=0;function advanceMarks(){var m;while(markpos<marked.length&&((m=marked[markpos]).from==pos||m.from==null)){if(m.style!=null)marks.push(m);++markpos;}
nextChange=markpos<marked.length?marked[markpos].from:Infinity;for(var i=0;i<marks.length;++i){var to=marks[i].to;if(to==null)to=Infinity;if(to==pos)marks.splice(i--,1);else nextChange=Math.min(to,nextChange);}}
var m=0;while(pos<len){if(nextChange==pos)advanceMarks();var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;var appliedStyle=style;for(var j=0;j<marks.length;++j)
appliedStyle=(appliedStyle?appliedStyle+" ":"")+marks[j].style;span(end>upto?text.slice(0,upto-pos):text,appliedStyle);if(end>=upto){text=text.slice(upto-pos);pos=upto;break;}
pos=end;}
text=st[i++];style=styleToClass(st[i++]);}}}
return html.join("");},cleanUp:function(){this.parent=null;if(this.marked)
for(var i=0,e=this.marked.length;i<e;++i)this.marked[i].detach(this);}};function copyStyles(from,to,source,dest){for(var i=0,pos=0,state=0;pos<to;i+=2){var part=source[i],end=pos+part.length;if(state==0){if(end>from)dest.push(part.slice(from-pos,Math.min(part.length,to-pos)),source[i+1]);if(end>=from)state=1;}else if(state==1){if(end>to)dest.push(part.slice(0,to-pos),source[i+1]);else dest.push(part,source[i+1]);}
pos=end;}}
function LeafChunk(lines){this.lines=lines;this.parent=null;for(var i=0,e=lines.length,height=0;i<e;++i){lines[i].parent=this;height+=lines[i].height;}
this.height=height;}
LeafChunk.prototype={chunkSize:function(){return this.lines.length;},remove:function(at,n,callbacks){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;line.cleanUp();if(line.handlers)
for(var j=0;j<line.handlers.length;++j)callbacks.push(line.handlers[j]);}
this.lines.splice(at,n);},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines));},insertHeight:function(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;i<e;++i)lines[i].parent=this;},iterN:function(at,n,op){for(var e=at+n;at<e;++at)
if(op(this.lines[at]))return true;}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0,e=children.length;i<e;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this;}
this.size=size;this.height=height;this.parent=null;}
BranchChunk.prototype={chunkSize:function(){return this.size;},remove:function(at,n,callbacks){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.remove(at,rm,callbacks);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null;}
if((n-=rm)==0)break;at=0;}else at-=sz;}
if(this.size-n<25){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this;}},collapse:function(lines){for(var i=0,e=this.children.length;i<e;++i)this.children[i].collapse(lines);},insert:function(at,lines){var height=0;for(var i=0,e=lines.length;i<e;++i)height+=lines[i].height;this.insertHeight(at,lines,height);},insertHeight:function(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertHeight(at,lines,height);if(child.lines&&child.lines.length>50){while(child.lines.length>50){var spilled=child.lines.splice(child.lines.length-25,25);var newleaf=new LeafChunk(spilled);child.height-=newleaf.height;this.children.splice(i+1,0,newleaf);newleaf.parent=this;}
this.maybeSpill();}
break;}
at-=sz;}},maybeSpill:function(){if(this.children.length<=10)return;var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy;}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling);}
sibling.parent=me.parent;}while(me.children.length>10);me.parent.maybeSpill();},iter:function(from,to,op){this.iterN(from,to-from,op);},iterN:function(at,n,op){for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return true;if((n-=used)==0)break;at=0;}else at-=sz;}}};function getLineAt(chunk,n){while(!chunk.lines){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break;}
n-=sz;}}
return chunk.lines[n];}
function lineNo(line){if(line.parent==null)return null;var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0,e=chunk.children.length;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize();}}
return no;}
function lineAtHeight(chunk,h){var n=0;outer:do{for(var i=0,e=chunk.children.length;i<e;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer;}
h-=ch;n+=child.chunkSize();}
return n;}while(!chunk.lines);for(var i=0,e=chunk.lines.length;i<e;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh;}
return n+i;}
function heightAtLine(chunk,n){var h=0;outer:do{for(var i=0,e=chunk.children.length;i<e;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;continue outer;}
n-=sz;h+=child.height;}
return h;}while(!chunk.lines);for(var i=0;i<n;++i)h+=chunk.lines[i].height;return h;}
function History(){this.time=0;this.done=[];this.undone=[];this.compound=0;this.closed=false;}
History.prototype={addChange:function(start,added,old){this.undone.length=0;var time=+new Date,cur=this.done[this.done.length-1],last=cur&&cur[cur.length-1];var dtime=time-this.time;if(this.compound&&cur&&!this.closed){cur.push({start:start,added:added,old:old});}else if(dtime>400||!last||this.closed||last.start>start+old.length||last.start+last.added<start){this.done.push([{start:start,added:added,old:old}]);this.closed=false;}else{var startBefore=Math.max(0,last.start-start),endAfter=Math.max(0,(start+old.length)-(last.start+last.added));for(var i=startBefore;i>0;--i)last.old.unshift(old[i-1]);for(var i=endAfter;i>0;--i)last.old.push(old[old.length-i]);if(startBefore)last.start=start;last.added+=added-(old.length-startBefore-endAfter);}
this.time=time;},startCompound:function(){if(!this.compound++)this.closed=true;},endCompound:function(){if(!--this.compound)this.closed=true;}};function stopMethod(){e_stop(this);}
function addStop(event){if(!event.stop)event.stop=stopMethod;return event;}
function e_preventDefault(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false;}
function e_stopPropagation(e){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;}
function e_stop(e){e_preventDefault(e);e_stopPropagation(e);}
CodeMirror.e_stop=e_stop;CodeMirror.e_preventDefault=e_preventDefault;CodeMirror.e_stopPropagation=e_stopPropagation;function e_target(e){return e.target||e.srcElement;}
function e_button(e){var b=e.which;if(b==null){if(e.button&1)b=1;else if(e.button&2)b=3;else if(e.button&4)b=2;}
if(mac&&e.ctrlKey&&b==1)b=3;return b;}
function e_prop(e,prop){var overridden=e.override&&e.override.hasOwnProperty(prop);return overridden?e.override[prop]:e[prop];}
function connect(node,type,handler,disconnect){if(typeof node.addEventListener=="function"){node.addEventListener(type,handler,false);if(disconnect)return function(){node.removeEventListener(type,handler,false);};}else{var wrapHandler=function(event){handler(event||window.event);};node.attachEvent("on"+type,wrapHandler);if(disconnect)return function(){node.detachEvent("on"+type,wrapHandler);};}}
CodeMirror.connect=connect;function Delayed(){this.id=null;}
Delayed.prototype={set:function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms);}};var Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass";}};var gecko=/gecko\/\d{7}/i.test(navigator.userAgent);var ie=/MSIE \d/.test(navigator.userAgent);var ie_lt8=/MSIE [1-7]\b/.test(navigator.userAgent);var ie_lt9=/MSIE [1-8]\b/.test(navigator.userAgent);var quirksMode=ie&&document.documentMode==5;var webkit=/WebKit\//.test(navigator.userAgent);var chrome=/Chrome\//.test(navigator.userAgent);var opera=/Opera\//.test(navigator.userAgent);var safari=/Apple Computer/.test(navigator.vendor);var khtml=/KHTML\//.test(navigator.userAgent);var mac_geLion=/Mac OS X 10\D([7-9]|\d\d)\D/.test(navigator.userAgent);var dragAndDrop=function(){if(ie_lt9)return false;var div=document.createElement('div');return"draggable"in div||"dragDrop"in div;}();var lineSep=function(){var te=document.createElement("textarea");te.value="foo\nbar";if(te.value.indexOf("\r")>-1)return"\r\n";return"\n";}();var spanAffectsWrapping=/^$/;if(gecko)spanAffectsWrapping=/$'/;else if(safari)spanAffectsWrapping=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/;else if(chrome)spanAffectsWrapping=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/;function countColumn(string,end,tabSize){if(end==null){end=string.search(/[^\s\u00a0]/);if(end==-1)end=string.length;}
for(var i=0,n=0;i<end;++i){if(string.charAt(i)=="\t")n+=tabSize-(n%tabSize);else++n;}
return n;}
function computedStyle(elt){if(elt.currentStyle)return elt.currentStyle;return window.getComputedStyle(elt,null);}
function eltOffset(node,screen){try{var box=node.getBoundingClientRect();box={top:box.top,left:box.left};}
catch(e){box={top:0,left:0};}
if(!screen){if(window.pageYOffset==null){var t=document.documentElement||document.body.parentNode;if(t.scrollTop==null)t=document.body;box.top+=t.scrollTop;box.left+=t.scrollLeft;}else{box.top+=window.pageYOffset;box.left+=window.pageXOffset;}}
return box;}
function eltText(node){return node.textContent||node.innerText||node.nodeValue||"";}
function selectInput(node){if(ios){node.selectionStart=0;node.selectionEnd=node.value.length;}else node.select();}
function posEq(a,b){return a.line==b.line&&a.ch==b.ch;}
function posLess(a,b){return a.line<b.line||(a.line==b.line&&a.ch<b.ch);}
function copyPos(x){return{line:x.line,ch:x.ch};}
var escapeElement=document.createElement("pre");function htmlEscape(str){escapeElement.textContent=str;return escapeElement.innerHTML;}
if(htmlEscape("a")=="\na"){htmlEscape=function(str){escapeElement.textContent=str;return escapeElement.innerHTML.slice(1);};}else if(htmlEscape("\t")!="\t"){htmlEscape=function(str){escapeElement.innerHTML="";escapeElement.appendChild(document.createTextNode(str));return escapeElement.innerHTML;};}
CodeMirror.htmlEscape=htmlEscape;function editEnd(from,to){if(!to)return 0;if(!from)return to.length;for(var i=from.length,j=to.length;i>=0&&j>=0;--i,--j)
if(from.charAt(i)!=to.charAt(j))break;return j+1;}
function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;i<e;++i)
if(collection[i]==elt)return i;return-1;}
function isWordChar(ch){return/\w/.test(ch)||ch.toUpperCase()!=ch.toLowerCase();}
var splitLines="\n\nb".split(/\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf("\n",pos);if(nl==-1)nl=string.length;var line=string.slice(pos,string.charAt(nl-1)=="\r"?nl-1:nl);var rt=line.indexOf("\r");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1;}else{result.push(line);pos=nl+1;}}
return result;}:function(string){return string.split(/\r\n?|\n/);};CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd;}
catch(e){return false;}}:function(te){try{var range=te.ownerDocument.selection.createRange();}
catch(e){}
if(!range||range.parentElement()!=te)return false;return range.compareEndPoints("StartToEnd",range)!=0;};CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd();}};});CodeMirror.defineMIME("text/plain","null");var keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};CodeMirror.keyNames=keyNames;(function(){for(var i=0;i<10;i++)keyNames[i+48]=String(i);for(var i=65;i<=90;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;i<=12;i++)keyNames[i+111]=keyNames[i+63235]="F"+i;})();return CodeMirror;})();(function(){if(!CodeMirror.modeURL)CodeMirror.modeURL="../mode/%N/%N.js";var loading={};function splitCallback(cont,n){var countDown=n;return function(){if(--countDown==0)cont();}}
function ensureDeps(mode,cont){var deps=CodeMirror.modes[mode].dependencies;if(!deps)return cont();var missing=[];for(var i=0;i<deps.length;++i){if(!CodeMirror.modes.hasOwnProperty(deps[i]))
missing.push(deps[i]);}
if(!missing.length)return cont();var split=splitCallback(cont,missing.length);for(var i=0;i<missing.length;++i)
CodeMirror.requireMode(missing[i],split);}
CodeMirror.requireMode=function(mode,cont){if(typeof mode!="string")mode=mode.name;if(CodeMirror.modes.hasOwnProperty(mode))return ensureDeps(mode,cont);if(loading.hasOwnProperty(mode))return loading[mode].push(cont);var script=document.createElement("script");script.src=CodeMirror.modeURL.replace(/%N/g,mode);var others=document.getElementsByTagName("script")[0];others.parentNode.insertBefore(script,others);var list=loading[mode]=[cont];var count=0,poll=setInterval(function(){if(++count>100)return clearInterval(poll);if(CodeMirror.modes.hasOwnProperty(mode)){clearInterval(poll);loading[mode]=null;ensureDeps(mode,function(){for(var i=0;i<list.length;++i)list[i]();});}},200);};CodeMirror.autoLoadMode=function(instance,mode){if(!CodeMirror.modes.hasOwnProperty(mode))
CodeMirror.requireMode(mode,function(){instance.setOption("mode",instance.getOption("mode"));});};}());CodeMirror.multiplexingMode=function(outer){var others=Array.prototype.slice.call(arguments,1);var n_others=others.length;function indexOf(string,pattern,from){if(typeof pattern=="string")return string.indexOf(pattern,from);var m=pattern.exec(from?string.slice(from):string);return m?m.index+from:-1;}
return{startState:function(){return{outer:CodeMirror.startState(outer),innerActive:null,inner:null};},copyState:function(state){return{outer:CodeMirror.copyState(outer,state.outer),innerActive:state.innerActive,inner:state.innerActive&&CodeMirror.copyState(state.innerActive.mode,state.inner)};},token:function(stream,state){if(!state.innerActive){var cutOff=Infinity,oldContent=stream.string;for(var i=0;i<n_others;++i){var other=others[i];var found=indexOf(oldContent,other.open,stream.pos);if(found==stream.pos){stream.match(other.open);state.innerActive=other;state.inner=CodeMirror.startState(other.mode,outer.indent(state.outer,""));return other.delimStyle;}else if(found!=-1&&found<cutOff){cutOff=found;}}
if(cutOff!=Infinity)stream.string=oldContent.slice(0,cutOff);var outerToken=outer.token(stream,state.outer);if(cutOff!=Infinity)stream.string=oldContent;return outerToken;}else{var curInner=state.innerActive,oldContent=stream.string;var found=indexOf(oldContent,curInner.close,stream.pos);if(found==stream.pos){stream.match(curInner.close);state.innerActive=state.inner=null;return curInner.delimStyle;}
if(found>-1)stream.string=oldContent.slice(0,found);var innerToken=curInner.mode.token(stream,state.inner);if(found>-1)stream.string=oldContent;var cur=stream.current(),found=cur.indexOf(curInner.close);if(found>-1)stream.backUp(cur.length-found);return innerToken;}},indent:function(state,textAfter){var mode=state.innerActive?state.innerActive.mode:outer;if(!mode.indent)return CodeMirror.Pass;return mode.indent(state.innerActive?state.inner:state.outer,textAfter);},compareStates:function(a,b){if(a.innerActive!=b.innerActive)return false;var mode=a.innerActive||outer;if(!mode.compareStates)return CodeMirror.Pass;return mode.compareStates(a.innerActive?a.inner:a.outer,b.innerActive?b.inner:b.outer);},electricChars:outer.electricChars};};CodeMirror.defineMode("python",function(conf,parserConf){var ERRORCLASS='error';function wordRegexp(words){return new RegExp("^(("+words.join(")|(")+"))\\b");}
var singleOperators=new RegExp("^[\\+\\-\\*/%&|\\^~<>!\\?]");var singleDelimiters=new RegExp('^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]');var doubleOperators=new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var doubleDelimiters=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var tripleDelimiters=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var identifiers=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var wordOperators=wordRegexp(['and','or','not','is','in']);var commonkeywords=['as','assert','break','class','continue','def','del','elif','else','except','finally','for','from','global','if','import','lambda','pass','raise','return','try','while','with','yield'];var commonBuiltins=['abs','all','any','bin','bool','bytearray','callable','chr','classmethod','compile','complex','delattr','dict','dir','divmod','enumerate','eval','filter','float','format','frozenset','getattr','globals','hasattr','hash','help','hex','id','input','int','isinstance','issubclass','iter','len','list','locals','map','max','memoryview','min','next','object','oct','open','ord','pow','property','range','repr','reversed','round','set','setattr','slice','sorted','staticmethod','str','sum','super','tuple','type','vars','zip','__import__','NotImplemented','Ellipsis','__debug__'];var py2={'builtins':['apply','basestring','buffer','cmp','coerce','execfile','file','intern','long','raw_input','reduce','reload','unichr','unicode','xrange','False','True','None'],'keywords':['exec','print']};var py3={'builtins':['ascii','bytes','exec','print'],'keywords':['nonlocal','False','True','None']};if(!!parserConf.version&&parseInt(parserConf.version,10)===3){commonkeywords=commonkeywords.concat(py3.keywords);commonBuiltins=commonBuiltins.concat(py3.builtins);var stringPrefixes=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i");}else{commonkeywords=commonkeywords.concat(py2.keywords);commonBuiltins=commonBuiltins.concat(py2.builtins);var stringPrefixes=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i");}
var keywords=wordRegexp(commonkeywords);var builtins=wordRegexp(commonBuiltins);var indentInfo=null;function tokenBase(stream,state){if(stream.sol()){var scopeOffset=state.scopes[0].offset;if(stream.eatSpace()){var lineOffset=stream.indentation();if(lineOffset>scopeOffset){indentInfo='indent';}else if(lineOffset<scopeOffset){indentInfo='dedent';}
return null;}else{if(scopeOffset>0){dedent(stream,state);}}}
if(stream.eatSpace()){return null;}
var ch=stream.peek();if(ch==='#'){stream.skipToEnd();return'comment';}
if(stream.match(/^[0-9\.]/,false)){var floatLiteral=false;if(stream.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)){floatLiteral=true;}
if(stream.match(/^\d+\.\d*/)){floatLiteral=true;}
if(stream.match(/^\.\d+/)){floatLiteral=true;}
if(floatLiteral){stream.eat(/J/i);return'number';}
var intLiteral=false;if(stream.match(/^0x[0-9a-f]+/i)){intLiteral=true;}
if(stream.match(/^0b[01]+/i)){intLiteral=true;}
if(stream.match(/^0o[0-7]+/i)){intLiteral=true;}
if(stream.match(/^[1-9]\d*(e[\+\-]?\d+)?/)){stream.eat(/J/i);intLiteral=true;}
if(stream.match(/^0(?![\dx])/i)){intLiteral=true;}
if(intLiteral){stream.eat(/L/i);return'number';}}
if(stream.match(stringPrefixes)){state.tokenize=tokenStringFactory(stream.current());return state.tokenize(stream,state);}
if(stream.match(tripleDelimiters)||stream.match(doubleDelimiters)){return null;}
if(stream.match(doubleOperators)||stream.match(singleOperators)||stream.match(wordOperators)){return'operator';}
if(stream.match(singleDelimiters)){return null;}
if(stream.match(keywords)){return'keyword';}
if(stream.match(builtins)){return'builtin';}
if(stream.match(identifiers)){return'variable';}
stream.next();return ERRORCLASS;}
function tokenStringFactory(delimiter){while('rub'.indexOf(delimiter.charAt(0).toLowerCase())>=0){delimiter=delimiter.substr(1);}
var singleline=delimiter.length==1;var OUTCLASS='string';return function tokenString(stream,state){while(!stream.eol()){stream.eatWhile(/[^'"\\]/);if(stream.eat('\\')){stream.next();if(singleline&&stream.eol()){return OUTCLASS;}}else if(stream.match(delimiter)){state.tokenize=tokenBase;return OUTCLASS;}else{stream.eat(/['"]/);}}
if(singleline){if(parserConf.singleLineStringErrors){return ERRORCLASS;}else{state.tokenize=tokenBase;}}
return OUTCLASS;};}
function indent(stream,state,type){type=type||'py';var indentUnit=0;if(type==='py'){if(state.scopes[0].type!=='py'){state.scopes[0].offset=stream.indentation();return;}
for(var i=0;i<state.scopes.length;++i){if(state.scopes[i].type==='py'){indentUnit=state.scopes[i].offset+conf.indentUnit;break;}}}else{indentUnit=stream.column()+stream.current().length;}
state.scopes.unshift({offset:indentUnit,type:type});}
function dedent(stream,state,type){type=type||'py';if(state.scopes.length==1)return;if(state.scopes[0].type==='py'){var _indent=stream.indentation();var _indent_index=-1;for(var i=0;i<state.scopes.length;++i){if(_indent===state.scopes[i].offset){_indent_index=i;break;}}
if(_indent_index===-1){return true;}
while(state.scopes[0].offset!==_indent){state.scopes.shift();}
return false}else{if(type==='py'){state.scopes[0].offset=stream.indentation();return false;}else{if(state.scopes[0].type!=type){return true;}
state.scopes.shift();return false;}}}
function tokenLexer(stream,state){indentInfo=null;var style=state.tokenize(stream,state);var current=stream.current();if(current==='.'){style=stream.match(identifiers,false)?null:ERRORCLASS;if(style===null&&state.lastToken==='meta'){style='meta';}
return style;}
if(current==='@'){return stream.match(identifiers,false)?'meta':ERRORCLASS;}
if((style==='variable'||style==='builtin')&&state.lastToken==='meta'){style='meta';}
if(current==='pass'||current==='return'){state.dedent+=1;}
if(current==='lambda')state.lambda=true;if((current===':'&&!state.lambda&&state.scopes[0].type=='py')||indentInfo==='indent'){indent(stream,state);}
var delimiter_index='[({'.indexOf(current);if(delimiter_index!==-1){indent(stream,state,'])}'.slice(delimiter_index,delimiter_index+1));}
if(indentInfo==='dedent'){if(dedent(stream,state)){return ERRORCLASS;}}
delimiter_index='])}'.indexOf(current);if(delimiter_index!==-1){if(dedent(stream,state,current)){return ERRORCLASS;}}
if(state.dedent>0&&stream.eol()&&state.scopes[0].type=='py'){if(state.scopes.length>1)state.scopes.shift();state.dedent-=1;}
return style;}
var external={startState:function(basecolumn){return{tokenize:tokenBase,scopes:[{offset:basecolumn||0,type:'py'}],lastToken:null,lambda:false,dedent:0};},token:function(stream,state){var style=tokenLexer(stream,state);state.lastToken=style;if(stream.eol()&&stream.lambda){state.lambda=false;}
return style;},indent:function(state,textAfter){if(state.tokenize!=tokenBase){return 0;}
return state.scopes[0].offset;}};return external;});CodeMirror.defineMIME("text/x-python","python");CodeMirror.defineMode("htmlmixed",function(config,parserConfig){var htmlMode=CodeMirror.getMode(config,{name:"xml",htmlMode:true});var jsMode=CodeMirror.getMode(config,"javascript");var cssMode=CodeMirror.getMode(config,"css");function html(stream,state){var style=htmlMode.token(stream,state.htmlState);if(style=="tag"&&stream.current()==">"&&state.htmlState.context){if(/^script$/i.test(state.htmlState.context.tagName)){state.token=javascript;state.localState=jsMode.startState(htmlMode.indent(state.htmlState,""));state.mode="javascript";}
else if(/^style$/i.test(state.htmlState.context.tagName)){state.token=css;state.localState=cssMode.startState(htmlMode.indent(state.htmlState,""));state.mode="css";}}
return style;}
function maybeBackup(stream,pat,style){var cur=stream.current();var close=cur.search(pat);if(close>-1)stream.backUp(cur.length-close);return style;}
function javascript(stream,state){if(stream.match(/^<\/\s*script\s*>/i,false)){state.token=html;state.localState=null;state.mode="html";return html(stream,state);}
return maybeBackup(stream,/<\/\s*script\s*>/,jsMode.token(stream,state.localState));}
function css(stream,state){if(stream.match(/^<\/\s*style\s*>/i,false)){state.token=html;state.localState=null;state.mode="html";return html(stream,state);}
return maybeBackup(stream,/<\/\s*style\s*>/,cssMode.token(stream,state.localState));}
return{startState:function(){var state=htmlMode.startState();return{token:html,localState:null,mode:"html",htmlState:state};},copyState:function(state){if(state.localState)
var local=CodeMirror.copyState(state.token==css?cssMode:jsMode,state.localState);return{token:state.token,localState:local,mode:state.mode,htmlState:CodeMirror.copyState(htmlMode,state.htmlState)};},token:function(stream,state){return state.token(stream,state);},indent:function(state,textAfter){if(state.token==html||/^\s*<\//.test(textAfter))
return htmlMode.indent(state.htmlState,textAfter);else if(state.token==javascript)
return jsMode.indent(state.localState,textAfter);else
return cssMode.indent(state.localState,textAfter);},compareStates:function(a,b){if(a.mode!=b.mode)return false;if(a.localState)return CodeMirror.Pass;return htmlMode.compareStates(a.htmlState,b.htmlState);},electricChars:"/{}:"}},"xml","javascript","css");CodeMirror.defineMIME("text/html","htmlmixed");CodeMirror.defineMode("xml",function(config,parserConfig){var indentUnit=config.indentUnit;var Kludges=parserConfig.htmlMode?{autoSelfClosers:{'area':true,'base':true,'br':true,'col':true,'command':true,'embed':true,'frame':true,'hr':true,'img':true,'input':true,'keygen':true,'link':true,'meta':true,'param':true,'source':true,'track':true,'wbr':true},implicitlyClosed:{'dd':true,'li':true,'optgroup':true,'option':true,'p':true,'rp':true,'rt':true,'tbody':true,'td':true,'tfoot':true,'th':true,'tr':true},contextGrabbers:{'dd':{'dd':true,'dt':true},'dt':{'dd':true,'dt':true},'li':{'li':true},'option':{'option':true,'optgroup':true},'optgroup':{'optgroup':true},'p':{'address':true,'article':true,'aside':true,'blockquote':true,'dir':true,'div':true,'dl':true,'fieldset':true,'footer':true,'form':true,'h1':true,'h2':true,'h3':true,'h4':true,'h5':true,'h6':true,'header':true,'hgroup':true,'hr':true,'menu':true,'nav':true,'ol':true,'p':true,'pre':true,'section':true,'table':true,'ul':true},'rp':{'rp':true,'rt':true},'rt':{'rp':true,'rt':true},'tbody':{'tbody':true,'tfoot':true},'td':{'td':true,'th':true},'tfoot':{'tbody':true},'th':{'td':true,'th':true},'thead':{'tbody':true,'tfoot':true},'tr':{'tr':true}},doNotIndent:{"pre":true},allowUnquoted:true,allowMissing:false}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:false,allowMissing:false};var alignCDATA=parserConfig.alignCDATA;var tagName,type;function inText(stream,state){function chain(parser){state.tokenize=parser;return parser(stream,state);}
var ch=stream.next();if(ch=="<"){if(stream.eat("!")){if(stream.eat("[")){if(stream.match("CDATA["))return chain(inBlock("atom","]]>"));else return null;}
else if(stream.match("--"))return chain(inBlock("comment","-->"));else if(stream.match("DOCTYPE",true,true)){stream.eatWhile(/[\w\._\-]/);return chain(doctype(1));}
else return null;}
else if(stream.eat("?")){stream.eatWhile(/[\w\._\-]/);state.tokenize=inBlock("meta","?>");return"meta";}
else{type=stream.eat("/")?"closeTag":"openTag";stream.eatSpace();tagName="";var c;while((c=stream.eat(/[^\s\u00a0=<>\"\'\/?]/)))tagName+=c;state.tokenize=inTag;return"tag";}}
else if(ch=="&"){var ok;if(stream.eat("#")){if(stream.eat("x")){ok=stream.eatWhile(/[a-fA-F\d]/)&&stream.eat(";");}else{ok=stream.eatWhile(/[\d]/)&&stream.eat(";");}}else{ok=stream.eatWhile(/[\w\.\-:]/)&&stream.eat(";");}
return ok?"atom":"error";}
else{stream.eatWhile(/[^&<]/);return null;}}
function inTag(stream,state){var ch=stream.next();if(ch==">"||(ch=="/"&&stream.eat(">"))){state.tokenize=inText;type=ch==">"?"endTag":"selfcloseTag";return"tag";}
else if(ch=="="){type="equals";return null;}
else if(/[\'\"]/.test(ch)){state.tokenize=inAttribute(ch);return state.tokenize(stream,state);}
else{stream.eatWhile(/[^\s\u00a0=<>\"\'\/?]/);return"word";}}
function inAttribute(quote){return function(stream,state){while(!stream.eol()){if(stream.next()==quote){state.tokenize=inTag;break;}}
return"string";};}
function inBlock(style,terminator){return function(stream,state){while(!stream.eol()){if(stream.match(terminator)){state.tokenize=inText;break;}
stream.next();}
return style;};}
function doctype(depth){return function(stream,state){var ch;while((ch=stream.next())!=null){if(ch=="<"){state.tokenize=doctype(depth+1);return state.tokenize(stream,state);}else if(ch==">"){if(depth==1){state.tokenize=inText;break;}else{state.tokenize=doctype(depth-1);return state.tokenize(stream,state);}}}
return"meta";};}
var curState,setStyle;function pass(){for(var i=arguments.length-1;i>=0;i--)curState.cc.push(arguments[i]);}
function cont(){pass.apply(null,arguments);return true;}
function pushContext(tagName,startOfLine){var noIndent=Kludges.doNotIndent.hasOwnProperty(tagName)||(curState.context&&curState.context.noIndent);curState.context={prev:curState.context,tagName:tagName,indent:curState.indented,startOfLine:startOfLine,noIndent:noIndent};}
function popContext(){if(curState.context)curState.context=curState.context.prev;}
function element(type){if(type=="openTag"){curState.tagName=tagName;return cont(attributes,endtag(curState.startOfLine));}else if(type=="closeTag"){var err=false;if(curState.context){if(curState.context.tagName!=tagName){if(Kludges.implicitlyClosed.hasOwnProperty(curState.context.tagName.toLowerCase())){popContext();}
err=!curState.context||curState.context.tagName!=tagName;}}else{err=true;}
if(err)setStyle="error";return cont(endclosetag(err));}
return cont();}
function endtag(startOfLine){return function(type){if(type=="selfcloseTag"||(type=="endTag"&&Kludges.autoSelfClosers.hasOwnProperty(curState.tagName.toLowerCase()))){maybePopContext(curState.tagName.toLowerCase());return cont();}
if(type=="endTag"){maybePopContext(curState.tagName.toLowerCase());pushContext(curState.tagName,startOfLine);return cont();}
return cont();};}
function endclosetag(err){return function(type){if(err)setStyle="error";if(type=="endTag"){popContext();return cont();}
setStyle="error";return cont(arguments.callee);}}
function maybePopContext(nextTagName){var parentTagName;while(true){if(!curState.context){return;}
parentTagName=curState.context.tagName.toLowerCase();if(!Kludges.contextGrabbers.hasOwnProperty(parentTagName)||!Kludges.contextGrabbers[parentTagName].hasOwnProperty(nextTagName)){return;}
popContext();}}
function attributes(type){if(type=="word"){setStyle="attribute";return cont(attribute,attributes);}
if(type=="endTag"||type=="selfcloseTag")return pass();setStyle="error";return cont(attributes);}
function attribute(type){if(type=="equals")return cont(attvalue,attributes);if(!Kludges.allowMissing)setStyle="error";return(type=="endTag"||type=="selfcloseTag")?pass():cont();}
function attvalue(type){if(type=="string")return cont(attvaluemaybe);if(type=="word"&&Kludges.allowUnquoted){setStyle="string";return cont();}
setStyle="error";return(type=="endTag"||type=="selfCloseTag")?pass():cont();}
function attvaluemaybe(type){if(type=="string")return cont(attvaluemaybe);else return pass();}
return{startState:function(){return{tokenize:inText,cc:[],indented:0,startOfLine:true,tagName:null,context:null};},token:function(stream,state){if(stream.sol()){state.startOfLine=true;state.indented=stream.indentation();}
if(stream.eatSpace())return null;setStyle=type=tagName=null;var style=state.tokenize(stream,state);state.type=type;if((style||type)&&style!="comment"){curState=state;while(true){var comb=state.cc.pop()||element;if(comb(type||style))break;}}
state.startOfLine=false;return setStyle||style;},indent:function(state,textAfter,fullLine){var context=state.context;if((state.tokenize!=inTag&&state.tokenize!=inText)||context&&context.noIndent)
return fullLine?fullLine.match(/^(\s*)/)[0].length:0;if(alignCDATA&&/<!\[CDATA\[/.test(textAfter))return 0;if(context&&/^<\//.test(textAfter))
context=context.prev;while(context&&!context.startOfLine)
context=context.prev;if(context)return context.indent+indentUnit;else return 0;},compareStates:function(a,b){if(a.indented!=b.indented||a.tokenize!=b.tokenize)return false;for(var ca=a.context,cb=b.context;;ca=ca.prev,cb=cb.prev){if(!ca||!cb)return ca==cb;if(ca.tagName!=cb.tagName||ca.indent!=cb.indent)return false;}},electricChars:"/"};});CodeMirror.defineMIME("text/xml","xml");CodeMirror.defineMIME("application/xml","xml");if(!CodeMirror.mimeModes.hasOwnProperty("text/html"))
CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:true});CodeMirror.defineMode("javascript",function(config,parserConfig){var indentUnit=config.indentUnit;var jsonMode=parserConfig.json;var keywords=function(){function kw(type){return{type:type,style:"keyword"};}
var A=kw("keyword a"),B=kw("keyword b"),C=kw("keyword c");var operator=kw("operator"),atom={type:"atom",style:"atom"};return{"if":A,"while":A,"with":A,"else":B,"do":B,"try":B,"finally":B,"return":C,"break":C,"continue":C,"new":C,"delete":C,"throw":C,"var":kw("var"),"const":kw("var"),"let":kw("var"),"function":kw("function"),"catch":kw("catch"),"for":kw("for"),"switch":kw("switch"),"case":kw("case"),"default":kw("default"),"in":operator,"typeof":operator,"instanceof":operator,"true":atom,"false":atom,"null":atom,"undefined":atom,"NaN":atom,"Infinity":atom};}();var isOperatorChar=/[+\-*&%=<>!?|]/;function chain(stream,state,f){state.tokenize=f;return f(stream,state);}
function nextUntilUnescaped(stream,end){var escaped=false,next;while((next=stream.next())!=null){if(next==end&&!escaped)
return false;escaped=!escaped&&next=="\\";}
return escaped;}
var type,content;function ret(tp,style,cont){type=tp;content=cont;return style;}
function jsTokenBase(stream,state){var ch=stream.next();if(ch=='"'||ch=="'")
return chain(stream,state,jsTokenString(ch));else if(/[\[\]{}\(\),;\:\.]/.test(ch))
return ret(ch);else if(ch=="0"&&stream.eat(/x/i)){stream.eatWhile(/[\da-f]/i);return ret("number","number");}
else if(/\d/.test(ch)||ch=="-"&&stream.eat(/\d/)){stream.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/);return ret("number","number");}
else if(ch=="/"){if(stream.eat("*")){return chain(stream,state,jsTokenComment);}
else if(stream.eat("/")){stream.skipToEnd();return ret("comment","comment");}
else if(state.reAllowed){nextUntilUnescaped(stream,"/");stream.eatWhile(/[gimy]/);return ret("regexp","string-2");}
else{stream.eatWhile(isOperatorChar);return ret("operator",null,stream.current());}}
else if(ch=="#"){stream.skipToEnd();return ret("error","error");}
else if(isOperatorChar.test(ch)){stream.eatWhile(isOperatorChar);return ret("operator",null,stream.current());}
else{stream.eatWhile(/[\w\$_]/);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return(known&&state.kwAllowed)?ret(known.type,known.style,word):ret("variable","variable",word);}}
function jsTokenString(quote){return function(stream,state){if(!nextUntilUnescaped(stream,quote))
state.tokenize=jsTokenBase;return ret("string","string");};}
function jsTokenComment(stream,state){var maybeEnd=false,ch;while(ch=stream.next()){if(ch=="/"&&maybeEnd){state.tokenize=jsTokenBase;break;}
maybeEnd=(ch=="*");}
return ret("comment","comment");}
var atomicTypes={"atom":true,"number":true,"variable":true,"string":true,"regexp":true};function JSLexical(indented,column,type,align,prev,info){this.indented=indented;this.column=column;this.type=type;this.prev=prev;this.info=info;if(align!=null)this.align=align;}
function inScope(state,varname){for(var v=state.localVars;v;v=v.next)
if(v.name==varname)return true;}
function parseJS(state,style,type,content,stream){var cc=state.cc;cx.state=state;cx.stream=stream;cx.marked=null,cx.cc=cc;if(!state.lexical.hasOwnProperty("align"))
state.lexical.align=true;while(true){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){while(cc.length&&cc[cc.length-1].lex)
cc.pop()();if(cx.marked)return cx.marked;if(type=="variable"&&inScope(state,content))return"variable-2";return style;}}}
var cx={state:null,column:null,marked:null,cc:null};function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i]);}
function cont(){pass.apply(null,arguments);return true;}
function register(varname){var state=cx.state;if(state.context){cx.marked="def";for(var v=state.localVars;v;v=v.next)
if(v.name==varname)return;state.localVars={name:varname,next:state.localVars};}}
var defaultVars={name:"this",next:{name:"arguments"}};function pushcontext(){if(!cx.state.context)cx.state.localVars=defaultVars;cx.state.context={prev:cx.state.context,vars:cx.state.localVars};}
function popcontext(){cx.state.localVars=cx.state.context.vars;cx.state.context=cx.state.context.prev;}
function pushlex(type,info){var result=function(){var state=cx.state;state.lexical=new JSLexical(state.indented,cx.stream.column(),type,null,state.lexical,info)};result.lex=true;return result;}
function poplex(){var state=cx.state;if(state.lexical.prev){if(state.lexical.type==")")
state.indented=state.lexical.indented;state.lexical=state.lexical.prev;}}
poplex.lex=true;function expect(wanted){return function expecting(type){if(type==wanted)return cont();else if(wanted==";")return pass();else return cont(arguments.callee);};}
function statement(type){if(type=="var")return cont(pushlex("vardef"),vardef1,expect(";"),poplex);if(type=="keyword a")return cont(pushlex("form"),expression,statement,poplex);if(type=="keyword b")return cont(pushlex("form"),statement,poplex);if(type=="{")return cont(pushlex("}"),block,poplex);if(type==";")return cont();if(type=="function")return cont(functiondef);if(type=="for")return cont(pushlex("form"),expect("("),pushlex(")"),forspec1,expect(")"),poplex,statement,poplex);if(type=="variable")return cont(pushlex("stat"),maybelabel);if(type=="switch")return cont(pushlex("form"),expression,pushlex("}","switch"),expect("{"),block,poplex,poplex);if(type=="case")return cont(expression,expect(":"));if(type=="default")return cont(expect(":"));if(type=="catch")return cont(pushlex("form"),pushcontext,expect("("),funarg,expect(")"),statement,poplex,popcontext);return pass(pushlex("stat"),expression,expect(";"),poplex);}
function expression(type){if(atomicTypes.hasOwnProperty(type))return cont(maybeoperator);if(type=="function")return cont(functiondef);if(type=="keyword c")return cont(maybeexpression);if(type=="(")return cont(pushlex(")"),maybeexpression,expect(")"),poplex,maybeoperator);if(type=="operator")return cont(expression);if(type=="[")return cont(pushlex("]"),commasep(expression,"]"),poplex,maybeoperator);if(type=="{")return cont(pushlex("}"),commasep(objprop,"}"),poplex,maybeoperator);return cont();}
function maybeexpression(type){if(type.match(/[;\}\)\],]/))return pass();return pass(expression);}
function maybeoperator(type,value){if(type=="operator"&&/\+\+|--/.test(value))return cont(maybeoperator);if(type=="operator"||type==":")return cont(expression);if(type==";")return;if(type=="(")return cont(pushlex(")"),commasep(expression,")"),poplex,maybeoperator);if(type==".")return cont(property,maybeoperator);if(type=="[")return cont(pushlex("]"),expression,expect("]"),poplex,maybeoperator);}
function maybelabel(type){if(type==":")return cont(poplex,statement);return pass(maybeoperator,expect(";"),poplex);}
function property(type){if(type=="variable"){cx.marked="property";return cont();}}
function objprop(type){if(type=="variable")cx.marked="property";if(atomicTypes.hasOwnProperty(type))return cont(expect(":"),expression);}
function commasep(what,end){function proceed(type){if(type==",")return cont(what,proceed);if(type==end)return cont();return cont(expect(end));}
return function commaSeparated(type){if(type==end)return cont();else return pass(what,proceed);};}
function block(type){if(type=="}")return cont();return pass(statement,block);}
function vardef1(type,value){if(type=="variable"){register(value);return cont(vardef2);}
return cont();}
function vardef2(type,value){if(value=="=")return cont(expression,vardef2);if(type==",")return cont(vardef1);}
function forspec1(type){if(type=="var")return cont(vardef1,forspec2);if(type==";")return pass(forspec2);if(type=="variable")return cont(formaybein);return pass(forspec2);}
function formaybein(type,value){if(value=="in")return cont(expression);return cont(maybeoperator,forspec2);}
function forspec2(type,value){if(type==";")return cont(forspec3);if(value=="in")return cont(expression);return cont(expression,expect(";"),forspec3);}
function forspec3(type){if(type!=")")cont(expression);}
function functiondef(type,value){if(type=="variable"){register(value);return cont(functiondef);}
if(type=="(")return cont(pushlex(")"),pushcontext,commasep(funarg,")"),poplex,statement,popcontext);}
function funarg(type,value){if(type=="variable"){register(value);return cont();}}
return{startState:function(basecolumn){return{tokenize:jsTokenBase,reAllowed:true,kwAllowed:true,cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,"block",false),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:0};},token:function(stream,state){if(stream.sol()){if(!state.lexical.hasOwnProperty("align"))
state.lexical.align=false;state.indented=stream.indentation();}
if(stream.eatSpace())return null;var style=state.tokenize(stream,state);if(type=="comment")return style;state.reAllowed=!!(type=="operator"||type=="keyword c"||type.match(/^[\[{}\(,;:]$/));state.kwAllowed=type!='.';return parseJS(state,style,type,content,stream);},indent:function(state,textAfter){if(state.tokenize!=jsTokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical;if(lexical.type=="stat"&&firstChar=="}")lexical=lexical.prev;var type=lexical.type,closing=firstChar==type;if(type=="vardef")return lexical.indented+4;else if(type=="form"&&firstChar=="{")return lexical.indented;else if(type=="stat"||type=="form")return lexical.indented+indentUnit;else if(lexical.info=="switch"&&!closing)
return lexical.indented+(/^(?:case|default)\b/.test(textAfter)?indentUnit:2*indentUnit);else if(lexical.align)return lexical.column+(closing?0:1);else return lexical.indented+(closing?0:indentUnit);},electricChars:":{}"};});CodeMirror.defineMIME("text/javascript","javascript");CodeMirror.defineMIME("application/json",{name:"javascript",json:true});CodeMirror.defineMode("css",function(config){var indentUnit=config.indentUnit,type;function ret(style,tp){type=tp;return style;}
function tokenBase(stream,state){var ch=stream.next();if(ch=="@"){stream.eatWhile(/[\w\\\-]/);return ret("meta",stream.current());}
else if(ch=="/"&&stream.eat("*")){state.tokenize=tokenCComment;return tokenCComment(stream,state);}
else if(ch=="<"&&stream.eat("!")){state.tokenize=tokenSGMLComment;return tokenSGMLComment(stream,state);}
else if(ch=="=")ret(null,"compare");else if((ch=="~"||ch=="|")&&stream.eat("="))return ret(null,"compare");else if(ch=="\""||ch=="'"){state.tokenize=tokenString(ch);return state.tokenize(stream,state);}
else if(ch=="#"){stream.eatWhile(/[\w\\\-]/);return ret("atom","hash");}
else if(ch=="!"){stream.match(/^\s*\w*/);return ret("keyword","important");}
else if(/\d/.test(ch)){stream.eatWhile(/[\w.%]/);return ret("number","unit");}
else if(/[,.+>*\/]/.test(ch)){return ret(null,"select-op");}
else if(/[;{}:\[\]]/.test(ch)){return ret(null,ch);}
else{stream.eatWhile(/[\w\\\-]/);return ret("variable","variable");}}
function tokenCComment(stream,state){var maybeEnd=false,ch;while((ch=stream.next())!=null){if(maybeEnd&&ch=="/"){state.tokenize=tokenBase;break;}
maybeEnd=(ch=="*");}
return ret("comment","comment");}
function tokenSGMLComment(stream,state){var dashes=0,ch;while((ch=stream.next())!=null){if(dashes>=2&&ch==">"){state.tokenize=tokenBase;break;}
dashes=(ch=="-")?dashes+1:0;}
return ret("comment","comment");}
function tokenString(quote){return function(stream,state){var escaped=false,ch;while((ch=stream.next())!=null){if(ch==quote&&!escaped)
break;escaped=!escaped&&ch=="\\";}
if(!escaped)state.tokenize=tokenBase;return ret("string","string");};}
return{startState:function(base){return{tokenize:tokenBase,baseIndent:base||0,stack:[]};},token:function(stream,state){if(stream.eatSpace())return null;var style=state.tokenize(stream,state);var context=state.stack[state.stack.length-1];if(type=="hash"&&context!="rule")style="string-2";else if(style=="variable"){if(context=="rule")style="number";else if(!context||context=="@media{")style="tag";}
if(context=="rule"&&/^[\{\};]$/.test(type))
state.stack.pop();if(type=="{"){if(context=="@media")state.stack[state.stack.length-1]="@media{";else state.stack.push("{");}
else if(type=="}")state.stack.pop();else if(type=="@media")state.stack.push("@media");else if(context=="{"&&type!="comment")state.stack.push("rule");return style;},indent:function(state,textAfter){var n=state.stack.length;if(/^\}/.test(textAfter))
n-=state.stack[state.stack.length-1]=="rule"?2:1;return state.baseIndent+n*indentUnit;},electricChars:"}"};});CodeMirror.defineMIME("text/css","css");CodeMirror.defineMode('rst',function(config,options){function setState(state,fn,ctx){state.fn=fn;setCtx(state,ctx);}
function setCtx(state,ctx){state.ctx=ctx||{};}
function setNormal(state,ch){if(ch&&(typeof ch!=='string')){var str=ch.current();ch=str[str.length-1];}
setState(state,normal,{back:ch});}
function hasMode(mode){if(mode){var modes=CodeMirror.listModes();for(var i in modes){if(modes[i]==mode){return true;}}}
return false;}
function getMode(mode){if(hasMode(mode)){return CodeMirror.getMode(config,mode);}else{return null;}}
var verbatimMode=getMode(options.verbatim);var pythonMode=getMode('python');var reSection=/^[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/;var reDirective=/^\s*\w([-:.\w]*\w)?::(\s|$)/;var reHyperlink=/^\s*_[\w-]+:(\s|$)/;var reFootnote=/^\s*\[(\d+|#)\](\s|$)/;var reCitation=/^\s*\[[A-Za-z][\w-]*\](\s|$)/;var reFootnoteRef=/^\[(\d+|#)\]_/;var reCitationRef=/^\[[A-Za-z][\w-]*\]_/;var reDirectiveMarker=/^\.\.(\s|$)/;var reVerbatimMarker=/^::\s*$/;var rePreInline=/^[-\s"([{</:]/;var rePostInline=/^[-\s`'")\]}>/:.,;!?\\_]/;var reEnumeratedList=/^\s*((\d+|[A-Za-z#])[.)]|\((\d+|[A-Z-a-z#])\))\s/;var reBulletedList=/^\s*[-\+\*]\s/;var reExamples=/^\s+(>>>|In \[\d+\]:)\s/;function normal(stream,state){var ch,sol,i;if(stream.eat(/\\/)){ch=stream.next();setNormal(state,ch);return null;}
sol=stream.sol();if(sol&&(ch=stream.eat(reSection))){for(i=0;stream.eat(ch);i++);if(i>=3&&stream.match(/^\s*$/)){setNormal(state,null);return'header';}else{stream.backUp(i+1);}}
if(sol&&stream.match(reDirectiveMarker)){if(!stream.eol()){setState(state,directive);}
return'meta';}
if(stream.match(reVerbatimMarker)){if(!verbatimMode){setState(state,verbatim);}else{var mode=verbatimMode;setState(state,verbatim,{mode:mode,local:mode.startState()});}
return'meta';}
if(sol&&stream.match(reExamples,false)){if(!pythonMode){setState(state,verbatim);return'meta';}else{var mode=pythonMode;setState(state,verbatim,{mode:mode,local:mode.startState()});return null;}}
function testBackward(re){return sol||!state.ctx.back||re.test(state.ctx.back);}
function testForward(re){return stream.eol()||stream.match(re,false);}
function testInline(re){return stream.match(re)&&testBackward(/\W/)&&testForward(/\W/);}
if(testInline(reFootnoteRef)){setNormal(state,stream);return'footnote';}
if(testInline(reCitationRef)){setNormal(state,stream);return'citation';}
ch=stream.next();if(testBackward(rePreInline)){if((ch===':'||ch==='|')&&stream.eat(/\S/)){var token;if(ch===':'){token='builtin';}else{token='atom';}
setState(state,inline,{ch:ch,wide:false,prev:null,token:token});return token;}
if(ch==='*'||ch==='`'){var orig=ch,wide=false;ch=stream.next();if(ch==orig){wide=true;ch=stream.next();}
if(ch&&!/\s/.test(ch)){var token;if(orig==='*'){token=wide?'strong':'em';}else{token=wide?'string':'string-2';}
setState(state,inline,{ch:orig,wide:wide,prev:null,token:token});return token;}}}
setNormal(state,ch);return null;}
function inline(stream,state){var ch=stream.next(),token=state.ctx.token;function finish(ch){state.ctx.prev=ch;return token;}
if(ch!=state.ctx.ch){return finish(ch);}
if(/\s/.test(state.ctx.prev)){return finish(ch);}
if(state.ctx.wide){ch=stream.next();if(ch!=state.ctx.ch){return finish(ch);}}
if(!stream.eol()&&!rePostInline.test(stream.peek())){if(state.ctx.wide){stream.backUp(1);}
return finish(ch);}
setState(state,normal);setNormal(state,ch);return token;}
function directive(stream,state){var token=null;if(stream.match(reDirective)){token='attribute';}else if(stream.match(reHyperlink)){token='link';}else if(stream.match(reFootnote)){token='quote';}else if(stream.match(reCitation)){token='quote';}else{stream.eatSpace();if(stream.eol()){setNormal(state,stream);return null;}else{stream.skipToEnd();setState(state,comment);return'comment';}}
setState(state,body,{start:true});return token;}
function body(stream,state){var token='body';if(!state.ctx.start||stream.sol()){return block(stream,state,token);}
stream.skipToEnd();setCtx(state);return token;}
function comment(stream,state){return block(stream,state,'comment');}
function verbatim(stream,state){if(!verbatimMode){return block(stream,state,'meta');}else{if(stream.sol()){if(!stream.eatSpace()){setNormal(state,stream);}
return null;}
return verbatimMode.token(stream,state.ctx.local);}}
function block(stream,state,token){if(stream.eol()||stream.eatSpace()){stream.skipToEnd();return token;}else{setNormal(state,stream);return null;}}
return{startState:function(){return{fn:normal,ctx:{}};},copyState:function(state){return{fn:state.fn,ctx:state.ctx};},token:function(stream,state){var token=state.fn(stream,state);return token;}};},"python");CodeMirror.defineMIME("text/x-rst","rst");CodeMirror.defineMode("markdown",function(cmCfg,modeCfg){var htmlFound=CodeMirror.mimeModes.hasOwnProperty("text/html");var htmlMode=CodeMirror.getMode(cmCfg,htmlFound?"text/html":"text/plain");var header='header',code='comment',quote='quote',list='string',hr='hr',linktext='link',linkhref='string',em='em',strong='strong',emstrong='emstrong';var hrRE=/^([*\-=_])(?:\s*\1){2,}\s*$/,ulRE=/^[*\-+]\s+/,olRE=/^[0-9]+\.\s+/,headerRE=/^(?:\={3,}|-{3,})$/,textRE=/^[^\[*_\\<>`]+/;function switchInline(stream,state,f){state.f=state.inline=f;return f(stream,state);}
function switchBlock(stream,state,f){state.f=state.block=f;return f(stream,state);}
function blankLine(state){state.em=false;state.strong=false;if(!htmlFound&&state.f==htmlBlock){state.f=inlineNormal;state.block=blockNormal;}
return null;}
function blockNormal(stream,state){var match;if(state.indentationDiff>=4){state.indentation-=state.indentationDiff;stream.skipToEnd();return code;}else if(stream.eatSpace()){return null;}else if(stream.peek()==='#'||stream.match(headerRE)){state.header=true;}else if(stream.eat('>')){state.indentation++;state.quote=true;}else if(stream.peek()==='['){return switchInline(stream,state,footnoteLink);}else if(stream.match(hrRE,true)){return hr;}else if(match=stream.match(ulRE,true)||stream.match(olRE,true)){state.indentation+=match[0].length;return list;}
return switchInline(stream,state,state.inline);}
function htmlBlock(stream,state){var style=htmlMode.token(stream,state.htmlState);if(htmlFound&&style==='tag'&&state.htmlState.type!=='openTag'&&!state.htmlState.context){state.f=inlineNormal;state.block=blockNormal;}
if(state.md_inside&&stream.current().indexOf(">")!=-1){state.f=inlineNormal;state.block=blockNormal;state.htmlState.context=undefined;}
return style;}
function getType(state){var styles=[];if(state.strong){styles.push(state.em?emstrong:strong);}
else if(state.em){styles.push(em);}
if(state.header){styles.push(header);}
if(state.quote){styles.push(quote);}
return styles.length?styles.join(' '):null;}
function handleText(stream,state){if(stream.match(textRE,true)){return getType(state);}
return undefined;}
function inlineNormal(stream,state){var style=state.text(stream,state)
if(typeof style!=='undefined')
return style;var ch=stream.next();if(ch==='\\'){stream.next();return getType(state);}
if(ch==='`'){return switchInline(stream,state,inlineElement(code,'`'));}
if(ch==='['){return switchInline(stream,state,linkText);}
if(ch==='<'&&stream.match(/^\w/,false)){var md_inside=false;if(stream.string.indexOf(">")!=-1){var atts=stream.string.substring(1,stream.string.indexOf(">"));if(/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(atts)){state.md_inside=true;}}
stream.backUp(1);return switchBlock(stream,state,htmlBlock);}
if(ch==='<'&&stream.match(/^\/\w*?>/)){state.md_inside=false;return"tag";}
var t=getType(state);if(ch==='*'||ch==='_'){if(stream.eat(ch)){return(state.strong=!state.strong)?getType(state):t;}
return(state.em=!state.em)?getType(state):t;}
return getType(state);}
function linkText(stream,state){while(!stream.eol()){var ch=stream.next();if(ch==='\\')stream.next();if(ch===']'){state.inline=state.f=linkHref;return linktext;}}
return linktext;}
function linkHref(stream,state){stream.eatSpace();var ch=stream.next();if(ch==='('||ch==='['){return switchInline(stream,state,inlineElement(linkhref,ch==='('?')':']'));}
return'error';}
function footnoteLink(stream,state){if(stream.match(/^[^\]]*\]:/,true)){state.f=footnoteUrl;return linktext;}
return switchInline(stream,state,inlineNormal);}
function footnoteUrl(stream,state){stream.eatSpace();stream.match(/^[^\s]+/,true);state.f=state.inline=inlineNormal;return linkhref;}
function inlineRE(endChar){if(!inlineRE[endChar]){inlineRE[endChar]=new RegExp('^(?:[^\\\\\\'+endChar+']|\\\\.)*(?:\\'+endChar+'|$)');}
return inlineRE[endChar];}
function inlineElement(type,endChar,next){next=next||inlineNormal;return function(stream,state){stream.match(inlineRE(endChar));state.inline=state.f=next;return type;};}
return{startState:function(){return{f:blockNormal,block:blockNormal,htmlState:CodeMirror.startState(htmlMode),indentation:0,inline:inlineNormal,text:handleText,em:false,strong:false,header:false,quote:false};},copyState:function(s){return{f:s.f,block:s.block,htmlState:CodeMirror.copyState(htmlMode,s.htmlState),indentation:s.indentation,inline:s.inline,text:s.text,em:s.em,strong:s.strong,header:s.header,quote:s.quote,md_inside:s.md_inside};},token:function(stream,state){if(stream.sol()){if(stream.match(/^\s*$/,true)){return blankLine(state);}
state.header=false;state.quote=false;state.f=state.block;var indentation=stream.match(/^\s*/,true)[0].replace(/\t/g,'    ').length;state.indentationDiff=indentation-state.indentation;state.indentation=indentation;if(indentation>0){return null;}}
return state.f(stream,state);},blankLine:blankLine,getType:getType};},"xml");CodeMirror.defineMIME("text/x-markdown","markdown");var Markdown;if(typeof exports==="object"&&typeof require==="function")
Markdown=exports;else
Markdown={};(function(){function identity(x){return x;}
function returnFalse(x){return false;}
function HookCollection(){}
HookCollection.prototype={chain:function(hookname,func){var original=this[hookname];if(!original)
throw new Error("unknown hook "+hookname);if(original===identity)
this[hookname]=func;else
this[hookname]=function(x){return func(original(x));}},set:function(hookname,func){if(!this[hookname])
throw new Error("unknown hook "+hookname);this[hookname]=func;},addNoop:function(hookname){this[hookname]=identity;},addFalse:function(hookname){this[hookname]=returnFalse;}};Markdown.HookCollection=HookCollection;function SaveHash(){}
SaveHash.prototype={set:function(key,value){this["s_"+key]=value;},get:function(key){return this["s_"+key];}};Markdown.Converter=function(){var pluginHooks=this.hooks=new HookCollection();pluginHooks.addNoop("plainLinkText");pluginHooks.addNoop("preConversion");pluginHooks.addNoop("postConversion");var g_urls;var g_titles;var g_html_blocks;var g_list_level;this.makeHtml=function(text){if(g_urls)
throw new Error("Recursive call to converter.makeHtml");g_urls=new SaveHash();g_titles=new SaveHash();g_html_blocks=[];g_list_level=0;text=pluginHooks.preConversion(text);text=text.replace(/~/g,"~T");text=text.replace(/\$/g,"~D");text=text.replace(/\r\n/g,"\n");text=text.replace(/\r/g,"\n");text="\n\n"+text+"\n\n";text=_Detab(text);text=text.replace(/^[ \t]+$/mg,"");text=_HashHTMLBlocks(text);text=_StripLinkDefinitions(text);text=_RunBlockGamut(text);text=_UnescapeSpecialChars(text);text=text.replace(/~D/g,"$$");text=text.replace(/~T/g,"~");text=pluginHooks.postConversion(text);g_html_blocks=g_titles=g_urls=null;return text;};function _StripLinkDefinitions(text){text=text.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(wholeMatch,m1,m2,m3,m4,m5){m1=m1.toLowerCase();g_urls.set(m1,_EncodeAmpsAndAngles(m2));if(m4){return m3;}else if(m5){g_titles.set(m1,m5.replace(/"/g,"&quot;"));}
return"";});return text;}
function _HashHTMLBlocks(text){var block_tags_a="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del"
var block_tags_b="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math"
text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,hashElement);text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,hashElement);text=text.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,hashElement);return text;}
function hashElement(wholeMatch,m1){var blockText=m1;blockText=blockText.replace(/^\n+/,"");blockText=blockText.replace(/\n+$/g,"");blockText="\n\n~K"+(g_html_blocks.push(blockText)-1)+"K\n\n";return blockText;}
function _RunBlockGamut(text,doNotUnhash){text=_DoHeaders(text);var replacement="<hr />\n";text=text.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,replacement);text=text.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,replacement);text=text.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,replacement);text=_DoLists(text);text=_DoCodeBlocks(text);text=_DoBlockQuotes(text);text=_HashHTMLBlocks(text);text=_FormParagraphs(text,doNotUnhash);return text;}
function _RunSpanGamut(text){text=_DoCodeSpans(text);text=_EscapeSpecialCharsWithinTagAttributes(text);text=_EncodeBackslashEscapes(text);text=_DoImages(text);text=_DoAnchors(text);text=_DoAutoLinks(text);text=_EncodeAmpsAndAngles(text);text=_DoItalicsAndBold(text);text=text.replace(/  +\n/g," <br>\n");return text;}
function _EscapeSpecialCharsWithinTagAttributes(text){var regex=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\/?code>(?=.)/g,"$1`");tag=escapeCharacters(tag,wholeMatch.charAt(1)=="!"?"\\`*_/":"\\`*_");return tag;});return text;}
function _DoAnchors(text){text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeAnchorTag);text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeAnchorTag);text=text.replace(/(\[([^\[\]]+)\])()()()()()/g,writeAnchorTag);return text;}
function writeAnchorTag(wholeMatch,m1,m2,m3,m4,m5,m6,m7){if(m7==undefined)m7="";var whole_match=m1;var link_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(url==""){if(link_id==""){link_id=link_text.toLowerCase().replace(/ ?\n/g," ");}
url="#"+link_id;if(g_urls.get(link_id)!=undefined){url=g_urls.get(link_id);if(g_titles.get(link_id)!=undefined){title=g_titles.get(link_id);}}
else{if(whole_match.search(/\(\s*\)$/m)>-1){url="";}else{return whole_match;}}}
url=encodeProblemUrlChars(url);url=escapeCharacters(url,"*_");var result="<a href=\""+url+"\"";if(title!=""){title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=" title=\""+title+"\"";}
result+=" target=\"_blank\">"+link_text+"</a>";return result;}
function _DoImages(text){text=text.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeImageTag);text=text.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeImageTag);return text;}
function writeImageTag(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1;var alt_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(!title)title="";if(url==""){if(link_id==""){link_id=alt_text.toLowerCase().replace(/ ?\n/g," ");}
url="#"+link_id;if(g_urls.get(link_id)!=undefined){url=g_urls.get(link_id);if(g_titles.get(link_id)!=undefined){title=g_titles.get(link_id);}}
else{return whole_match;}}
alt_text=alt_text.replace(/"/g,"&quot;");url=escapeCharacters(url,"*_");var result="<img src=\""+url+"\" alt=\""+alt_text+"\"";title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=" title=\""+title+"\"";result+=" />";return result;}
function _DoHeaders(text){text=text.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(wholeMatch,m1){return"<h1>"+_RunSpanGamut(m1)+"</h1>\n\n";});text=text.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(matchFound,m1){return"<h2>"+_RunSpanGamut(m1)+"</h2>\n\n";});text=text.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return"<h"+h_level+">"+_RunSpanGamut(m2)+"</h"+h_level+">\n\n";});return text;}
function _DoLists(text){text+="~0";var whole_list=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;if(g_list_level){text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1;var list_type=(m2.search(/[*+-]/g)>-1)?"ul":"ol";var result=_ProcessListItems(list,list_type);result=result.replace(/\s+$/,"");result="<"+list_type+">"+result+"</"+list_type+">\n";return result;});}else{whole_list=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1;var list=m2;var list_type=(m3.search(/[*+-]/g)>-1)?"ul":"ol";var result=_ProcessListItems(list,list_type);result=runup+"<"+list_type+">\n"+result+"</"+list_type+">\n";return result;});}
text=text.replace(/~0/,"");return text;}
var _listItemMarkers={ol:"\\d+[.]",ul:"[*+-]"};function _ProcessListItems(list_str,list_type){g_list_level++;list_str=list_str.replace(/\n{2,}$/,"\n");list_str+="~0";var marker=_listItemMarkers[list_type];var re=new RegExp("(^[ \\t]*)("+marker+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+marker+")[ \\t]+))","gm");var last_item_had_a_double_newline=false;list_str=list_str.replace(re,function(wholeMatch,m1,m2,m3){var item=m3;var leading_space=m1;var ends_with_double_newline=/\n\n$/.test(item);var contains_double_newline=ends_with_double_newline||item.search(/\n{2,}/)>-1;if(contains_double_newline||last_item_had_a_double_newline){item=_RunBlockGamut(_Outdent(item),true);}
else{item=_DoLists(_Outdent(item));item=item.replace(/\n$/,"");item=_RunSpanGamut(item);}
last_item_had_a_double_newline=ends_with_double_newline;return"<li>"+item+"</li>\n";});list_str=list_str.replace(/~0/g,"");g_list_level--;return list_str;}
function _DoCodeBlocks(text){text+="~0";text=text.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1;var nextChar=m2;codeblock=_EncodeCode(_Outdent(codeblock));codeblock=_Detab(codeblock);codeblock=codeblock.replace(/^\n+/g,"");codeblock=codeblock.replace(/\n+$/g,"");codeblock="<pre><code>"+codeblock+"\n</code></pre>";return"\n\n"+codeblock+"\n\n"+nextChar;});text=text.replace(/~0/,"");return text;}
function hashBlock(text){text=text.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(g_html_blocks.push(text)-1)+"K\n\n";}
function _DoCodeSpans(text){text=text.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(wholeMatch,m1,m2,m3,m4){var c=m3;c=c.replace(/^([ \t]*)/g,"");c=c.replace(/[ \t]*$/g,"");c=_EncodeCode(c);return m1+"<code>"+c+"</code>";});return text;}
function _EncodeCode(text){text=text.replace(/&/g,"&amp;");text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");text=escapeCharacters(text,"\*_{}[]\\",false);return text;}
function _DoItalicsAndBold(text){text=text.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4");text=text.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4");return text;}
function _DoBlockQuotes(text){text=text.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(wholeMatch,m1){var bq=m1;bq=bq.replace(/^[ \t]*>[ \t]?/gm,"~0");bq=bq.replace(/~0/g,"");bq=bq.replace(/^[ \t]+$/gm,"");bq=_RunBlockGamut(bq);bq=bq.replace(/(^|\n)/g,"$1  ");bq=bq.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(wholeMatch,m1){var pre=m1;pre=pre.replace(/^  /mg,"~0");pre=pre.replace(/~0/g,"");return pre;});return hashBlock("<blockquote>\n"+bq+"\n</blockquote>");});return text;}
function _FormParagraphs(text,doNotUnhash){text=text.replace(/^\n+/g,"");text=text.replace(/\n+$/g,"");var grafs=text.split(/\n{2,}/g);var grafsOut=[];var end=grafs.length;for(var i=0;i<end;i++){var str=grafs[i];if(str.search(/~K(\d+)K/g)>=0){grafsOut.push(str);}
else if(str.search(/\S/)>=0){str=_RunSpanGamut(str);str=str.replace(/^([ \t]*)/g,"<p>");str+="</p>"
grafsOut.push(str);}}
if(!doNotUnhash){end=grafsOut.length;for(var i=0;i<end;i++){while(grafsOut[i].search(/~K(\d+)K/)>=0){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\$/g,"$$$$");grafsOut[i]=grafsOut[i].replace(/~K\d+K/,blockText);}}}
return grafsOut.join("\n\n");}
function _EncodeAmpsAndAngles(text){text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");text=text.replace(/<(?![a-z\/?\$!])/gi,"&lt;");return text;}
function _EncodeBackslashEscapes(text){text=text.replace(/\\(\\)/g,escapeCharacters_callback);text=text.replace(/\\([`*_{}\[\]()>#+-.!])/g,escapeCharacters_callback);return text;}
function _DoAutoLinks(text){text=text.replace(/(^|\s)(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\]])($|\W)/gi,"$1<$2$3>$4");var replacer=function(wholematch,m1){return"<a href=\""+m1+"\" target=\"_blank\">"+pluginHooks.plainLinkText(m1)+"</a>";}
text=text.replace(/<((https?|ftp):[^'">\s]+)>/gi,replacer);return text;}
function _UnescapeSpecialChars(text){text=text.replace(/~E(\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace);});return text;}
function _Outdent(text){text=text.replace(/^(\t|[ ]{1,4})/gm,"~0");text=text.replace(/~0/g,"")
return text;}
function _Detab(text){if(!/\t/.test(text))
return text;var spaces=["    ","   ","  "," "],skew=0,v;return text.replace(/[\n\t]/g,function(match,offset){if(match==="\n"){skew=offset+1;return match;}
v=(offset-skew)%4;skew=offset+1;return spaces[v];});}
var _problemUrlChars=/(?:["'*()[\]:]|~D)/g;function encodeProblemUrlChars(url){if(!url)
return"";var len=url.length;return url.replace(_problemUrlChars,function(match,offset){if(match=="~D")
return"%24";if(match==":"){if(offset==len-1||/[0-9\/]/.test(url.charAt(offset+1)))
return":"}
return"%"+match.charCodeAt(0).toString(16);});}
function escapeCharacters(text,charsToEscape,afterBackslash){var regexString="(["+charsToEscape.replace(/([\[\]\\])/g,"\\$1")+"])";if(afterBackslash){regexString="\\\\"+regexString;}
var regex=new RegExp(regexString,"g");text=text.replace(regex,escapeCharacters_callback);return text;}
function escapeCharacters_callback(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return"~E"+charCodeToEscape+"E";}};})();var q=null;window.PR_SHOULD_USE_CONTINUATION=!0;(function(){function L(a){function m(a){var f=a.charCodeAt(0);if(f!==92)return f;var b=a.charAt(1);return(f=r[b])?f:"0"<=b&&b<="7"?parseInt(a.substring(1),8):b==="u"||b==="x"?parseInt(a.substring(2),16):a.charCodeAt(1)}function e(a){if(a<32)return(a<16?"\\x0":"\\x")+a.toString(16);a=String.fromCharCode(a);if(a==="\\"||a==="-"||a==="["||a==="]")a="\\"+a;return a}function h(a){for(var f=a.substring(1,a.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g),a=[],b=[],o=f[0]==="^",c=o?1:0,i=f.length;c<i;++c){var j=f[c];if(/\\[bdsw]/i.test(j))a.push(j);else{var j=m(j),d;c+2<i&&"-"===f[c+1]?(d=m(f[c+2]),c+=2):d=j;b.push([j,d]);d<65||j>122||(d<65||j>90||b.push([Math.max(65,j)|32,Math.min(d,90)|32]),d<97||j>122||b.push([Math.max(97,j)&-33,Math.min(d,122)&-33]))}}b.sort(function(a,f){return a[0]-f[0]||f[1]-a[1]});f=[];j=[NaN,NaN];for(c=0;c<b.length;++c)i=b[c],i[0]<=j[1]+1?j[1]=Math.max(j[1],i[1]):f.push(j=i);b=["["];o&&b.push("^");b.push.apply(b,a);for(c=0;c<f.length;++c)i=f[c],b.push(e(i[0])),i[1]>i[0]&&(i[1]+1>i[0]&&b.push("-"),b.push(e(i[1])));b.push("]");return b.join("")}function y(a){for(var f=a.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),b=f.length,d=[],c=0,i=0;c<b;++c){var j=f[c];j==="("?++i:"\\"===j.charAt(0)&&(j=+j.substring(1))&&j<=i&&(d[j]=-1)}for(c=1;c<d.length;++c)-1===d[c]&&(d[c]=++t);for(i=c=0;c<b;++c)j=f[c],j==="("?(++i,d[i]===void 0&&(f[c]="(?:")):"\\"===j.charAt(0)&&(j=+j.substring(1))&&j<=i&&(f[c]="\\"+d[i]);for(i=c=0;c<b;++c)"^"===f[c]&&"^"!==f[c+1]&&(f[c]="");if(a.ignoreCase&&s)for(c=0;c<b;++c)j=f[c],a=j.charAt(0),j.length>=2&&a==="["?f[c]=h(j):a!=="\\"&&(f[c]=j.replace(/[A-Za-z]/g,function(a){a=a.charCodeAt(0);return"["+String.fromCharCode(a&-33,a|32)+"]"}));return f.join("")}for(var t=0,s=!1,l=!1,p=0,d=a.length;p<d;++p){var g=a[p];if(g.ignoreCase)l=!0;else if(/[a-z]/i.test(g.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){s=!0;l=!1;break}}for(var r={b:8,t:9,n:10,v:11,f:12,r:13},n=[],p=0,d=a.length;p<d;++p){g=a[p];if(g.global||g.multiline)throw Error(""+g);n.push("(?:"+y(g)+")")}return RegExp(n.join("|"),l?"gi":"g")}function M(a){function m(a){switch(a.nodeType){case 1:if(e.test(a.className))break;for(var g=a.firstChild;g;g=g.nextSibling)m(g);g=a.nodeName;if("BR"===g||"LI"===g)h[s]="\n",t[s<<1]=y++,t[s++<<1|1]=a;break;case 3:case 4:g=a.nodeValue,g.length&&(g=p?g.replace(/\r\n?/g,"\n"):g.replace(/[\t\n\r ]+/g," "),h[s]=g,t[s<<1]=y,y+=g.length,t[s++<<1|1]=a)}}var e=/(?:^|\s)nocode(?:\s|$)/,h=[],y=0,t=[],s=0,l;a.currentStyle?l=a.currentStyle.whiteSpace:window.getComputedStyle&&(l=document.defaultView.getComputedStyle(a,q).getPropertyValue("white-space"));var p=l&&"pre"===l.substring(0,3);m(a);return{a:h.join("").replace(/\n$/,""),c:t}}function B(a,m,e,h){m&&(a={a:m,d:a},e(a),h.push.apply(h,a.e))}function x(a,m){function e(a){for(var l=a.d,p=[l,"pln"],d=0,g=a.a.match(y)||[],r={},n=0,z=g.length;n<z;++n){var f=g[n],b=r[f],o=void 0,c;if(typeof b==="string")c=!1;else{var i=h[f.charAt(0)];if(i)o=f.match(i[1]),b=i[0];else{for(c=0;c<t;++c)if(i=m[c],o=f.match(i[1])){b=i[0];break}o||(b="pln")}if((c=b.length>=5&&"lang-"===b.substring(0,5))&&!(o&&typeof o[1]==="string"))c=!1,b="src";c||(r[f]=b)}i=d;d+=f.length;if(c){c=o[1];var j=f.indexOf(c),k=j+c.length;o[2]&&(k=f.length-o[2].length,j=k-c.length);b=b.substring(5);B(l+i,f.substring(0,j),e,p);B(l+i+j,c,C(b,c),p);B(l+i+k,f.substring(k),e,p)}else p.push(l+i,b)}a.e=p}var h={},y;(function(){for(var e=a.concat(m),l=[],p={},d=0,g=e.length;d<g;++d){var r=e[d],n=r[3];if(n)for(var k=n.length;--k>=0;)h[n.charAt(k)]=r;r=r[1];n=""+r;p.hasOwnProperty(n)||(l.push(r),p[n]=q)}l.push(/[\S\s]/);y=L(l)})();var t=m.length;return e}function u(a){var m=[],e=[];a.tripleQuotedStrings?m.push(["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,q,"'\""]):a.multiLineStrings?m.push(["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,q,"'\"`"]):m.push(["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,q,"\"'"]);a.verbatimStrings&&e.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,q]);var h=a.hashComments;h&&(a.cStyleComments?(h>1?m.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,q,"#"]):m.push(["com",/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\n\r]*)/,q,"#"]),e.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,q])):m.push(["com",/^#[^\n\r]*/,q,"#"]));a.cStyleComments&&(e.push(["com",/^\/\/[^\n\r]*/,q]),e.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,q]));a.regexLiterals&&e.push(["lang-regex",/^(?:^^\.?|[!+-]|!=|!==|#|%|%=|&|&&|&&=|&=|\(|\*|\*=|\+=|,|-=|->|\/|\/=|:|::|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|[?@[^]|\^=|\^\^|\^\^=|{|\||\|=|\|\||\|\|=|~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\s*(\/(?=[^*/])(?:[^/[\\]|\\[\S\s]|\[(?:[^\\\]]|\\[\S\s])*(?:]|$))+\/)/]);(h=a.types)&&e.push(["typ",h]);a=(""+a.keywords).replace(/^ | $/g,"");a.length&&e.push(["kwd",RegExp("^(?:"+a.replace(/[\s,]+/g,"|")+")\\b"),q]);m.push(["pln",/^\s+/,q," \r\n\t\xa0"]);e.push(["lit",/^@[$_a-z][\w$@]*/i,q],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,q],["pln",/^[$_a-z][\w$@]*/i,q],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,q,"0123456789"],["pln",/^\\[\S\s]?/,q],["pun",/^.[^\s\w"-$'./@\\`]*/,q]);return x(m,e)}function D(a,m){function e(a){switch(a.nodeType){case 1:if(k.test(a.className))break;if("BR"===a.nodeName)h(a),a.parentNode&&a.parentNode.removeChild(a);else for(a=a.firstChild;a;a=a.nextSibling)e(a);break;case 3:case 4:if(p){var b=a.nodeValue,d=b.match(t);if(d){var c=b.substring(0,d.index);a.nodeValue=c;(b=b.substring(d.index+d[0].length))&&a.parentNode.insertBefore(s.createTextNode(b),a.nextSibling);h(a);c||a.parentNode.removeChild(a)}}}}function h(a){function b(a,d){var e=d?a.cloneNode(!1):a,f=a.parentNode;if(f){var f=b(f,1),g=a.nextSibling;f.appendChild(e);for(var h=g;h;h=g)g=h.nextSibling,f.appendChild(h)}return e}
for(;!a.nextSibling;)if(a=a.parentNode,!a)return;for(var a=b(a.nextSibling,0),e;(e=a.parentNode)&&e.nodeType===1;)a=e;d.push(a)}var k=/(?:^|\s)nocode(?:\s|$)/,t=/\r\n?|\n/,s=a.ownerDocument,l;a.currentStyle?l=a.currentStyle.whiteSpace:window.getComputedStyle&&(l=s.defaultView.getComputedStyle(a,q).getPropertyValue("white-space"));var p=l&&"pre"===l.substring(0,3);for(l=s.createElement("LI");a.firstChild;)l.appendChild(a.firstChild);for(var d=[l],g=0;g<d.length;++g)e(d[g]);m===(m|0)&&d[0].setAttribute("value",m);var r=s.createElement("OL");r.className="linenums";for(var n=Math.max(0,m-1|0)||0,g=0,z=d.length;g<z;++g)l=d[g],l.className="L"+(g+n)%10,l.firstChild||l.appendChild(s.createTextNode("\xa0")),r.appendChild(l);a.appendChild(r)}function k(a,m){for(var e=m.length;--e>=0;){var h=m[e];A.hasOwnProperty(h)?window.console&&console.warn("cannot override language handler %s",h):A[h]=a}}function C(a,m){if(!a||!A.hasOwnProperty(a))a=/^\s*</.test(m)?"default-markup":"default-code";return A[a]}function E(a){var m=a.g;try{var e=M(a.h),h=e.a;a.a=h;a.c=e.c;a.d=0;C(m,h)(a);var k=/\bMSIE\b/.test(navigator.userAgent),m=/\n/g,t=a.a,s=t.length,e=0,l=a.c,p=l.length,h=0,d=a.e,g=d.length,a=0;d[g]=s;var r,n;for(n=r=0;n<g;)d[n]!==d[n+2]?(d[r++]=d[n++],d[r++]=d[n++]):n+=2;g=r;for(n=r=0;n<g;){for(var z=d[n],f=d[n+1],b=n+2;b+2<=g&&d[b+1]===f;)b+=2;d[r++]=z;d[r++]=f;n=b}for(d.length=r;h<p;){var o=l[h+2]||s,c=d[a+2]||s,b=Math.min(o,c),i=l[h+1],j;if(i.nodeType!==1&&(j=t.substring(e,b))){k&&(j=j.replace(m,"\r"));i.nodeValue=j;var u=i.ownerDocument,v=u.createElement("SPAN");v.className=d[a+1];var x=i.parentNode;x.replaceChild(v,i);v.appendChild(i);e<o&&(l[h+1]=i=u.createTextNode(t.substring(b,o)),x.insertBefore(i,v.nextSibling))}e=b;e>=o&&(h+=2);e>=c&&(a+=2)}}catch(w){"console"in window&&console.log(w&&w.stack?w.stack:w)}}var v=["break,continue,do,else,for,if,return,while"],w=[[v,"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],F=[w,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],G=[w,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"],H=[G,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"],w=[w,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"],I=[v,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],J=[v,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],v=[v,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"],K=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/,N=/\S/,O=u({keywords:[F,H,w,"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END"+
I,J,v],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),A={};k(O,["default-code"]);k(x([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]);k(x([["pln",/^\s+/,q," \t\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,q,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'/>]|\/(?=\s)))/],["pun",/^[/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]);k(x([],[["atv",/^[\S\s]+/]]),["uq.val"]);k(u({keywords:F,hashComments:!0,cStyleComments:!0,types:K}),["c","cc","cpp","cxx","cyc","m"]);k(u({keywords:"null,true,false"}),["json"]);k(u({keywords:H,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:K}),["cs"]);k(u({keywords:G,cStyleComments:!0}),["java"]);k(u({keywords:v,hashComments:!0,multiLineStrings:!0}),["bsh","csh","sh"]);k(u({keywords:I,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py"]);k(u({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["perl","pl","pm"]);k(u({keywords:J,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb"]);k(u({keywords:w,cStyleComments:!0,regexLiterals:!0}),["js"]);k(u({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]);k(x([],[["str",/^[\S\s]+/]]),["regex"]);window.prettyPrintOne=function(a,m,e){var h=document.createElement("PRE");h.innerHTML=a;e&&D(h,e);E({g:m,i:e,h:h});return h.innerHTML};window.prettyPrint=function(a){function m(){for(var e=window.PR_SHOULD_USE_CONTINUATION?l.now()+250:Infinity;p<h.length&&l.now()<e;p++){var n=h[p],k=n.className;if(k.indexOf("prettyprint")>=0){var k=k.match(g),f,b;if(b=!k){b=n;for(var o=void 0,c=b.firstChild;c;c=c.nextSibling)var i=c.nodeType,o=i===1?o?b:c:i===3?N.test(c.nodeValue)?b:o:o;b=(f=o===b?void 0:o)&&"CODE"===f.tagName}b&&(k=f.className.match(g));k&&(k=k[1]);b=!1;for(o=n.parentNode;o;o=o.parentNode)if((o.tagName==="pre"||o.tagName==="code"||o.tagName==="xmp")&&o.className&&o.className.indexOf("prettyprint")>=0){b=!0;break}b||((b=(b=n.className.match(/\blinenums\b(?::(\d+))?/))?b[1]&&b[1].length?+b[1]:!0:!1)&&D(n,b),d={g:k,h:n,i:b},E(d))}}p<h.length?setTimeout(m,250):a&&a()}for(var e=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],h=[],k=0;k<e.length;++k)for(var t=0,s=e[k].length;t<s;++t)h.push(e[k][t]);var e=q,l=Date;l.now||(l={now:function(){return+new Date}});var p=0,d,g=/\blang(?:uage)?-([\w.]+)(?!\S)/;m()};window.PR={createSimpleLexer:x,registerLangHandler:k,sourceDecorator:u,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ"}})();var dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){val=String(val);len=len||2;while(val.length<len)val="0"+val;return val;};return function(date,mask,utc){var dF=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(date)=="[object String]"&&!/\d/.test(date)){mask=date;date=undefined;}
date=date?new Date(date):new Date;if(isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]);if(mask.slice(0,4)=="UTC:"){mask=mask.slice(4);utc=true;}
var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1);});};}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(mask,utc){return dateFormat(this,mask,utc);};var IPython=(function(IPython){var utils=IPython.utils;var Events=function(){};IPython.Events=Events;IPython.events=new Events();return IPython;}(IPython));IPython.namespace('IPython.utils');IPython.utils=(function(IPython){var regex_split=function(str,separator,limit){if(Object.prototype.toString.call(separator)!=="[object RegExp]"){return split.call(str,separator,limit);}
var output=[],flags=(separator.ignoreCase?"i":"")+
(separator.multiline?"m":"")+
(separator.extended?"x":"")+
(separator.sticky?"y":""),lastLastIndex=0,separator=new RegExp(separator.source,flags+"g"),separator2,match,lastIndex,lastLength;str+="";var compliantExecNpcg=typeof(/()??/.exec("")[1])==="undefined"
if(!compliantExecNpcg){separator2=new RegExp("^"+separator.source+"$(?!\\s)",flags);}
limit=typeof(limit)==="undefined"?-1>>>0:limit>>>0;while(match=separator.exec(str)){lastIndex=match.index+match[0].length;if(lastIndex>lastLastIndex){output.push(str.slice(lastLastIndex,match.index));if(!compliantExecNpcg&&match.length>1){match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++){if(typeof(arguments[i])==="undefined"){match[i]=undefined;}}});}
if(match.length>1&&match.index<str.length){Array.prototype.push.apply(output,match.slice(1));}
lastLength=match[0].length;lastLastIndex=lastIndex;if(output.length>=limit){break;}}
if(separator.lastIndex===match.index){separator.lastIndex++;}}
if(lastLastIndex===str.length){if(lastLength||!separator.test("")){output.push("");}}else{output.push(str.slice(lastLastIndex));}
return output.length>limit?output.slice(0,limit):output;};var uuid=function(){var s=[];var hexDigits="0123456789ABCDEF";for(var i=0;i<32;i++){s[i]=hexDigits.substr(Math.floor(Math.random()*0x10),1);}
s[12]="4";s[16]=hexDigits.substr((s[16]&0x3)|0x8,1);var uuid=s.join("");return uuid;};function xmlencode(string){return string.replace(/\&/g,'&'+'amp;').replace(/</g,'&'+'lt;').replace(/>/g,'&'+'gt;').replace(/\'/g,'&'+'apos;').replace(/\"/g,'&'+'quot;').replace(/`/g,'&'+'#96;');}
var ansi_colormap={"30":"ansiblack","31":"ansired","32":"ansigreen","33":"ansiyellow","34":"ansiblue","35":"ansipurple","36":"ansicyan","37":"ansigrey","01":"ansibold"};function fixConsole(txt){txt=xmlencode(txt);var re=/\033\[([\dA-Fa-f;]*?)m/;var opened=false;var cmds=[];var opener="";var closer="";while(re.test(txt)){var cmds=txt.match(re)[1].split(";");closer=opened?"</span>":"";opened=cmds.length>1||cmds[0]!=0;var rep=[];for(var i in cmds)
if(typeof(ansi_colormap[cmds[i]])!="undefined")
rep.push(ansi_colormap[cmds[i]]);opener=rep.length>0?"<span class=\""+rep.join(" ")+"\">":"";txt=txt.replace(re,closer+opener);}
if(opened)txt+="</span>";return txt;}
function fixCarriageReturn(txt){var tmp=txt;do{txt=tmp;tmp=txt.replace(/\r+\n/gm,'\n');tmp=tmp.replace(/^.*\r+/gm,'');}while(tmp.length<txt.length);return txt;}
function wrapUrls(txt){var url_re=/(^|\W)(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\]])($|\W)/gi;return txt.replace(url_re,"$1 $2$3 $4");}
function autoLinkUrls(txt){return txt.replace(/ ((https?|ftp):[^'">\s]+) /gi,"<a target=\"_blank\" href=\"$1\">$1</a>");}
grow=function(element){var dom=element.get(0);var lines_count=0;var lines=dom.value.split(/\r|\r\n|\n/);lines_count=lines.length;if(lines_count>=1){dom.rows=lines_count;}else{dom.rows=1;}};var keycodes={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,CONTROL:17,ALT:18,ESC:27,SPACE:32,PGUP:33,PGDOWN:34,LEFT_ARROW:37,LEFTARROW:37,LEFT:37,UP_ARROW:38,UPARROW:38,UP:38,RIGHT_ARROW:39,RIGHTARROW:39,RIGHT:39,DOWN_ARROW:40,DOWNARROW:40,DOWN:40,};var points_to_pixels=function(points){var test=$('<div style="display: none; width: 10000pt; padding:0; border:0;"></div>');$(body).append(test);var pixel_per_point=test.width()/10000;test.remove();return Math.floor(points*pixel_per_point);};browser=(function(){var N=navigator.appName,ua=navigator.userAgent,tem;var M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(M&&(tem=ua.match(/version\/([\.\d]+)/i))!=null)M[2]=tem[1];M=M?[M[1],M[2]]:[N,navigator.appVersion,'-?'];return M;})();return{regex_split:regex_split,uuid:uuid,fixConsole:fixConsole,keycodes:keycodes,grow:grow,fixCarriageReturn:fixCarriageReturn,wrapUrls:wrapUrls,autoLinkUrls:autoLinkUrls,points_to_pixels:points_to_pixels,browser:browser};}(IPython));var IPython=(function(IPython){var LayoutManager=function(){this.bind_events();};LayoutManager.prototype.bind_events=function(){$(window).resize($.proxy(this.do_resize,this));};LayoutManager.prototype.app_height=function(){var win=$(window);var w=win.width();var h=win.height();var header_height;if($('div#header').css('display')==='none'){header_height=0;}else{header_height=$('div#header').outerHeight(true);}
var menubar_height=$('div#menubar').outerHeight(true);var toolbar_height;if($('div#maintoolbar').css('display')==='none'){toolbar_height=0;}else{toolbar_height=$('div#maintoolbar').outerHeight(true);}
return h-header_height-menubar_height-toolbar_height;}
LayoutManager.prototype.do_resize=function(){var app_height=this.app_height()
$('#ipython-main-app').height(app_height);var pager_height=IPython.pager.percentage_height*app_height;var pager_splitter_height=$('div#pager_splitter').outerHeight(true);$('div#pager').height(pager_height);if(IPython.pager.expanded){$('div#notebook').height(app_height-pager_height-pager_splitter_height);}else{$('div#notebook').height(app_height-pager_splitter_height);}};IPython.LayoutManager=LayoutManager;return IPython;}(IPython));IPython.namespace('IPython.mathjaxutils');IPython.mathjaxutils=(function(IPython){var init=function(){if(window.MathJax){MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],["\\(","\\)"]],displayMath:[['$$','$$'],["\\[","\\]"]],processEnvironments:true},displayAlign:'left',"HTML-CSS":{styles:{'.MathJax_Display':{"margin":0}}}});MathJax.Hub.Configured();}else if(window.mathjax_url!=""){var dialog=$('<div></div>').append($("<p></p>").addClass('dialog').html("Math/LaTeX rendering will be disabled.")).append($("<p></p>").addClass('dialog').html("If you have administrative access to the notebook server and"+" a working internet connection, you can install a local copy"+" of MathJax for offline use with the following command on the server"+" at a Python or IPython prompt:")).append($("<pre></pre>").addClass('dialog').html(">>> from IPython.external import mathjax; mathjax.install_mathjax()")).append($("<p></p>").addClass('dialog').html("This will try to install MathJax into the IPython source directory.")).append($("<p></p>").addClass('dialog').html("If IPython is installed to a location that requires"+" administrative privileges to write, you will need to make this call as"+" an administrator, via 'sudo'.")).append($("<p></p>").addClass('dialog').html("When you start the notebook server, you can instruct it to disable MathJax support altogether:")).append($("<pre></pre>").addClass('dialog').html("$ ipython notebook --no-mathjax")).append($("<p></p>").addClass('dialog').html("which will prevent this dialog from appearing.")).dialog({title:"Failed to retrieve MathJax from '"+window.mathjax_url+"'",width:"70%",modal:true,})}else{};};var inline="$";var blocks,start,end,last,braces;var math;var MATHSPLIT=/(\$\$?|\\(?:begin|end)\{[a-z]*\*?\}|\\[\\{}$]|[{}]|(?:\n\s*)+|@@\d+@@)/i;var process_math=function(i,j,pre_process){var hub=MathJax.Hub;var block=blocks.slice(i,j+1).join("").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");if(hub.Browser.isMSIE){block=block.replace(/(%[^\n]*)\n/g,"$1<br/>\n")}
while(j>i){blocks[j]="";j--;}
blocks[i]="@@"+math.length+"@@";if(pre_process)
block=pre_process(block);math.push(block);start=end=last=null;}
var remove_math=function(text){if(!window.MathJax){return text;}
start=end=last=null;math=[];var hasCodeSpans=/`/.test(text),de_tilde;if(hasCodeSpans){text=text.replace(/~/g,"~T").replace(/(^|[^\\])(`+)([^\n]*?[^`\n])\2(?!`)/gm,function(wholematch){return wholematch.replace(/\$/g,"~D");});de_tilde=function(text){return text.replace(/~([TD])/g,function(wholematch,character){return{T:"~",D:"$"}[character];})};}else{de_tilde=function(text){return text;};}
blocks=IPython.utils.regex_split(text.replace(/\r\n?/g,"\n"),MATHSPLIT);for(var i=1,m=blocks.length;i<m;i+=2){var block=blocks[i];if(block.charAt(0)==="@"){blocks[i]="@@"+math.length+"@@";math.push(block);}
else if(start){if(block===end){if(braces){last=i}
else{process_math(start,i,de_tilde)}}
else if(block.match(/\n.*\n/)){if(last){i=last;process_math(start,i,de_tilde)}
start=end=last=null;braces=0;}
else if(block==="{"){braces++}
else if(block==="}"&&braces){braces--}}
else{if(block===inline||block==="$$"){start=i;end=block;braces=0;}
else if(block.substr(1,5)==="begin"){start=i;end="\\end"+block.substr(6);braces=0;}}}
if(last){process_math(start,last,de_tilde)}
return de_tilde(blocks.join(""));}
var replace_math=function(text){if(!window.MathJax){return text;}
text=text.replace(/@@(\d+)@@/g,function(match,n){return math[n]});math=null;return text;}
return{init:init,process_math:process_math,remove_math:remove_math,replace_math:replace_math};}(IPython));var IPython=(function(IPython){"use strict";var utils=IPython.utils;var OutputArea=function(selector,prompt_area){this.selector=selector;this.wrapper=$(selector);this.outputs=[];this.collapsed=false;this.scrolled=false;this.clear_out_timeout=null;if(prompt_area===undefined){this.prompt_area=true;}else{this.prompt_area=prompt_area;}
this.create_elements();this.style();this.bind_events();};OutputArea.prototype.create_elements=function(){this.element=$("<div/>");this.collapse_button=$("<div/>");this.prompt_overlay=$("<div/>");this.wrapper.append(this.prompt_overlay);this.wrapper.append(this.element);this.wrapper.append(this.collapse_button);};OutputArea.prototype.style=function(){this.collapse_button.hide();this.prompt_overlay.hide();this.wrapper.addClass('output_wrapper');this.element.addClass('output vbox');this.collapse_button.button();this.collapse_button.addClass('output_collapsed vbox');this.collapse_button.attr('title','click to expand outout');this.collapse_button.html('. . .');this.prompt_overlay.addClass('out_prompt_overlay prompt');this.prompt_overlay.attr('title','click to expand outout; double click to hide output');this.collapse();};OutputArea.prototype._should_scroll=function(lines){if(!lines){lines=100;}
var fontSize=this.element.css('font-size');var lineHeight=Math.floor(parseInt(fontSize.replace('px',''))*1.5);return(this.element.height()>lines*lineHeight);};OutputArea.prototype.bind_events=function(){var that=this;this.prompt_overlay.dblclick(function(){that.toggle_output();});this.prompt_overlay.click(function(){that.toggle_scroll();});this.element.resize(function(){if(IPython.utils.browser[0]==="Firefox"){return;}
if(!that.scrolled&&that._should_scroll()){that.scroll_area();}});this.collapse_button.click(function(){that.expand();});this.collapse_button.hover(function(){$(this).addClass("ui-state-hover");},function(){$(this).removeClass("ui-state-hover");});};OutputArea.prototype.collapse=function(){if(!this.collapsed){this.element.hide();this.prompt_overlay.hide();if(this.element.html()){this.collapse_button.show();}
this.collapsed=true;}};OutputArea.prototype.expand=function(){if(this.collapsed){this.collapse_button.hide();this.element.show();this.prompt_overlay.show();this.collapsed=false;}};OutputArea.prototype.toggle_output=function(){if(this.collapsed){this.expand();}else{this.collapse();}};OutputArea.prototype.scroll_area=function(){this.element.addClass('output_scroll');this.prompt_overlay.attr('title','click to unscroll output; double click to hide');this.scrolled=true;};OutputArea.prototype.unscroll_area=function(){this.element.removeClass('output_scroll');this.prompt_overlay.attr('title','click to scroll output; double click to hide');this.scrolled=false;};OutputArea.prototype.scroll_if_long=function(lines){if(this._should_scroll(lines)){this.scroll_area();}};OutputArea.prototype.toggle_scroll=function(){if(this.scrolled){this.unscroll_area();}else{this.scroll_if_long(20);}};OutputArea.prototype.typeset=function(){if(window.MathJax){MathJax.Hub.Queue(["Typeset",MathJax.Hub]);}};OutputArea.prototype.handle_output=function(msg_type,content){var json={};json.output_type=msg_type;if(msg_type==="stream"){json.text=content.data;json.stream=content.name;}else if(msg_type==="display_data"){json=this.convert_mime_types(json,content.data);}else if(msg_type==="pyout"){json.prompt_number=content.execution_count;json=this.convert_mime_types(json,content.data);}else if(msg_type==="pyerr"){json.ename=content.ename;json.evalue=content.evalue;json.traceback=content.traceback;}
this.append_output(json,true);};OutputArea.prototype.convert_mime_types=function(json,data){if(data['text/plain']!==undefined){json.text=data['text/plain'];}
if(data['text/html']!==undefined){json.html=data['text/html'];}
if(data['image/svg+xml']!==undefined){json.svg=data['image/svg+xml'];}
if(data['image/png']!==undefined){json.png=data['image/png'];}
if(data['image/jpeg']!==undefined){json.jpeg=data['image/jpeg'];}
if(data['text/latex']!==undefined){json.latex=data['text/latex'];}
if(data['application/json']!==undefined){json.json=data['application/json'];}
if(data['application/javascript']!==undefined){json.javascript=data['application/javascript'];}
return json;};OutputArea.prototype.append_output=function(json,dynamic){this.expand();this.flush_clear_timeout();if(json.output_type==='pyout'){this.append_pyout(json,dynamic);}else if(json.output_type==='pyerr'){this.append_pyerr(json);}else if(json.output_type==='display_data'){this.append_display_data(json,dynamic);}else if(json.output_type==='stream'){this.append_stream(json);}
this.outputs.push(json);var that=this;setTimeout(function(){that.element.trigger('resize');},100);};OutputArea.prototype.create_output_area=function(){var oa=$("<div/>").addClass("hbox output_area");if(this.prompt_area){oa.append($('<div/>').addClass('prompt'));}
return oa;};OutputArea.prototype.append_pyout=function(json,dynamic){var n=json.prompt_number||' ';var toinsert=this.create_output_area();if(this.prompt_area){toinsert.find('div.prompt').addClass('output_prompt').html('Out['+n+']:');}
this.append_mime_type(json,toinsert,dynamic);this.element.append(toinsert);if((json.latex!==undefined)||(json.html!==undefined)){this.typeset();}};OutputArea.prototype.append_pyerr=function(json){var tb=json.traceback;if(tb!==undefined&&tb.length>0){var s='';var len=tb.length;for(var i=0;i<len;i++){s=s+tb[i]+'\n';}
s=s+'\n';var toinsert=this.create_output_area();this.append_text(s,toinsert);this.element.append(toinsert);}};OutputArea.prototype.append_stream=function(json){if(json.stream==undefined){json.stream='stdout';}
var text=json.text;var subclass="output_"+json.stream;if(this.outputs.length>0){var last=this.outputs[this.outputs.length-1];if(last.output_type=='stream'&&json.stream==last.stream){var pre=this.element.find('div.'+subclass).last().find('pre');var html=utils.fixCarriageReturn(pre.html()+utils.fixConsole(text));pre.html(html);return;}}
if(!text.replace("\r","")){return;}
var toinsert=this.create_output_area();this.append_text(text,toinsert,"output_stream "+subclass);this.element.append(toinsert);};OutputArea.prototype.append_display_data=function(json,dynamic){var toinsert=this.create_output_area();this.append_mime_type(json,toinsert,dynamic);this.element.append(toinsert);if((json.latex!==undefined)||(json.html!==undefined)){this.typeset();}};OutputArea.display_order=['javascript','html','latex','svg','png','jpeg','text'];OutputArea.prototype.append_mime_type=function(json,element,dynamic){for(var type_i in OutputArea.display_order){var type=OutputArea.display_order[type_i];if(json[type]!=undefined){if(type=='javascript'){if(dynamic){this.append_javascript(json.javascript,element,dynamic);}}else{this['append_'+type](json[type],element);}
return;}}};OutputArea.prototype.append_html=function(html,element){var toinsert=$("<div/>").addClass("box-flex1 output_subarea output_html rendered_html");toinsert.append(html);element.append(toinsert);};OutputArea.prototype.append_javascript=function(js,container){var element=$("<div/>").addClass("box-flex1 output_subarea");container.append(element);container.hide();try{eval(js);}catch(err){console.log('Error in Javascript!');console.log(err);container.show();element.append($('<div/>').html("Error in Javascript !<br/>"+
err.toString()+'<br/>See your browser Javascript console for more details.').addClass('js-error'));}};OutputArea.prototype.append_text=function(data,element,extra_class){var toinsert=$("<div/>").addClass("box-flex1 output_subarea output_text");data=utils.wrapUrls(data);data=utils.fixConsole(data);data=utils.fixCarriageReturn(data);data=utils.autoLinkUrls(data);if(extra_class){toinsert.addClass(extra_class);}
toinsert.append($("<pre/>").html(data));element.append(toinsert);};OutputArea.prototype.append_svg=function(svg,element){var toinsert=$("<div/>").addClass("box-flex1 output_subarea output_svg");toinsert.append(svg);element.append(toinsert);};OutputArea.prototype._dblclick_to_reset_size=function(img){var that=this;setTimeout(function(){var h0=img.height();var w0=img.width();if(!(h0&&w0)){that._dblclick_to_reset_size(img);return;}
img.resizable({aspectRatio:true,autoHide:true});img.dblclick(function(){img.parent().height(h0);img.height(h0);img.parent().width(w0);img.width(w0);});},250);};OutputArea.prototype.append_png=function(png,element){var toinsert=$("<div/>").addClass("box-flex1 output_subarea output_png");var img=$("<img/>").attr('src','data:image/png;base64,'+png);this._dblclick_to_reset_size(img);toinsert.append(img);element.append(toinsert);};OutputArea.prototype.append_jpeg=function(jpeg,element){var toinsert=$("<div/>").addClass("box-flex1 output_subarea output_jpeg");var img=$("<img/>").attr('src','data:image/jpeg;base64,'+jpeg);this._dblclick_to_reset_size(img);toinsert.append(img);element.append(toinsert);};OutputArea.prototype.append_latex=function(latex,element){var toinsert=$("<div/>").addClass("box-flex1 output_subarea output_latex");toinsert.append(latex);element.append(toinsert);};OutputArea.prototype.handle_clear_output=function(content){this.clear_output(content.stdout,content.stderr,content.other);};OutputArea.prototype.clear_output=function(stdout,stderr,other){var that=this;if(this.clear_out_timeout!=null){clearTimeout(this.clear_out_timeout);this.clear_out_timeout=null;this.clear_output_callback(this._clear_stdout,this._clear_stderr,this._clear_other);}
this._clear_stdout=stdout;this._clear_stderr=stderr;this._clear_other=other;this.clear_out_timeout=setTimeout(function(){that.clear_out_timeout=null;that._clear_stdout=that._clear_stderr=that._clear_other=null;that.clear_output_callback(stdout,stderr,other);},500);};OutputArea.prototype.clear_output_callback=function(stdout,stderr,other){var output_div=this.element;if(stdout&&stderr&&other){output_div.html("");this.outputs=[];this.unscroll_area();return;}
if(stdout){output_div.find("div.output_stdout").parent().remove();}
if(stderr){output_div.find("div.output_stderr").parent().remove();}
if(other){output_div.find("div.output_subarea").not("div.output_stderr").not("div.output_stdout").parent().remove();}
this.unscroll_area();for(var i=this.outputs.length-1;i>=0;i--){var out=this.outputs[i];var output_type=out.output_type;if(output_type=="display_data"&&other){this.outputs.splice(i,1);}else if(output_type=="stream"){if(stdout&&out.stream=="stdout"){this.outputs.splice(i,1);}else if(stderr&&out.stream=="stderr"){this.outputs.splice(i,1);}}}};OutputArea.prototype.flush_clear_timeout=function(){var output_div=this.element;if(this.clear_out_timeout){clearTimeout(this.clear_out_timeout);this.clear_out_timeout=null;this.clear_output_callback(this._clear_stdout,this._clear_stderr,this._clear_other);}};OutputArea.prototype.fromJSON=function(outputs){var len=outputs.length;for(var i=0;i<len;i++){this.append_output(outputs[i],false);}};OutputArea.prototype.toJSON=function(){var outputs=[];var len=this.outputs.length;for(var i=0;i<len;i++){outputs[i]=this.outputs[i];}
return outputs;};IPython.OutputArea=OutputArea;return IPython;}(IPython));var IPython=(function(IPython){var utils=IPython.utils;var Cell=function(options){options=options||{};this.cm_config=$.extend({},Cell.cm_default,options.cm_config);this.placeholder=this.placeholder||'';this.read_only=false;this.selected=false;this.element=null;this.metadata={};this.user_highlight='auto';this.create_element();if(this.element!==null){this.element.data("cell",this);this.bind_events();}
this.cell_id=utils.uuid();};Cell.cm_default={indentUnit:4,readOnly:this.read_only,};Cell.prototype.create_element=function(){};Cell.prototype.bind_events=function(){var that=this;that.element.click(function(event){if(that.selected===false){$([IPython.events]).trigger('select.Cell',{'cell':that});}});that.element.focusin(function(event){if(that.selected===false){$([IPython.events]).trigger('select.Cell',{'cell':that});}});};Cell.prototype.typeset=function(){if(window.MathJax){var cell_math=this.element.get(0);MathJax.Hub.Queue(["Typeset",MathJax.Hub,cell_math]);}};Cell.prototype.select=function(){this.element.addClass('selected');this.selected=true;};Cell.prototype.unselect=function(){this.element.removeClass('selected');this.selected=false;};Cell.prototype.get_text=function(){};Cell.prototype.set_text=function(text){};Cell.prototype.refresh=function(){this.code_mirror.refresh();};Cell.prototype.edit=function(){};Cell.prototype.render=function(){};Cell.prototype.toJSON=function(){var data={};data.metadata=this.metadata;return data;};Cell.prototype.fromJSON=function(data){if(data.metadata!==undefined){this.metadata=data.metadata;}
this.celltoolbar.rebuild();};Cell.prototype.is_splittable=function(){return true;};Cell.prototype.get_pre_cursor=function(){var cursor=this.code_mirror.getCursor();var text=this.code_mirror.getRange({line:0,ch:0},cursor);text=text.replace(/^\n+/,'').replace(/\n+$/,'');return text;}
Cell.prototype.get_post_cursor=function(){var cursor=this.code_mirror.getCursor();var last_line_num=this.code_mirror.lineCount()-1;var last_line_len=this.code_mirror.getLine(last_line_num).length;var end={line:last_line_num,ch:last_line_len}
var text=this.code_mirror.getRange(cursor,end);text=text.replace(/^\n+/,'').replace(/\n+$/,'');return text;};Cell.prototype.grow=function(element){var dom=element.get(0);var lines_count=0;var lines=dom.value.split(/\r|\r\n|\n/);lines_count=lines.length;if(lines_count>=1){dom.rows=lines_count;}else{dom.rows=1;}};Cell.prototype.show_line_numbers=function(value){this.code_mirror.setOption('lineNumbers',value);this.code_mirror.refresh();};Cell.prototype.toggle_line_numbers=function(){var val=this.code_mirror.getOption('lineNumbers');this.show_line_numbers(!val);};Cell.prototype.force_highlight=function(mode){this.user_highlight=mode;this.auto_highlight();};Cell.prototype._auto_highlight=function(modes){if(this.user_highlight!=undefined&&this.user_highlight!='auto')
{var mode=this.user_highlight;CodeMirror.autoLoadMode(this.code_mirror,mode);this.code_mirror.setOption('mode',mode);return;}
var first_line=this.code_mirror.getLine(0);for(var mode in modes){var regs=modes[mode]['reg'];for(var reg in regs){if(first_line.match(regs[reg])!=null){if(mode.search('magic_')!=0){this.code_mirror.setOption('mode',mode);CodeMirror.autoLoadMode(this.code_mirror,mode);return;}
var open=modes[mode]['open']||"%%";var close=modes[mode]['close']||"%%end";var mmode=mode;mode=mmode.substr(6);CodeMirror.autoLoadMode(this.code_mirror,mode);CodeMirror.defineMode(mmode,function(config){return CodeMirror.multiplexingMode(CodeMirror.patchedGetMode(config,'text/plain'),{open:open,close:close,mode:CodeMirror.patchedGetMode(config,mode),delimStyle:"delimit"});});this.code_mirror.setOption('mode',mmode);return;}}}
var default_mode=this.default_mode||'text/plain';this.code_mirror.setOption('mode',default_mode);};IPython.Cell=Cell;return IPython;}(IPython));var IPython=(function(IPython){"use strict";var CellToolbar=function(cell){CellToolbar._instances.push(this);this.cell=cell;this.create_element();this.rebuild();return this;};CellToolbar.prototype.create_element=function(){this.inner_element=$('<div/>').addClass('celltoolbar hbox reverse')
this.element=$('<div/>').addClass('ctb_hideshow').append(this.inner_element);};CellToolbar.global_hide=function(){$('body').removeClass('ctb_show');}
CellToolbar.global_show=function(){$('body').addClass('ctb_show');}
CellToolbar.prototype.hide=function(){this.element.removeClass('ctb_show');}
CellToolbar.prototype.show=function(){this.element.addClass('ctb_show');}
CellToolbar._callback_dict={};CellToolbar._ui_controls_list=[];CellToolbar._instances=[]
CellToolbar._presets={}
CellToolbar.register_callback=function(name,callback){CellToolbar._callback_dict[name]=callback;};CellToolbar.register_preset=function(name,preset_list){CellToolbar._presets[name]=preset_list
$([IPython.events]).trigger('preset_added.CellToolbar',{name:name});};CellToolbar.list_presets=function(){var keys=[];for(var k in CellToolbar._presets){keys.push(k);}
return keys;};CellToolbar.activate_preset=function(preset_name){var preset=CellToolbar._presets[preset_name];if(preset!=undefined){CellToolbar._ui_controls_list=preset;CellToolbar.rebuild_all();}}
CellToolbar.rebuild_all=function(){for(var i in CellToolbar._instances){CellToolbar._instances[i].rebuild();}}
CellToolbar.prototype.rebuild=function(){this.inner_element.empty();var cdict=CellToolbar._callback_dict;var preset=CellToolbar._ui_controls_list;for(var index in CellToolbar._ui_controls_list){var local_div=$('<div/>').addClass('button_container');this.inner_element.append(local_div)
cdict[preset[index]](local_div,this.cell)}}
CellToolbar.utils={};CellToolbar.utils.checkbox_ui_generator=function(name,setter,getter){return function(div,cell){var button_container=$(div)
var chkb=$('<input/>').attr('type','checkbox');var lbl=$('<label/>').append($('<span/>').text(name));lbl.append(chkb);chkb.attr("checked",getter(cell));chkb.click(function(){var v=getter(cell);setter(cell,!v);chkb.attr("checked",!v);})
button_container.append($('<div/>').append(lbl));}}
CellToolbar.utils.select_ui_generator=function(list_list,setter,getter,label){label=label?label:"";return function(div,cell){var button_container=$(div)
var lbl=$("<label/>").append($('<span/>').text(label));var select=$('<select/>').addClass('ui-widget ui-widget-content');for(var itemn in list_list){var opt=$('<option/>');opt.attr('value',list_list[itemn][1])
opt.text(list_list[itemn][0])
select.append(opt);}
select.val(getter(cell));select.change(function(){setter(cell,select.val());});button_container.append($('<div/>').append(lbl).append(select));}};IPython.CellToolbar=CellToolbar;return IPython;}(IPython));var posEq=function(a,b){return a.line==b.line&&a.ch==b.ch;}
CodeMirror.commands.delSpaceToPrevTabStop=function(cm){var from=cm.getCursor(true),to=cm.getCursor(false),sel=!posEq(from,to);if(!posEq(from,to)){cm.replaceRange("",from,to);return}
var cur=cm.getCursor(),line=cm.getLine(cur.line);var tabsize=cm.getOption('tabSize');var chToPrevTabStop=cur.ch-(Math.ceil(cur.ch/tabsize)-1)*tabsize;var from={ch:cur.ch-chToPrevTabStop,line:cur.line}
var select=cm.getRange(from,cur)
if(select.match(/^\ +$/)!=null){cm.replaceRange("",from,cur)}else{cm.deleteH(-1,"char")}};var IPython=(function(IPython){"use strict";var utils=IPython.utils;var key=IPython.utils.keycodes;CodeMirror.modeURL="/static/codemirror/mode/%N/%N.js";var CodeCell=function(kernel,options){var options=options||{}
this.kernel=kernel||null;this.code_mirror=null;this.input_prompt_number=null;this.collapsed=false;this.default_mode='python';var cm_overwrite_options={extraKeys:{"Tab":"indentMore","Shift-Tab":"indentLess",'Backspace':"delSpaceToPrevTabStop"},onKeyEvent:$.proxy(this.handle_codemirror_keyevent,this)};var arg_cm_options=options.cm_options||{};var cm_config=$.extend({},CodeCell.cm_default,arg_cm_options,cm_overwrite_options);var options={};options.cm_config=cm_config;IPython.Cell.apply(this,[options]);var that=this;this.element.focusout(function(){that.auto_highlight();});};CodeCell.cm_default={mode:'python',theme:'ipython',matchBrackets:true};CodeCell.prototype=new IPython.Cell();CodeCell.prototype.auto_highlight=function(){this._auto_highlight(IPython.config.cell_magic_highlight)};CodeCell.prototype.create_element=function(){IPython.Cell.prototype.create_element.apply(this,arguments);var cell=$('<div></div>').addClass('cell border-box-sizing code_cell vbox');cell.attr('tabindex','2');this.celltoolbar=new IPython.CellToolbar(this);var input=$('<div></div>').addClass('input hbox');var vbox=$('<div/>').addClass('vbox box-flex1')
input.append($('<div/>').addClass('prompt input_prompt'));vbox.append(this.celltoolbar.element);var input_area=$('<div/>').addClass('input_area');this.code_mirror=CodeMirror(input_area.get(0),this.cm_config);vbox.append(input_area);input.append(vbox);var output=$('<div></div>');cell.append(input).append(output);this.element=cell;this.output_area=new IPython.OutputArea(output,true);if(IPython.Completer!==undefined)
{this.completer=new IPython.Completer(this);}};CodeCell.prototype.handle_codemirror_keyevent=function(editor,event){if(this.read_only){return false;}
var that=this;if(event.type==='keydown'&&event.which!=key.TAB){IPython.tooltip.remove_and_cancel_tooltip();};var cur=editor.getCursor();if(event.keyCode===key.ENTER){this.auto_highlight();}
if(event.keyCode===key.ENTER&&(event.shiftKey||event.ctrlKey)){return true;}else if(event.which===40&&event.type==='keypress'&&IPython.tooltip.time_before_tooltip>=0){IPython.tooltip.pending(that);}else if(event.which===key.UPARROW&&event.type==='keydown'){if(!that.at_top()){event.stop();return false;}else{return true;};}else if(event.which===key.ESC){IPython.tooltip.remove_and_cancel_tooltip(true);return true;}else if(event.which===key.DOWNARROW&&event.type==='keydown'){if(!that.at_bottom()){event.stop();return false;}else{return true;};}else if(event.keyCode===key.TAB&&event.type=='keydown'&&event.shiftKey){if(editor.somethingSelected()){var anchor=editor.getCursor("anchor");var head=editor.getCursor("head");if(anchor.line!=head.line){return false;}}
IPython.tooltip.request(that);event.stop();return true;}else if(event.keyCode===key.TAB&&event.type=='keydown'){if(editor.somethingSelected()){return false}
var pre_cursor=editor.getRange({line:cur.line,ch:0},cur);if(pre_cursor.trim()===""){return false;}else if((pre_cursor.substr(-1)==="("||pre_cursor.substr(-1)===" ")&&IPython.config.tooltip_on_tab){IPython.tooltip.request(that);event.stop();return true;}else{event.stop();this.completer.startCompletion();return true;};}else{return false;};return false;};CodeCell.prototype.set_kernel=function(kernel){this.kernel=kernel;}
CodeCell.prototype.execute=function(){this.output_area.clear_output(true,true,true);this.set_input_prompt('*');this.element.addClass("running");var callbacks={'execute_reply':$.proxy(this._handle_execute_reply,this),'output':$.proxy(this.output_area.handle_output,this.output_area),'clear_output':$.proxy(this.output_area.handle_clear_output,this.output_area),'set_next_input':$.proxy(this._handle_set_next_input,this)};var msg_id=this.kernel.execute(this.get_text(),callbacks,{silent:false});};CodeCell.prototype._handle_execute_reply=function(content){this.set_input_prompt(content.execution_count);this.element.removeClass("running");$([IPython.events]).trigger('set_dirty.Notebook',{'value':true});}
CodeCell.prototype._handle_set_next_input=function(text){var data={'cell':this,'text':text}
$([IPython.events]).trigger('set_next_input.Notebook',data);}
CodeCell.prototype.select=function(){IPython.Cell.prototype.select.apply(this);this.code_mirror.refresh();this.code_mirror.focus();this.auto_highlight();};CodeCell.prototype.select_all=function(){var start={line:0,ch:0};var nlines=this.code_mirror.lineCount();var last_line=this.code_mirror.getLine(nlines-1);var end={line:nlines-1,ch:last_line.length};this.code_mirror.setSelection(start,end);};CodeCell.prototype.collapse=function(){this.collapsed=true;this.output_area.collapse();};CodeCell.prototype.expand=function(){this.collapsed=false;this.output_area.expand();};CodeCell.prototype.toggle_output=function(){this.collapsed=Boolean(1-this.collapsed);this.output_area.toggle_output();};CodeCell.prototype.toggle_output_scroll=function(){this.output_area.toggle_scroll();};CodeCell.input_prompt_classical=function(prompt_value,lines_number){var ns=prompt_value||"&nbsp;";return'In&nbsp;['+ns+']:'};CodeCell.input_prompt_continuation=function(prompt_value,lines_number){var html=[CodeCell.input_prompt_classical(prompt_value,lines_number)];for(var i=1;i<lines_number;i++){html.push(['...:'])};return html.join('</br>')};CodeCell.input_prompt_function=CodeCell.input_prompt_classical;CodeCell.prototype.set_input_prompt=function(number){var nline=1
if(this.code_mirror!=undefined){nline=this.code_mirror.lineCount();}
this.input_prompt_number=number;var prompt_html=CodeCell.input_prompt_function(this.input_prompt_number,nline);this.element.find('div.input_prompt').html(prompt_html);};CodeCell.prototype.clear_input=function(){this.code_mirror.setValue('');};CodeCell.prototype.get_text=function(){return this.code_mirror.getValue();};CodeCell.prototype.set_text=function(code){return this.code_mirror.setValue(code);};CodeCell.prototype.at_top=function(){var cursor=this.code_mirror.getCursor();if(cursor.line===0&&cursor.ch===0){return true;}else{return false;}};CodeCell.prototype.at_bottom=function(){var cursor=this.code_mirror.getCursor();if(cursor.line===(this.code_mirror.lineCount()-1)&&cursor.ch===this.code_mirror.getLine(cursor.line).length){return true;}else{return false;}};CodeCell.prototype.clear_output=function(stdout,stderr,other){this.output_area.clear_output(stdout,stderr,other);};CodeCell.prototype.fromJSON=function(data){IPython.Cell.prototype.fromJSON.apply(this,arguments);if(data.cell_type==='code'){if(data.input!==undefined){this.set_text(data.input);this.code_mirror.clearHistory();this.auto_highlight();}
if(data.prompt_number!==undefined){this.set_input_prompt(data.prompt_number);}else{this.set_input_prompt();};this.output_area.fromJSON(data.outputs);if(data.collapsed!==undefined){if(data.collapsed){this.collapse();}else{this.expand();};};};};CodeCell.prototype.toJSON=function(){var data=IPython.Cell.prototype.toJSON.apply(this);data.input=this.get_text();data.cell_type='code';if(this.input_prompt_number){data.prompt_number=this.input_prompt_number;};var outputs=this.output_area.toJSON();data.outputs=outputs;data.language='python';data.collapsed=this.collapsed;return data;};IPython.CodeCell=CodeCell;return IPython;}(IPython));var IPython=(function(IPython){"use strict";var key=IPython.utils.keycodes;function prepend_n_prc(str,n){for(var i=0;i<n;i++)
{str='%'+str}
return str;}
function _existing_completion(item,completion_array){for(var c in completion_array){if(completion_array[c].substr(-item.length)==item)
{return true;}}
return false;}
function shared_start(B,drop_prct){if(B.length==1){return B[0];}
var A=new Array();var common;var min_lead_prct=10;for(var i=0;i<B.length;i++){var str=B[i].str;var localmin=0;if(drop_prct==true){while(str.substr(0,1)=='%'){localmin=localmin+1;str=str.substring(1);}}
min_lead_prct=Math.min(min_lead_prct,localmin);A.push(str);}
if(A.length>1){var tem1,tem2,s;A=A.slice(0).sort();tem1=A[0];s=tem1.length;tem2=A.pop();while(s&&tem2.indexOf(tem1)==-1){tem1=tem1.substring(0,--s);}
if(tem1==""||tem2.indexOf(tem1)!=0){return prepend_n_prc('',min_lead_prct);}
return{str:prepend_n_prc(tem1,min_lead_prct),type:"computed",from:B[0].from,to:B[0].to};}
return null;}
var Completer=function(cell){this.cell=cell;this.editor=cell.code_mirror;var that=this;$([IPython.events]).on('status_busy.Kernel',function(){that.skip_kernel_completion=true;});$([IPython.events]).on('status_idle.Kernel',function(){that.skip_kernel_completion=false;});};Completer.prototype.startCompletion=function(){if(this.editor.somethingSelected())return;this.done=false;this.carry_on_completion(true);};Completer.prototype.carry_on_completion=function(ff){var cur=this.editor.getCursor();var line=this.editor.getLine(cur.line);var pre_cursor=this.editor.getRange({line:cur.line,ch:cur.ch-1},cur);if(!/[0-9a-z._/\\:~-]/i.test(pre_cursor)){this.close();return;}
this.autopick=false;if(ff!='undefined'&&ff==true){this.autopick=true;}
if(this.editor.somethingSelected())return;if(this.skip_kernel_completion==true){this.finish_completing({'matches':[],matched_text:""})}else{var callbacks={'complete_reply':$.proxy(this.finish_completing,this)};this.cell.kernel.complete(line,cur.ch,callbacks);}};Completer.prototype.finish_completing=function(content){var matched_text=content.matched_text;var matches=content.matches;var cur=this.editor.getCursor();var results=CodeMirror.contextHint(this.editor);var filterd_results=Array();for(var elm in results){if(_existing_completion(results[elm]['str'],matches)==false)
{filterd_results.push(results[elm]);}}
for(var i=matches.length-1;i>=0;--i){filterd_results.unshift({str:matches[i],type:"introspection",from:{line:cur.line,ch:cur.ch-matched_text.length},to:{line:cur.line,ch:cur.ch}});}
this.raw_result=filterd_results;if(!this.raw_result||!this.raw_result.length)return;if(this.autopick==true&&this.raw_result.length==1){this.insert(this.raw_result[0]);return;}
if(this.raw_result.length==1){var str=this.raw_result[0].str;var pre_cursor=this.editor.getRange({line:cur.line,ch:cur.ch-str.length},cur);if(pre_cursor==str){this.close();return;}}
this.complete=$('<div/>').addClass('completions');this.complete.attr('id','complete');this.sel=$('<select/>').attr('multiple','true').attr('size',Math.min(10,this.raw_result.length));var pos=this.editor.cursorCoords();this.complete.css('left',pos.x+'px');this.complete.css('top',pos.yBot+'px');this.complete.append(this.sel);$('body').append(this.complete);var that=this;this.sel.dblclick(function(){that.pick();});this.sel.blur(this.close);this.sel.keydown(function(event){that.keydown(event);});this.build_gui_list(this.raw_result);this.sel.focus();if(window.opera)setTimeout(function(){if(!this.done)this.sel.focus();},100);return true;}
Completer.prototype.insert=function(completion){this.editor.replaceRange(completion.str,completion.from,completion.to);}
Completer.prototype.build_gui_list=function(completions){for(var i=0;i<completions.length;++i){var opt=$('<option/>').text(completions[i].str).addClass(completions[i].type);this.sel.append(opt);}
this.sel.children().first().attr('selected','true');}
Completer.prototype.close=function(){if(this.done)return;this.done=true;$('.completions').remove();}
Completer.prototype.pick=function(){this.insert(this.raw_result[this.sel[0].selectedIndex]);this.close();var that=this;setTimeout(function(){that.editor.focus();},50);}
Completer.prototype.keydown=function(event){var code=event.keyCode;var that=this;if(code==key.ENTER){CodeMirror.e_stop(event);this.pick();}
else if(code==key.ESC){CodeMirror.e_stop(event);this.close();this.editor.focus();}else if(code==key.SPACE||code==key.BACKSPACE){this.close();this.editor.focus();}else if(code==key.TAB){var sh=shared_start(this.raw_result,true);if(sh){this.insert(sh);}
this.close();CodeMirror.e_stop(event);this.editor.focus();setTimeout(function(){that.carry_on_completion();},50);}else if(code==key.UPARROW||code==key.DOWNARROW){event.stopPropagation();}else if(code!=key.UPARROW&&code!=key.DOWNARROW){this.close();this.editor.focus();setTimeout(function(){that.carry_on_completion();},50);}}
IPython.Completer=Completer;return IPython;}(IPython));var IPython=(function(IPython){var key=IPython.utils.keycodes;var TextCell=function(options){this.code_mirror_mode=this.code_mirror_mode||'htmlmixed';var options=options||{};var cm_overwrite_options={extraKeys:{"Tab":"indentMore","Shift-Tab":"indentLess"},onKeyEvent:$.proxy(this.handle_codemirror_keyevent,this)};var arg_cm_options=options.cm_options||{};var cm_config=$.extend({},TextCell.cm_default,arg_cm_options,cm_overwrite_options);var options={};options.cm_config=cm_config;IPython.Cell.apply(this,[options]);this.rendered=false;this.cell_type=this.cell_type||'text';};TextCell.cm_default={mode:this.code_mirror_mode,theme:'default',value:this.placeholder,lineWrapping:true,}
TextCell.prototype=new IPython.Cell();TextCell.prototype.create_element=function(){IPython.Cell.prototype.create_element.apply(this,arguments);var cell=$("<div>").addClass('cell text_cell border-box-sizing vbox');cell.attr('tabindex','2');this.celltoolbar=new IPython.CellToolbar(this);cell.append(this.celltoolbar.element);var input_area=$('<div/>').addClass('text_cell_input border-box-sizing');this.code_mirror=CodeMirror(input_area.get(0),this.cm_config);var render_area=$('<div/>').addClass('text_cell_render border-box-sizing').addClass('rendered_html').attr('tabindex','-1');cell.append(input_area).append(render_area);this.element=cell;};TextCell.prototype.bind_events=function(){IPython.Cell.prototype.bind_events.apply(this);var that=this;this.element.keydown(function(event){if(event.which===13&&!event.shiftKey){if(that.rendered){that.edit();return false;};};});this.element.dblclick(function(){that.edit();});};TextCell.prototype.handle_codemirror_keyevent=function(editor,event){if(event.keyCode===13&&(event.shiftKey||event.ctrlKey)){return true;}
return false;};TextCell.prototype.select=function(){IPython.Cell.prototype.select.apply(this);var output=this.element.find("div.text_cell_render");output.trigger('focus');};TextCell.prototype.unselect=function(){this.render();IPython.Cell.prototype.unselect.apply(this);};TextCell.prototype.edit=function(){if(this.read_only)return;if(this.rendered===true){var text_cell=this.element;var output=text_cell.find("div.text_cell_render");output.hide();text_cell.find('div.text_cell_input').show();this.code_mirror.refresh();this.code_mirror.focus();this.rendered=false;if(this.get_text()===this.placeholder){this.set_text('');this.refresh();}}};TextCell.prototype.render=function(){};TextCell.prototype.get_text=function(){return this.code_mirror.getValue();};TextCell.prototype.set_text=function(text){this.code_mirror.setValue(text);this.code_mirror.refresh();};TextCell.prototype.get_rendered=function(){return this.element.find('div.text_cell_render').html();};TextCell.prototype.set_rendered=function(text){this.element.find('div.text_cell_render').html(text);};TextCell.prototype.at_top=function(){if(this.rendered){return true;}else{return false;}};TextCell.prototype.at_bottom=function(){if(this.rendered){return true;}else{return false;}};TextCell.prototype.fromJSON=function(data){IPython.Cell.prototype.fromJSON.apply(this,arguments);if(data.cell_type===this.cell_type){if(data.source!==undefined){this.set_text(data.source);this.code_mirror.clearHistory();this.set_rendered(data.rendered||'');this.rendered=false;this.render();}}};TextCell.prototype.toJSON=function(){var data=IPython.Cell.prototype.toJSON.apply(this);data.cell_type=this.cell_type;data.source=this.get_text();return data;};var HTMLCell=function(){this.placeholder="Type <strong>HTML</strong> and LaTeX: $\\alpha^2$";IPython.TextCell.apply(this,arguments);this.cell_type='html';};HTMLCell.prototype=new TextCell();HTMLCell.prototype.render=function(){if(this.rendered===false){var text=this.get_text();if(text===""){text=this.placeholder;}
this.set_rendered(text);this.typeset();this.element.find('div.text_cell_input').hide();this.element.find("div.text_cell_render").show();this.rendered=true;}};var MarkdownCell=function(){this.placeholder="Type *Markdown* and LaTeX: $\\alpha^2$";IPython.TextCell.apply(this,arguments);this.cell_type='markdown';};MarkdownCell.prototype=new TextCell();MarkdownCell.prototype.render=function(){if(this.rendered===false){var text=this.get_text();if(text===""){text=this.placeholder;}
text=IPython.mathjaxutils.remove_math(text)
var html=IPython.markdown_converter.makeHtml(text);html=IPython.mathjaxutils.replace_math(html)
try{this.set_rendered(html);}catch(e){console.log("Error running Javascript in Markdown:");console.log(e);this.set_rendered($("<div/>").addClass("js-error").html("Error rendering Markdown!<br/>"+e.toString()));}
this.element.find('div.text_cell_input').hide();this.element.find("div.text_cell_render").show();var code_snippets=this.element.find("pre > code");code_snippets.replaceWith(function(){var code=$(this).html();code=code.replace(/(\r\n|\n|\r)/gm,"<br/>");code=code.replace(/ /gm,'&nbsp;');code=prettyPrintOne(code);return'<code class="prettyprint">'+code+'</code>';});this.typeset()
this.rendered=true;}};var RawCell=function(){this.placeholder="Type plain text and LaTeX: $\\alpha^2$";this.code_mirror_mode='rst';IPython.TextCell.apply(this,arguments);this.cell_type='raw';var that=this
this.element.focusout(function(){that.auto_highlight();});};RawCell.prototype=new TextCell();RawCell.prototype.auto_highlight=function(){this._auto_highlight(IPython.config.raw_cell_highlight);};RawCell.prototype.render=function(){this.rendered=true;this.edit();};RawCell.prototype.handle_codemirror_keyevent=function(editor,event){var that=this;if(event.which===key.UPARROW&&event.type==='keydown'){if(!that.at_top()){event.stop();return false;}else{return true;};}else if(event.which===key.DOWNARROW&&event.type==='keydown'){if(!that.at_bottom()){event.stop();return false;}else{return true;};};return false;};RawCell.prototype.select=function(){IPython.Cell.prototype.select.apply(this);this.code_mirror.refresh();this.code_mirror.focus();};RawCell.prototype.at_top=function(){var cursor=this.code_mirror.getCursor();if(cursor.line===0&&cursor.ch===0){return true;}else{return false;}};RawCell.prototype.at_bottom=function(){var cursor=this.code_mirror.getCursor();if(cursor.line===(this.code_mirror.lineCount()-1)&&cursor.ch===this.code_mirror.getLine(cursor.line).length){return true;}else{return false;}};var HeadingCell=function(){this.placeholder="Type Heading Here";IPython.TextCell.apply(this,arguments);this.level=1;this.cell_type='heading';};HeadingCell.prototype=new TextCell();HeadingCell.prototype.fromJSON=function(data){if(data.level!=undefined){this.level=data.level;}
IPython.TextCell.prototype.fromJSON.apply(this,arguments);};HeadingCell.prototype.toJSON=function(){var data=IPython.TextCell.prototype.toJSON.apply(this);data.level=this.get_level();return data;};HeadingCell.prototype.set_level=function(level){this.level=level;if(this.rendered){this.rendered=false;this.render();};};HeadingCell.prototype.get_level=function(){return this.level;};HeadingCell.prototype.set_rendered=function(text){var r=this.element.find("div.text_cell_render");r.empty();r.append($('<h'+this.level+'/>').html(text));};HeadingCell.prototype.get_rendered=function(){var r=this.element.find("div.text_cell_render");return r.children().first().html();};HeadingCell.prototype.render=function(){if(this.rendered===false){var text=this.get_text();if(text===""){text=this.placeholder;}
this.set_rendered(text);this.typeset();this.element.find('div.text_cell_input').hide();this.element.find("div.text_cell_render").show();this.rendered=true;};};IPython.TextCell=TextCell;IPython.HTMLCell=HTMLCell;IPython.MarkdownCell=MarkdownCell;IPython.RawCell=RawCell;IPython.HeadingCell=HeadingCell;return IPython;}(IPython));var IPython=(function(IPython){var utils=IPython.utils;var Kernel=function(base_url){this.kernel_id=null;this.shell_channel=null;this.iopub_channel=null;this.base_url=base_url;this.running=false;this.username="username";this.session_id=utils.uuid();this._msg_callbacks={};if(typeof(WebSocket)!=='undefined'){this.WebSocket=WebSocket;}else if(typeof(MozWebSocket)!=='undefined'){this.WebSocket=MozWebSocket;}else{alert('Your browser does not have WebSocket support, please try Chrome, Safari or Firefox ≥ 6. Firefox 4 and 5 are also supported by you have to enable WebSockets in about:config.');};};Kernel.prototype._get_msg=function(msg_type,content){var msg={header:{msg_id:utils.uuid(),username:this.username,session:this.session_id,msg_type:msg_type},metadata:{},content:content,parent_header:{}};return msg;};Kernel.prototype.start=function(notebook_id){var that=this;if(!this.running){var qs=$.param({notebook:notebook_id});var url=this.base_url+'?'+qs;$.post(url,$.proxy(that._kernel_started,that),'json');};};Kernel.prototype.restart=function(){$([IPython.events]).trigger('status_restarting.Kernel',{kernel:this});var that=this;if(this.running){this.stop_channels();var url=this.kernel_url+"/restart";$.post(url,$.proxy(that._kernel_started,that),'json');};};Kernel.prototype._kernel_started=function(json){console.log("Kernel started: ",json.kernel_id);this.running=true;this.kernel_id=json.kernel_id;this.ws_url=json.ws_url;this.kernel_url=this.base_url+"/"+this.kernel_id;this.start_channels();this.shell_channel.onmessage=$.proxy(this._handle_shell_reply,this);this.iopub_channel.onmessage=$.proxy(this._handle_iopub_reply,this);$([IPython.events]).trigger('status_started.Kernel',{kernel:this});};Kernel.prototype._websocket_closed=function(ws_url,early){this.stop_channels();$([IPython.events]).trigger('websocket_closed.Kernel',{ws_url:ws_url,kernel:this,early:early});};Kernel.prototype.start_channels=function(){var that=this;this.stop_channels();var ws_url=this.ws_url+this.kernel_url;console.log("Starting WebSockets:",ws_url);this.shell_channel=new this.WebSocket(ws_url+"/shell");this.iopub_channel=new this.WebSocket(ws_url+"/iopub");send_cookie=function(){this.send(document.cookie);};var already_called_onclose=false;var ws_closed_early=function(evt){if(already_called_onclose){return;}
already_called_onclose=true;if(!evt.wasClean){that._websocket_closed(ws_url,true);}};var ws_closed_late=function(evt){if(already_called_onclose){return;}
already_called_onclose=true;if(!evt.wasClean){that._websocket_closed(ws_url,false);}};this.shell_channel.onopen=send_cookie;this.shell_channel.onclose=ws_closed_early;this.iopub_channel.onopen=send_cookie;this.iopub_channel.onclose=ws_closed_early;setTimeout(function(){if(that.shell_channel!==null){that.shell_channel.onclose=ws_closed_late;}
if(that.iopub_channel!==null){that.iopub_channel.onclose=ws_closed_late;}},1000);};Kernel.prototype.stop_channels=function(){if(this.shell_channel!==null){this.shell_channel.onclose=function(evt){};this.shell_channel.close();this.shell_channel=null;};if(this.iopub_channel!==null){this.iopub_channel.onclose=function(evt){};this.iopub_channel.close();this.iopub_channel=null;};};Kernel.prototype.object_info_request=function(objname,callbacks){if(typeof(objname)!=null&&objname!=null)
{var content={oname:objname.toString(),};var msg=this._get_msg("object_info_request",content);this.shell_channel.send(JSON.stringify(msg));this.set_callbacks_for_msg(msg.header.msg_id,callbacks);return msg.header.msg_id;}
return;}
Kernel.prototype.execute=function(code,callbacks,options){var content={code:code,silent:true,user_variables:[],user_expressions:{},allow_stdin:false};$.extend(true,content,options)
$([IPython.events]).trigger('execution_request.Kernel',{kernel:this,content:content});var msg=this._get_msg("execute_request",content);this.shell_channel.send(JSON.stringify(msg));this.set_callbacks_for_msg(msg.header.msg_id,callbacks);return msg.header.msg_id;};Kernel.prototype.complete=function(line,cursor_pos,callbacks){callbacks=callbacks||{};var content={text:'',line:line,cursor_pos:cursor_pos};var msg=this._get_msg("complete_request",content);this.shell_channel.send(JSON.stringify(msg));this.set_callbacks_for_msg(msg.header.msg_id,callbacks);return msg.header.msg_id;};Kernel.prototype.interrupt=function(){if(this.running){$([IPython.events]).trigger('status_interrupting.Kernel',{kernel:this});$.post(this.kernel_url+"/interrupt");};};Kernel.prototype.kill=function(){if(this.running){this.running=false;var settings={cache:false,type:"DELETE"};$.ajax(this.kernel_url,settings);};};Kernel.prototype.get_callbacks_for_msg=function(msg_id){var callbacks=this._msg_callbacks[msg_id];return callbacks;};Kernel.prototype.set_callbacks_for_msg=function(msg_id,callbacks){this._msg_callbacks[msg_id]=callbacks||{};}
Kernel.prototype._handle_shell_reply=function(e){var reply=$.parseJSON(e.data);$([IPython.events]).trigger('shell_reply.Kernel',{kernel:this,reply:reply});var header=reply.header;var content=reply.content;var metadata=reply.metadata;var msg_type=header.msg_type;var callbacks=this.get_callbacks_for_msg(reply.parent_header.msg_id);if(callbacks!==undefined){var cb=callbacks[msg_type];if(cb!==undefined){cb(content,metadata);}};if(content.payload!==undefined){var payload=content.payload||[];this._handle_payload(callbacks,payload);}};Kernel.prototype._handle_payload=function(callbacks,payload){var l=payload.length;for(var i=0;i<l;i++){if(payload[i].source==='IPython.kernel.zmq.page.page'){var data={'text':payload[i].text}
$([IPython.events]).trigger('open_with_text.Pager',data);}else if(payload[i].source==='IPython.kernel.zmq.zmqshell.ZMQInteractiveShell.set_next_input'){if(callbacks.set_next_input!==undefined){callbacks.set_next_input(payload[i].text)}}};};Kernel.prototype._handle_iopub_reply=function(e){var reply=$.parseJSON(e.data);var content=reply.content;var msg_type=reply.header.msg_type;var metadata=reply.metadata;var callbacks=this.get_callbacks_for_msg(reply.parent_header.msg_id);if(msg_type!=='status'&&callbacks===undefined){return;}
var output_types=['stream','display_data','pyout','pyerr'];if(output_types.indexOf(msg_type)>=0){var cb=callbacks['output'];if(cb!==undefined){cb(msg_type,content,metadata);}}else if(msg_type==='status'){if(content.execution_state==='busy'){$([IPython.events]).trigger('status_busy.Kernel',{kernel:this});}else if(content.execution_state==='idle'){$([IPython.events]).trigger('status_idle.Kernel',{kernel:this});}else if(content.execution_state==='dead'){this.stop_channels();$([IPython.events]).trigger('status_dead.Kernel',{kernel:this});};}else if(msg_type==='clear_output'){var cb=callbacks['clear_output'];if(cb!==undefined){cb(content,metadata);}};};IPython.Kernel=Kernel;return IPython;}(IPython));var IPython=(function(IPython){var utils=IPython.utils;var SaveWidget=function(selector){this.selector=selector;if(this.selector!==undefined){this.element=$(selector);this.style();this.bind_events();}};SaveWidget.prototype.style=function(){this.element.find('span#save_widget').addClass('ui-widget');this.element.find('span#notebook_name').addClass('ui-widget');this.element.find('span#save_status').addClass('ui-widget').css({border:'none','margin-left':'20px'});};SaveWidget.prototype.bind_events=function(){var that=this;this.element.find('span#notebook_name').click(function(){that.rename_notebook();});this.element.find('span#notebook_name').hover(function(){$(this).addClass("ui-state-hover");},function(){$(this).removeClass("ui-state-hover");});$([IPython.events]).on('notebook_loaded.Notebook',function(){that.set_last_saved();that.update_notebook_name();that.update_document_title();});$([IPython.events]).on('notebook_saved.Notebook',function(){that.set_last_saved();that.update_notebook_name();that.update_document_title();});$([IPython.events]).on('notebook_save_failed.Notebook',function(){that.set_save_status('Last Save Failed!');});};SaveWidget.prototype.rename_notebook=function(){var that=this;var dialog=$('<div/>');dialog.append($('<h3/>').html('Enter a new notebook name:').css({'margin-bottom':'10px'}));dialog.append($('<input/>').attr('type','text').attr('size','25').addClass('ui-widget ui-widget-content').attr('value',IPython.notebook.get_notebook_name()));dialog.dialog({resizable:false,modal:true,title:"Rename Notebook",closeText:"",close:function(event,ui){$(this).dialog('destroy').remove();},buttons:{"OK":function(){var new_name=$(this).find('input').attr('value');if(!IPython.notebook.test_notebook_name(new_name)){$(this).find('h3').html("Invalid notebook name. Notebook names must "+"have 1 or more characters and can contain any characters "+"except :/\\. Please enter a new notebook name:");}else{IPython.notebook.set_notebook_name(new_name);IPython.notebook.save_notebook();$(this).dialog('close');}},"Cancel":function(){$(this).dialog('close');}},open:function(event,ui){var that=$(this);that.find('input[type="text"]').keydown(function(event,ui){if(event.which===utils.keycodes.ENTER){that.parent().find('button').first().click();}});}});}
SaveWidget.prototype.update_notebook_name=function(){var nbname=IPython.notebook.get_notebook_name();this.element.find('span#notebook_name').html(nbname);};SaveWidget.prototype.update_document_title=function(){var nbname=IPython.notebook.get_notebook_name();document.title=nbname;};SaveWidget.prototype.set_save_status=function(msg){this.element.find('span#save_status').html(msg);}
SaveWidget.prototype.set_last_saved=function(){var d=new Date();this.set_save_status('Last saved: '+d.format('mmm dd h:MM TT'));};IPython.SaveWidget=SaveWidget;return IPython;}(IPython));var IPython=(function(IPython){var QuickHelp=function(selector){};QuickHelp.prototype.show_keyboard_shortcuts=function(){var that=this;if(this.shortcut_dialog){this.shortcut_dialog.dialog("close");this.shortcut_dialog=null;return;}
var dialog=$('<div/>');this.shortcut_dialog=dialog;var shortcuts=[{key:'Shift-Enter',help:'run cell'},{key:'Ctrl-Enter',help:'run cell in-place'},{key:'Alt-Enter',help:'run cell, insert below'},{key:'Ctrl-m x',help:'cut cell'},{key:'Ctrl-m c',help:'copy cell'},{key:'Ctrl-m v',help:'paste cell'},{key:'Ctrl-m d',help:'delete cell'},{key:'Ctrl-m z',help:'undo last cell deletion'},{key:'Ctrl-m a',help:'insert cell above'},{key:'Ctrl-m b',help:'insert cell below'},{key:'Ctrl-m o',help:'toggle output'},{key:'Ctrl-m O',help:'toggle output scroll'},{key:'Ctrl-m l',help:'toggle line numbers'},{key:'Ctrl-m s',help:'save notebook'},{key:'Ctrl-m j',help:'move cell down'},{key:'Ctrl-m k',help:'move cell up'},{key:'Ctrl-m y',help:'code cell'},{key:'Ctrl-m m',help:'markdown cell'},{key:'Ctrl-m t',help:'raw cell'},{key:'Ctrl-m 1-6',help:'heading 1-6 cell'},{key:'Ctrl-m p',help:'select previous'},{key:'Ctrl-m n',help:'select next'},{key:'Ctrl-m i',help:'interrupt kernel'},{key:'Ctrl-m .',help:'restart kernel'},{key:'Ctrl-m h',help:'show keyboard shortcuts'}];for(var i=0;i<shortcuts.length;i++){dialog.append($('<div>').append($('<span/>').addClass('shortcut_key').html(shortcuts[i].key)).append($('<span/>').addClass('shortcut_descr').html(' : '+shortcuts[i].help)));};dialog.bind('dialogclose',function(event){that.shortcut_dialog=null;});dialog.dialog({title:'Keyboard shortcuts',closeText:''});};IPython.QuickHelp=QuickHelp;return IPython;}(IPython));var IPython=(function(IPython){var utils=IPython.utils;var Pager=function(pager_selector,pager_splitter_selector){this.pager_element=$(pager_selector);this.pager_button_area=$('#pager_button_area');var that=this;this.percentage_height=0.40;this.pager_splitter_element=$(pager_splitter_selector).draggable({containment:'window',axis:'y',helper:null,drag:function(event,ui){var pheight=($(body).height()-event.clientY-4);var downprct=pheight/IPython.layout_manager.app_height();downprct=Math.min(0.9,downprct);if(downprct<0.1){that.percentage_height=0.1;that.collapse({'duration':0});}else if(downprct>0.2){that.percentage_height=downprct;that.expand({'duration':0});}
IPython.layout_manager.do_resize();}});this.expanded=false;this.style();this.create_button_area();this.bind_events();};Pager.prototype.create_button_area=function(){var that=this;this.pager_button_area.append($('<a>').attr('role',"button").attr('title',"open the pager in an external window").addClass('ui-button').click(function(){that.detach()}).attr('style','position: absolute; right: 10px;').append($('<span>').addClass("ui-icon ui-icon-extlink")))};Pager.prototype.style=function(){this.pager_splitter_element.addClass('border-box-sizing ui-widget ui-state-default');this.pager_element.addClass('border-box-sizing ui-widget');this.pager_splitter_element.attr('title','Click to Show/Hide pager area, drag to Resize');};Pager.prototype.bind_events=function(){var that=this;this.pager_element.bind('collapse_pager',function(event,extrap){var time=(extrap!=undefined)?((extrap.duration!=undefined)?extrap.duration:'fast'):'fast';that.pager_element.hide(time);});this.pager_element.bind('expand_pager',function(event,extrap){var time=(extrap!=undefined)?((extrap.duration!=undefined)?extrap.duration:'fast'):'fast';that.pager_element.show(time);});this.pager_splitter_element.hover(function(){that.pager_splitter_element.addClass('ui-state-hover');},function(){that.pager_splitter_element.removeClass('ui-state-hover');});this.pager_splitter_element.click(function(){that.toggle();});$([IPython.events]).on('open_with_text.Pager',function(event,data){if(data.text.trim()!==''){that.clear();that.expand();that.append_text(data.text);};});};Pager.prototype.collapse=function(extrap){if(this.expanded===true){this.expanded=false;this.pager_element.add($('div#notebook')).trigger('collapse_pager',extrap);};};Pager.prototype.expand=function(extrap){if(this.expanded!==true){this.expanded=true;this.pager_element.add($('div#notebook')).trigger('expand_pager',extrap);};};Pager.prototype.toggle=function(){if(this.expanded===true){this.collapse();}else{this.expand();};};Pager.prototype.clear=function(text){this.pager_element.empty();};Pager.prototype.detach=function(){var w=window.open("","_blank")
$(w.document.head).append($('<link>').attr('rel',"stylesheet").attr('href',"/static/css/notebook.css").attr('type',"text/css")).append($('<title>').text("IPython Pager"));var pager_body=$(w.document.body)
pager_body.attr('style','overflow:scroll');pager_body.append(this.pager_element.children())
w.document.close();this.collapse();}
Pager.prototype.append_text=function(text){this.pager_element.append($('<pre/>').html(utils.fixCarriageReturn(utils.fixConsole(text))));};IPython.Pager=Pager;return IPython;}(IPython));var IPython=(function(IPython){var MenuBar=function(selector,options){var options=options||{};if(options.baseProjectUrl!=undefined){this._baseProjectUrl=options.baseProjectUrl;}
this.selector=selector;if(this.selector!==undefined){this.element=$(selector);this.style();this.bind_events();}};MenuBar.prototype.baseProjectUrl=function(){return this._baseProjectUrl||$('body').data('baseProjectUrl');};MenuBar.prototype.style=function(){this.element.addClass('border-box-sizing');$('ul#menus').menubar({select:function(event,ui){var i=IPython.notebook.get_selected_index();IPython.notebook.select(i);}});};MenuBar.prototype.bind_events=function(){var that=this;this.element.find('#new_notebook').click(function(){window.open(that.baseProjectUrl()+'new');});this.element.find('#open_notebook').click(function(){window.open(that.baseProjectUrl());});this.element.find('#rename_notebook').click(function(){IPython.save_widget.rename_notebook();});this.element.find('#copy_notebook').click(function(){var notebook_id=IPython.notebook.get_notebook_id();var url=that.baseProjectUrl()+notebook_id+'/copy';window.open(url,'_blank');return false;});this.element.find('#save_notebook').click(function(){IPython.notebook.save_notebook();});this.element.find('#download_ipynb').click(function(){var notebook_id=IPython.notebook.get_notebook_id();var url=that.baseProjectUrl()+'notebooks/'+
notebook_id+'?format=json';window.location.assign(url);});this.element.find('#download_py').click(function(){var notebook_id=IPython.notebook.get_notebook_id();var url=that.baseProjectUrl()+'notebooks/'+
notebook_id+'?format=py';window.location.assign(url);});this.element.find('button#print_notebook').click(function(){IPython.print_widget.print_notebook();});this.element.find('#kill_and_exit').click(function(){IPython.notebook.kernel.kill();setTimeout(function(){window.close();},200);});this.element.find('#cut_cell').click(function(){IPython.notebook.cut_cell();});this.element.find('#copy_cell').click(function(){IPython.notebook.copy_cell();});this.element.find('#delete_cell').click(function(){IPython.notebook.delete_cell();});this.element.find('#undelete_cell').click(function(){IPython.notebook.undelete();});this.element.find('#split_cell').click(function(){IPython.notebook.split_cell();});this.element.find('#merge_cell_above').click(function(){IPython.notebook.merge_cell_above();});this.element.find('#merge_cell_below').click(function(){IPython.notebook.merge_cell_below();});this.element.find('#move_cell_up').click(function(){IPython.notebook.move_cell_up();});this.element.find('#move_cell_down').click(function(){IPython.notebook.move_cell_down();});this.element.find('#select_previous').click(function(){IPython.notebook.select_prev();});this.element.find('#select_next').click(function(){IPython.notebook.select_next();});this.element.find('#toggle_header').click(function(){$('div#header').toggle();IPython.layout_manager.do_resize();});this.element.find('#toggle_toolbar').click(function(){IPython.toolbar.toggle();});this.element.find('#insert_cell_above').click(function(){IPython.notebook.insert_cell_above('code');});this.element.find('#insert_cell_below').click(function(){IPython.notebook.insert_cell_below('code');});this.element.find('#run_cell').click(function(){IPython.notebook.execute_selected_cell();});this.element.find('#run_cell_in_place').click(function(){IPython.notebook.execute_selected_cell({terminal:true});});this.element.find('#run_all_cells').click(function(){IPython.notebook.execute_all_cells();}).attr('title','Run all cells in the notebook');this.element.find('#run_all_cells_above').click(function(){IPython.notebook.execute_cells_above();}).attr('title','Run all cells above (but not including) this cell');this.element.find('#run_all_cells_below').click(function(){IPython.notebook.execute_cells_below();}).attr('title','Run this cell and all cells below it');this.element.find('#to_code').click(function(){IPython.notebook.to_code();});this.element.find('#to_markdown').click(function(){IPython.notebook.to_markdown();});this.element.find('#to_raw').click(function(){IPython.notebook.to_raw();});this.element.find('#to_heading1').click(function(){IPython.notebook.to_heading(undefined,1);});this.element.find('#to_heading2').click(function(){IPython.notebook.to_heading(undefined,2);});this.element.find('#to_heading3').click(function(){IPython.notebook.to_heading(undefined,3);});this.element.find('#to_heading4').click(function(){IPython.notebook.to_heading(undefined,4);});this.element.find('#to_heading5').click(function(){IPython.notebook.to_heading(undefined,5);});this.element.find('#to_heading6').click(function(){IPython.notebook.to_heading(undefined,6);});this.element.find('#toggle_output').click(function(){IPython.notebook.toggle_output();});this.element.find('#collapse_all_output').click(function(){IPython.notebook.collapse_all_output();});this.element.find('#scroll_all_output').click(function(){IPython.notebook.scroll_all_output();});this.element.find('#expand_all_output').click(function(){IPython.notebook.expand_all_output();});this.element.find('#clear_all_output').click(function(){IPython.notebook.clear_all_output();});this.element.find('#int_kernel').click(function(){IPython.notebook.kernel.interrupt();});this.element.find('#restart_kernel').click(function(){IPython.notebook.restart_kernel();});this.element.find('#keyboard_shortcuts').click(function(){IPython.quick_help.show_keyboard_shortcuts();});};IPython.MenuBar=MenuBar;return IPython;}(IPython));var IPython=(function(IPython){var ToolBar=function(selector){this.selector=selector;if(this.selector!==undefined){this.element=$(selector);this.style();}};ToolBar.prototype.add_buttons_group=function(list,group_id){var span_group=$('<span/>');if(group_id!=undefined){span_group.attr('id',group_id);}
for(var el in list){var button=$('<button/>').button({icons:{primary:list[el].icon},text:false,label:list[el].label});var id=list[el].id;if(id!=undefined)
button.attr('id',id);var fun=list[el].callback;button.click(fun);span_group.append(button);}
span_group.buttonset();$(this.selector).append(span_group);};ToolBar.prototype.style=function(){this.element.addClass('border-box-sizing').addClass('toolbar').css('border-top-style','none').css('border-left-style','none').css('border-right-style','none');};ToolBar.prototype.toggle=function(){this.element.toggle();if(IPython.layout_manager!=undefined){IPython.layout_manager.do_resize();}};IPython.ToolBar=ToolBar;return IPython;}(IPython));var IPython=(function(IPython){var MainToolBar=function(selector){IPython.ToolBar.apply(this,arguments);this.construct();this.add_celltype_list();this.add_celltoolbar_list();this.bind_events();};MainToolBar.prototype=new IPython.ToolBar();MainToolBar.prototype.construct=function(){this.add_buttons_group([{id:'save_b',label:'Save',icon:'ui-icon-disk',callback:function(){IPython.notebook.save_notebook();}}]);this.add_buttons_group([{id:'cut_b',label:'Cut Cell',icon:'ui-icon-scissors',callback:function(){IPython.notebook.cut_cell();}},{id:'copy_b',label:'Copy Cell',icon:'ui-icon-copy',callback:function(){IPython.notebook.copy_cell();}},{id:'paste_b',label:'Paste Cell Below',icon:'ui-icon-clipboard',callback:function(){IPython.notebook.paste_cell_below();}}],'cut_copy_paste');this.add_buttons_group([{id:'move_up_b',label:'Move Cell Up',icon:'ui-icon-arrowthick-1-n',callback:function(){IPython.notebook.move_cell_up();}},{id:'move_down_b',label:'Move Cell Down',icon:'ui-icon-arrowthick-1-s',callback:function(){IPython.notebook.move_cell_down();}}],'move_up_down');this.add_buttons_group([{id:'insert_above_b',label:'Insert Cell Above',icon:'ui-icon-arrowthickstop-1-n',callback:function(){IPython.notebook.insert_cell_above('code');}},{id:'insert_below_b',label:'Insert Cell Below',icon:'ui-icon-arrowthickstop-1-s',callback:function(){IPython.notebook.insert_cell_below('code');}}],'insert_above_below');this.add_buttons_group([{id:'run_b',label:'Run Cell',icon:'ui-icon-play',callback:function(){IPython.notebook.execute_selected_cell();}},{id:'interrupt_b',label:'Interrupt',icon:'ui-icon-stop',callback:function(){IPython.notebook.kernel.interrupt();}}],'run_int');};MainToolBar.prototype.add_celltype_list=function(){this.element.append($('<select/>').attr('id','cell_type').addClass('ui-widget-content').append($('<option/>').attr('value','code').text('Code')).append($('<option/>').attr('value','markdown').text('Markdown')).append($('<option/>').attr('value','raw').text('Raw Text')).append($('<option/>').attr('value','heading1').text('Heading 1')).append($('<option/>').attr('value','heading2').text('Heading 2')).append($('<option/>').attr('value','heading3').text('Heading 3')).append($('<option/>').attr('value','heading4').text('Heading 4')).append($('<option/>').attr('value','heading5').text('Heading 5')).append($('<option/>').attr('value','heading6').text('Heading 6')));};MainToolBar.prototype.add_celltoolbar_list=function(){var label=$('<label/>').text('Cell Toolbar:');var select=$('<select/>').addClass('ui-widget-content').attr('id','ctb_select').append($('<option/>').attr('value','').text('None'));this.element.append(label).append(select);select.change(function(){var val=$(this).val()
if(val==''){IPython.CellToolbar.global_hide();}else{IPython.CellToolbar.global_show();IPython.CellToolbar.activate_preset(val);}});var presets=IPython.CellToolbar.list_presets();for(var i=0;i<presets.length;i++){var name=presets[i];select.append($('<option/>').attr('value',name).text(name));}
$([IPython.events]).on('preset_added.CellToolbar',function(event,data){var name=data.name;select.append($('<option/>').attr('value',name).text(name));});};MainToolBar.prototype.bind_events=function(){var that=this;this.element.find('#cell_type').change(function(){var cell_type=$(this).val();if(cell_type==='code'){IPython.notebook.to_code();}else if(cell_type==='markdown'){IPython.notebook.to_markdown();}else if(cell_type==='raw'){IPython.notebook.to_raw();}else if(cell_type==='heading1'){IPython.notebook.to_heading(undefined,1);}else if(cell_type==='heading2'){IPython.notebook.to_heading(undefined,2);}else if(cell_type==='heading3'){IPython.notebook.to_heading(undefined,3);}else if(cell_type==='heading4'){IPython.notebook.to_heading(undefined,4);}else if(cell_type==='heading5'){IPython.notebook.to_heading(undefined,5);}else if(cell_type==='heading6'){IPython.notebook.to_heading(undefined,6);}});$([IPython.events]).on('selected_cell_type_changed.Notebook',function(event,data){if(data.cell_type==='heading'){that.element.find('#cell_type').val(data.cell_type+data.level);}else{that.element.find('#cell_type').val(data.cell_type);}});};IPython.MainToolBar=MainToolBar;return IPython;}(IPython));var IPython=(function(IPython){var utils=IPython.utils;var key=IPython.utils.keycodes;var Notebook=function(selector,options){var options=options||{};this._baseProjectUrl=options.baseProjectUrl;this.read_only=options.read_only||IPython.read_only;this.element=$(selector);this.element.scroll();this.element.data("notebook",this);this.next_prompt_number=1;this.kernel=null;this.clipboard=null;this.undelete_backup=null;this.undelete_index=null;this.undelete_below=false;this.paste_enabled=false;this.dirty=false;this.metadata={};this.worksheet_metadata={};this.control_key_active=false;this.notebook_id=null;this.notebook_name=null;this.notebook_name_blacklist_re=/[\/\\:]/;this.nbformat=3
this.nbformat_minor=0
this.style();this.create_elements();this.bind_events();};Notebook.prototype.style=function(){$('div#notebook').addClass('border-box-sizing');};Notebook.prototype.baseProjectUrl=function(){return this._baseProjectUrl||$('body').data('baseProjectUrl');};Notebook.prototype.create_elements=function(){var that=this;var end_space=$('<div/>').addClass('end_space').height("30%");end_space.dblclick(function(e){if(that.read_only)return;var ncells=that.ncells();that.insert_cell_below('code',ncells-1);});this.element.append(end_space);$('div#notebook').addClass('border-box-sizing');};Notebook.prototype.bind_events=function(){var that=this;$([IPython.events]).on('set_next_input.Notebook',function(event,data){var index=that.find_cell_index(data.cell);var new_cell=that.insert_cell_below('code',index);new_cell.set_text(data.text);that.dirty=true;});$([IPython.events]).on('set_dirty.Notebook',function(event,data){that.dirty=data.value;});$([IPython.events]).on('select.Cell',function(event,data){var index=that.find_cell_index(data.cell);that.select(index);});$(document).keydown(function(event){if(that.read_only)return true;if((event.ctrlKey||event.metaKey)&&event.keyCode==83){that.save_notebook();event.preventDefault();return false;}else if(event.which===key.ESC){event.preventDefault();}else if(event.which===key.SHIFT){return true;}
if(event.which===key.UPARROW&&!event.shiftKey){var cell=that.get_selected_cell();if(cell.at_top()){event.preventDefault();that.select_prev();};}else if(event.which===key.DOWNARROW&&!event.shiftKey){var cell=that.get_selected_cell();if(cell.at_bottom()){event.preventDefault();that.select_next();};}else if(event.which===key.ENTER&&event.shiftKey){that.execute_selected_cell();return false;}else if(event.which===key.ENTER&&event.altKey){that.execute_selected_cell();if(/\S/.test(that.get_selected_cell().get_text())==true){that.insert_cell_above('code');}
return false;}else if(event.which===key.ENTER&&event.ctrlKey){that.execute_selected_cell({terminal:true});return false;}else if(event.which===77&&event.ctrlKey&&that.control_key_active==false){that.control_key_active=true;return false;}else if(event.which===88&&that.control_key_active){that.cut_cell();that.control_key_active=false;return false;}else if(event.which===67&&that.control_key_active){that.copy_cell();that.control_key_active=false;return false;}else if(event.which===86&&that.control_key_active){that.paste_cell_below();that.control_key_active=false;return false;}else if(event.which===68&&that.control_key_active){that.delete_cell();that.control_key_active=false;return false;}else if(event.which===65&&that.control_key_active){that.insert_cell_above('code');that.control_key_active=false;return false;}else if(event.which===66&&that.control_key_active){that.insert_cell_below('code');that.control_key_active=false;return false;}else if(event.which===89&&that.control_key_active){that.to_code();that.control_key_active=false;return false;}else if(event.which===77&&that.control_key_active){that.to_markdown();that.control_key_active=false;return false;}else if(event.which===84&&that.control_key_active){that.to_raw();that.control_key_active=false;return false;}else if(event.which===49&&that.control_key_active){that.to_heading(undefined,1);that.control_key_active=false;return false;}else if(event.which===50&&that.control_key_active){that.to_heading(undefined,2);that.control_key_active=false;return false;}else if(event.which===51&&that.control_key_active){that.to_heading(undefined,3);that.control_key_active=false;return false;}else if(event.which===52&&that.control_key_active){that.to_heading(undefined,4);that.control_key_active=false;return false;}else if(event.which===53&&that.control_key_active){that.to_heading(undefined,5);that.control_key_active=false;return false;}else if(event.which===54&&that.control_key_active){that.to_heading(undefined,6);that.control_key_active=false;return false;}else if(event.which===79&&that.control_key_active){if(event.shiftKey){that.toggle_output_scroll();}else{that.toggle_output();}
that.control_key_active=false;return false;}else if(event.which===83&&that.control_key_active){that.save_notebook();that.control_key_active=false;return false;}else if(event.which===74&&that.control_key_active){that.move_cell_down();that.control_key_active=false;return false;}else if(event.which===75&&that.control_key_active){that.move_cell_up();that.control_key_active=false;return false;}else if(event.which===80&&that.control_key_active){that.select_prev();that.control_key_active=false;return false;}else if(event.which===78&&that.control_key_active){that.select_next();that.control_key_active=false;return false;}else if(event.which===76&&that.control_key_active){that.cell_toggle_line_numbers();that.control_key_active=false;return false;}else if(event.which===73&&that.control_key_active){that.kernel.interrupt();that.control_key_active=false;return false;}else if(event.which===190&&that.control_key_active){that.restart_kernel();that.control_key_active=false;return false;}else if(event.which===72&&that.control_key_active){IPython.quick_help.show_keyboard_shortcuts();that.control_key_active=false;return false;}else if(event.which===90&&that.control_key_active){that.undelete();that.control_key_active=false;return false;}else if(that.control_key_active){that.control_key_active=false;return true;};return true;});var collapse_time=function(time){var app_height=$('#ipython-main-app').height();var splitter_height=$('div#pager_splitter').outerHeight(true);var new_height=app_height-splitter_height;that.element.animate({height:new_height+'px'},time);}
this.element.bind('collapse_pager',function(event,extrap){var time=(extrap!=undefined)?((extrap.duration!=undefined)?extrap.duration:'fast'):'fast';collapse_time(time);});var expand_time=function(time){var app_height=$('#ipython-main-app').height();var splitter_height=$('div#pager_splitter').outerHeight(true);var pager_height=$('div#pager').outerHeight(true);var new_height=app_height-pager_height-splitter_height;that.element.animate({height:new_height+'px'},time);}
this.element.bind('expand_pager',function(event,extrap){var time=(extrap!=undefined)?((extrap.duration!=undefined)?extrap.duration:'fast'):'fast';expand_time(time);});$(window).bind('beforeunload',function(){var kill_kernel=false;if(kill_kernel){that.kernel.kill();}
if(that.dirty&&!that.read_only){return"You have unsaved changes that will be lost if you leave this page.";};return null;});};Notebook.prototype.scroll_to_cell=function(cell_number,time){var cells=this.get_cells();var time=time||0;cell_number=Math.min(cells.length-1,cell_number);cell_number=Math.max(0,cell_number);var scroll_value=cells[cell_number].element.position().top-cells[0].element.position().top;this.element.animate({scrollTop:scroll_value},time);return scroll_value;};Notebook.prototype.scroll_to_bottom=function(){this.element.animate({scrollTop:this.element.get(0).scrollHeight},0);};Notebook.prototype.scroll_to_top=function(){this.element.animate({scrollTop:0},0);};Notebook.prototype.get_cell_elements=function(){return this.element.children("div.cell");};Notebook.prototype.get_cell_element=function(index){var result=null;var e=this.get_cell_elements().eq(index);if(e.length!==0){result=e;}
return result;};Notebook.prototype.ncells=function(cell){return this.get_cell_elements().length;};Notebook.prototype.get_cells=function(){return this.get_cell_elements().toArray().map(function(e){return $(e).data("cell");});};Notebook.prototype.get_cell=function(index){var result=null;var ce=this.get_cell_element(index);if(ce!==null){result=ce.data('cell');}
return result;}
Notebook.prototype.get_next_cell=function(cell){var result=null;var index=this.find_cell_index(cell);if(this.is_valid_cell_index(index+1)){result=this.get_cell(index+1);}
return result;}
Notebook.prototype.get_prev_cell=function(cell){var result=null;var index=this.find_cell_index(cell);if(index!==null&&index>1){result=this.get_cell(index-1);}
return result;}
Notebook.prototype.find_cell_index=function(cell){var result=null;this.get_cell_elements().filter(function(index){if($(this).data("cell")===cell){result=index;};});return result;};Notebook.prototype.index_or_selected=function(index){var i;if(index===undefined||index===null){i=this.get_selected_index();if(i===null){i=0;}}else{i=index;}
return i;};Notebook.prototype.get_selected_cell=function(){var index=this.get_selected_index();return this.get_cell(index);};Notebook.prototype.is_valid_cell_index=function(index){if(index!==null&&index>=0&&index<this.ncells()){return true;}else{return false;};}
Notebook.prototype.get_selected_index=function(){var result=null;this.get_cell_elements().filter(function(index){if($(this).data("cell").selected===true){result=index;};});return result;};Notebook.prototype.select=function(index){if(this.is_valid_cell_index(index)){var sindex=this.get_selected_index()
if(sindex!==null&&index!==sindex){this.get_cell(sindex).unselect();};var cell=this.get_cell(index);cell.select();if(cell.cell_type==='heading'){$([IPython.events]).trigger('selected_cell_type_changed.Notebook',{'cell_type':cell.cell_type,level:cell.level});}else{$([IPython.events]).trigger('selected_cell_type_changed.Notebook',{'cell_type':cell.cell_type});};};return this;};Notebook.prototype.select_next=function(){var index=this.get_selected_index();this.select(index+1);return this;};Notebook.prototype.select_prev=function(){var index=this.get_selected_index();this.select(index-1);return this;};Notebook.prototype.move_cell_up=function(index){var i=this.index_or_selected(index);if(this.is_valid_cell_index(i)&&i>0){var pivot=this.get_cell_element(i-1);var tomove=this.get_cell_element(i);if(pivot!==null&&tomove!==null){tomove.detach();pivot.before(tomove);this.select(i-1);};this.dirty=true;};return this;};Notebook.prototype.move_cell_down=function(index){var i=this.index_or_selected(index);if(this.is_valid_cell_index(i)&&this.is_valid_cell_index(i+1)){var pivot=this.get_cell_element(i+1);var tomove=this.get_cell_element(i);if(pivot!==null&&tomove!==null){tomove.detach();pivot.after(tomove);this.select(i+1);};};this.dirty=true;return this;};Notebook.prototype.delete_cell=function(index){var i=this.index_or_selected(index);var cell=this.get_selected_cell();this.undelete_backup=cell.toJSON();$('#undelete_cell').removeClass('ui-state-disabled');if(this.is_valid_cell_index(i)){var ce=this.get_cell_element(i);ce.remove();if(i===(this.ncells())){this.select(i-1);this.undelete_index=i-1;this.undelete_below=true;}else{this.select(i);this.undelete_index=i;this.undelete_below=false;};this.dirty=true;};return this;};Notebook.prototype.insert_cell_at_index=function(type,index){var ncells=this.ncells();var index=Math.min(index,ncells);index=Math.max(index,0);var cell=null;if(ncells===0||this.is_valid_cell_index(index)||index===ncells){if(type==='code'){cell=new IPython.CodeCell(this.kernel);cell.set_input_prompt();}else if(type==='markdown'){cell=new IPython.MarkdownCell();}else if(type==='html'){cell=new IPython.HTMLCell();}else if(type==='raw'){cell=new IPython.RawCell();}else if(type==='heading'){cell=new IPython.HeadingCell();}
if(this._insert_element_at_index(cell.element,index)){cell.render();this.select(this.find_cell_index(cell));this.dirty=true;}}
return cell;};Notebook.prototype._insert_element_at_index=function(element,index){if(element===undefined){return false;}
var ncells=this.ncells();if(ncells===0){this.element.find('div.end_space').before(element);}else if(ncells===index){this.get_cell_element(index-1).after(element);}else if(this.is_valid_cell_index(index)){this.get_cell_element(index).before(element);}else{return false;}
if(this.undelete_index!==null&&index<=this.undelete_index){this.undelete_index=this.undelete_index+1;this.dirty=true;}
return true;};Notebook.prototype.insert_cell_above=function(type,index){index=this.index_or_selected(index);return this.insert_cell_at_index(type,index);};Notebook.prototype.insert_cell_below=function(type,index){index=this.index_or_selected(index);return this.insert_cell_at_index(type,index+1);};Notebook.prototype.insert_cell_at_bottom=function(type){var len=this.ncells();return this.insert_cell_below(type,len-1);};Notebook.prototype.to_code=function(index){var i=this.index_or_selected(index);if(this.is_valid_cell_index(i)){var source_element=this.get_cell_element(i);var source_cell=source_element.data("cell");if(!(source_cell instanceof IPython.CodeCell)){var target_cell=this.insert_cell_below('code',i);var text=source_cell.get_text();if(text===source_cell.placeholder){text='';}
target_cell.set_text(text);target_cell.code_mirror.clearHistory();source_element.remove();this.dirty=true;};};};Notebook.prototype.to_markdown=function(index){var i=this.index_or_selected(index);if(this.is_valid_cell_index(i)){var source_element=this.get_cell_element(i);var source_cell=source_element.data("cell");if(!(source_cell instanceof IPython.MarkdownCell)){var target_cell=this.insert_cell_below('markdown',i);var text=source_cell.get_text();if(text===source_cell.placeholder){text='';};target_cell.edit();target_cell.set_text(text);target_cell.code_mirror.clearHistory();source_element.remove();this.dirty=true;};};};Notebook.prototype.to_html=function(index){var i=this.index_or_selected(index);if(this.is_valid_cell_index(i)){var source_element=this.get_cell_element(i);var source_cell=source_element.data("cell");var target_cell=null;if(!(source_cell instanceof IPython.HTMLCell)){target_cell=this.insert_cell_below('html',i);var text=source_cell.get_text();if(text===source_cell.placeholder){text='';};target_cell.edit();target_cell.set_text(text);target_cell.code_mirror.clearHistory();source_element.remove();this.dirty=true;};};};Notebook.prototype.to_raw=function(index){var i=this.index_or_selected(index);if(this.is_valid_cell_index(i)){var source_element=this.get_cell_element(i);var source_cell=source_element.data("cell");var target_cell=null;if(!(source_cell instanceof IPython.RawCell)){target_cell=this.insert_cell_below('raw',i);var text=source_cell.get_text();if(text===source_cell.placeholder){text='';};target_cell.edit();target_cell.set_text(text);target_cell.code_mirror.clearHistory();source_element.remove();this.dirty=true;};};};Notebook.prototype.to_heading=function(index,level){level=level||1;var i=this.index_or_selected(index);if(this.is_valid_cell_index(i)){var source_element=this.get_cell_element(i);var source_cell=source_element.data("cell");var target_cell=null;if(source_cell instanceof IPython.HeadingCell){source_cell.set_level(level);}else{target_cell=this.insert_cell_below('heading',i);var text=source_cell.get_text();if(text===source_cell.placeholder){text='';};target_cell.set_level(level);target_cell.edit();target_cell.set_text(text);target_cell.code_mirror.clearHistory();source_element.remove();this.dirty=true;};$([IPython.events]).trigger('selected_cell_type_changed.Notebook',{'cell_type':'heading',level:level});};};Notebook.prototype.enable_paste=function(){var that=this;if(!this.paste_enabled){$('#paste_cell_replace').removeClass('ui-state-disabled').on('click',function(){that.paste_cell_replace();});$('#paste_cell_above').removeClass('ui-state-disabled').on('click',function(){that.paste_cell_above();});$('#paste_cell_below').removeClass('ui-state-disabled').on('click',function(){that.paste_cell_below();});this.paste_enabled=true;};};Notebook.prototype.disable_paste=function(){if(this.paste_enabled){$('#paste_cell_replace').addClass('ui-state-disabled').off('click');$('#paste_cell_above').addClass('ui-state-disabled').off('click');$('#paste_cell_below').addClass('ui-state-disabled').off('click');this.paste_enabled=false;};};Notebook.prototype.cut_cell=function(){this.copy_cell();this.delete_cell();}
Notebook.prototype.copy_cell=function(){var cell=this.get_selected_cell();this.clipboard=cell.toJSON();this.enable_paste();};Notebook.prototype.paste_cell_replace=function(){if(this.clipboard!==null&&this.paste_enabled){var cell_data=this.clipboard;var new_cell=this.insert_cell_above(cell_data.cell_type);new_cell.fromJSON(cell_data);var old_cell=this.get_next_cell(new_cell);this.delete_cell(this.find_cell_index(old_cell));this.select(this.find_cell_index(new_cell));};};Notebook.prototype.paste_cell_above=function(){if(this.clipboard!==null&&this.paste_enabled){var cell_data=this.clipboard;var new_cell=this.insert_cell_above(cell_data.cell_type);new_cell.fromJSON(cell_data);};};Notebook.prototype.paste_cell_below=function(){if(this.clipboard!==null&&this.paste_enabled){var cell_data=this.clipboard;var new_cell=this.insert_cell_below(cell_data.cell_type);new_cell.fromJSON(cell_data);};};Notebook.prototype.undelete=function(){if(this.undelete_backup!==null&&this.undelete_index!==null){var current_index=this.get_selected_index();if(this.undelete_index<current_index){current_index=current_index+1;}
if(this.undelete_index>=this.ncells()){this.select(this.ncells()-1);}
else{this.select(this.undelete_index);}
var cell_data=this.undelete_backup;var new_cell=null;if(this.undelete_below){new_cell=this.insert_cell_below(cell_data.cell_type);}else{new_cell=this.insert_cell_above(cell_data.cell_type);}
new_cell.fromJSON(cell_data);this.select(current_index);this.undelete_backup=null;this.undelete_index=null;}
$('#undelete_cell').addClass('ui-state-disabled');}
Notebook.prototype.split_cell=function(){var cell=this.get_selected_cell();if(cell.is_splittable()){var texta=cell.get_pre_cursor();var textb=cell.get_post_cursor();if(cell instanceof IPython.CodeCell){cell.set_text(texta);var new_cell=this.insert_cell_below('code');new_cell.set_text(textb);}else if(cell instanceof IPython.MarkdownCell){cell.set_text(texta);cell.render();var new_cell=this.insert_cell_below('markdown');new_cell.edit();new_cell.set_text(textb);new_cell.render();}else if(cell instanceof IPython.HTMLCell){cell.set_text(texta);cell.render();var new_cell=this.insert_cell_below('html');new_cell.edit();new_cell.set_text(textb);new_cell.render();};};};Notebook.prototype.merge_cell_above=function(){var index=this.get_selected_index();var cell=this.get_cell(index);if(index>0){var upper_cell=this.get_cell(index-1);var upper_text=upper_cell.get_text();var text=cell.get_text();if(cell instanceof IPython.CodeCell){cell.set_text(upper_text+'\n'+text);}else if(cell instanceof IPython.MarkdownCell||cell instanceof IPython.HTMLCell){cell.edit();cell.set_text(upper_text+'\n'+text);cell.render();};this.delete_cell(index-1);this.select(this.find_cell_index(cell));};};Notebook.prototype.merge_cell_below=function(){var index=this.get_selected_index();var cell=this.get_cell(index);if(index<this.ncells()-1){var lower_cell=this.get_cell(index+1);var lower_text=lower_cell.get_text();var text=cell.get_text();if(cell instanceof IPython.CodeCell){cell.set_text(text+'\n'+lower_text);}else if(cell instanceof IPython.MarkdownCell||cell instanceof IPython.HTMLCell){cell.edit();cell.set_text(text+'\n'+lower_text);cell.render();};this.delete_cell(index+1);this.select(this.find_cell_index(cell));};};Notebook.prototype.collapse=function(index){var i=this.index_or_selected(index);this.get_cell(i).collapse();this.dirty=true;};Notebook.prototype.expand=function(index){var i=this.index_or_selected(index);this.get_cell(i).expand();this.dirty=true;};Notebook.prototype.toggle_output=function(index){var i=this.index_or_selected(index);this.get_cell(i).toggle_output();this.dirty=true;};Notebook.prototype.toggle_output_scroll=function(index){var i=this.index_or_selected(index);this.get_cell(i).toggle_output_scroll();};Notebook.prototype.collapse_all_output=function(){var ncells=this.ncells();var cells=this.get_cells();for(var i=0;i<ncells;i++){if(cells[i]instanceof IPython.CodeCell){cells[i].output_area.collapse();}};this.dirty=true;};Notebook.prototype.scroll_all_output=function(){var ncells=this.ncells();var cells=this.get_cells();for(var i=0;i<ncells;i++){if(cells[i]instanceof IPython.CodeCell){cells[i].output_area.expand();cells[i].output_area.scroll_if_long(20);}};this.dirty=true;};Notebook.prototype.expand_all_output=function(){var ncells=this.ncells();var cells=this.get_cells();for(var i=0;i<ncells;i++){if(cells[i]instanceof IPython.CodeCell){cells[i].output_area.expand();cells[i].output_area.unscroll_area();}};this.dirty=true;};Notebook.prototype.clear_all_output=function(){var ncells=this.ncells();var cells=this.get_cells();for(var i=0;i<ncells;i++){if(cells[i]instanceof IPython.CodeCell){cells[i].clear_output(true,true,true);cells[i].set_input_prompt();}};this.dirty=true;};Notebook.prototype.cell_toggle_line_numbers=function(){this.get_selected_cell().toggle_line_numbers();};Notebook.prototype.start_kernel=function(){var base_url=$('body').data('baseKernelUrl')+"kernels";this.kernel=new IPython.Kernel(base_url);this.kernel.start(this.notebook_id);var ncells=this.ncells();for(var i=0;i<ncells;i++){var cell=this.get_cell(i);if(cell instanceof IPython.CodeCell){cell.set_kernel(this.kernel)};};};Notebook.prototype.restart_kernel=function(){var that=this;var dialog=$('<div/>');dialog.html('Do you want to restart the current kernel?  You will lose all variables defined in it.');$(document).append(dialog);dialog.dialog({resizable:false,modal:true,title:"Restart kernel or continue running?",closeText:'',buttons:{"Restart":function(){that.kernel.restart();$(this).dialog('close');},"Continue running":function(){$(this).dialog('close');}}});};Notebook.prototype.execute_selected_cell=function(options){var default_options={terminal:false,add_new:true};$.extend(default_options,options);var that=this;var cell=that.get_selected_cell();var cell_index=that.find_cell_index(cell);if(cell instanceof IPython.CodeCell){cell.execute();}else if(cell instanceof IPython.HTMLCell){cell.render();}
if(default_options.terminal){cell.select_all();}else{if((cell_index===(that.ncells()-1))&&default_options.add_new){that.insert_cell_below('code');that.scroll_to_bottom();}else{that.select(cell_index+1);};};this.dirty=true;};Notebook.prototype.execute_cells_below=function(){this.execute_cell_range(this.get_selected_index(),this.ncells());this.scroll_to_bottom();};Notebook.prototype.execute_cells_above=function(){this.execute_cell_range(0,this.get_selected_index());};Notebook.prototype.execute_all_cells=function(){this.execute_cell_range(0,this.ncells());this.scroll_to_bottom();};Notebook.prototype.execute_cell_range=function(start,end){for(var i=start;i<end;i++){this.select(i);this.execute_selected_cell({add_new:false});};};Notebook.prototype.get_notebook_id=function(){return this.notebook_id;};Notebook.prototype.get_notebook_name=function(){return this.notebook_name;};Notebook.prototype.set_notebook_name=function(name){this.notebook_name=name;};Notebook.prototype.test_notebook_name=function(nbname){nbname=nbname||'';if(this.notebook_name_blacklist_re.test(nbname)==false&&nbname.length>0){return true;}else{return false;};};Notebook.prototype.fromJSON=function(data){var ncells=this.ncells();var i;for(i=0;i<ncells;i++){this.delete_cell(0);};this.metadata=data.metadata;this.notebook_name=data.metadata.name;var worksheet=data.worksheets[0];if(worksheet!==undefined){if(worksheet.metadata){this.worksheet_metadata=worksheet.metadata;}
var new_cells=worksheet.cells;ncells=new_cells.length;var cell_data=null;var new_cell=null;for(i=0;i<ncells;i++){cell_data=new_cells[i];if(cell_data.cell_type==='plaintext'){cell_data.cell_type='raw';}
new_cell=this.insert_cell_below(cell_data.cell_type);new_cell.fromJSON(cell_data);};};if(data.worksheets.length>1){var dialog=$('<div/>');dialog.html("This notebook has "+data.worksheets.length+" worksheets, "+"but this version of IPython can only handle the first.  "+"If you save this notebook, worksheets after the first will be lost.");this.element.append(dialog);dialog.dialog({resizable:false,modal:true,title:"Multiple worksheets",closeText:"",close:function(event,ui){$(this).dialog('destroy').remove();},buttons:{"OK":function(){$(this).dialog('close');}},width:400});}};Notebook.prototype.toJSON=function(){var cells=this.get_cells();var ncells=cells.length;var cell_array=new Array(ncells);for(var i=0;i<ncells;i++){cell_array[i]=cells[i].toJSON();};var data={worksheets:[{cells:cell_array,metadata:this.worksheet_metadata}],metadata:this.metadata};return data;};Notebook.prototype.save_notebook=function(){var data=this.toJSON();data.metadata.name=this.notebook_name;data.nbformat=this.nbformat;data.nbformat_minor=this.nbformat_minor;var settings={processData:false,cache:false,type:"PUT",data:JSON.stringify(data),headers:{'Content-Type':'application/json'},success:$.proxy(this.save_notebook_success,this),error:$.proxy(this.save_notebook_error,this)};$([IPython.events]).trigger('notebook_saving.Notebook');var url=this.baseProjectUrl()+'notebooks/'+this.notebook_id;$.ajax(url,settings);};Notebook.prototype.save_notebook_success=function(data,status,xhr){this.dirty=false;$([IPython.events]).trigger('notebook_saved.Notebook');};Notebook.prototype.save_notebook_error=function(xhr,status,error_msg){$([IPython.events]).trigger('notebook_save_failed.Notebook');};Notebook.prototype.load_notebook=function(notebook_id){var that=this;this.notebook_id=notebook_id;var settings={processData:false,cache:false,type:"GET",dataType:"json",success:$.proxy(this.load_notebook_success,this),error:$.proxy(this.load_notebook_error,this),};$([IPython.events]).trigger('notebook_loading.Notebook');var url=this.baseProjectUrl()+'notebooks/'+this.notebook_id;$.ajax(url,settings);};Notebook.prototype.load_notebook_success=function(data,status,xhr){this.fromJSON(data);if(this.ncells()===0){this.insert_cell_below('code');};this.dirty=false;this.select(0);this.scroll_to_top();if(data.orig_nbformat!==undefined&&data.nbformat!==data.orig_nbformat){msg="This notebook has been converted from an older "+"notebook format (v"+data.orig_nbformat+") to the current notebook "+"format (v"+data.nbformat+"). The next time you save this notebook, the "+"newer notebook format will be used and older verions of IPython "+"may not be able to read it. To keep the older version, close the "+"notebook without saving it.";var dialog=$('<div/>');dialog.html(msg);this.element.append(dialog);dialog.dialog({resizable:false,modal:true,title:"Notebook converted",closeText:"",close:function(event,ui){$(this).dialog('destroy').remove();},buttons:{"OK":function(){$(this).dialog('close');}},width:400});}else if(data.orig_nbformat_minor!==undefined&&data.nbformat_minor!==data.orig_nbformat_minor){var that=this;var orig_vs='v'+data.nbformat+'.'+data.orig_nbformat_minor;var this_vs='v'+data.nbformat+'.'+this.nbformat_minor;var msg="This notebook is version "+orig_vs+", but we only fully support up to "+
this_vs+".  You can still work with this notebook, but some features "+"introduced in later notebook versions may not be available."
var dialog=$('<div/>');dialog.html(msg);this.element.append(dialog);dialog.dialog({resizable:false,modal:true,title:"Newer Notebook",closeText:"",close:function(event,ui){$(this).dialog('destroy').remove();},buttons:{"OK":function(){$(this).dialog('close');}},width:400});}
if(!this.read_only){this.start_kernel();}
$([IPython.events]).trigger('notebook_loaded.Notebook');};Notebook.prototype.load_notebook_error=function(xhr,textStatus,errorThrow){if(xhr.status===500){var msg="An error occurred while loading this notebook. Most likely "+"this notebook is in a newer format than is supported by this "+"version of IPython. This version can load notebook formats "+"v"+this.nbformat+" or earlier.";var dialog=$('<div/>');dialog.html(msg);this.element.append(dialog);dialog.dialog({resizable:false,modal:true,title:"Error loading notebook",closeText:"",close:function(event,ui){$(this).dialog('destroy').remove();},buttons:{"OK":function(){$(this).dialog('close');}},width:400});}}
IPython.Notebook=Notebook;return IPython;}(IPython));var IPython=(function(IPython){"use strict";var utils=IPython.utils;var NotificationWidget=function(selector){this.selector=selector;this.timeout=null;this.busy=false;if(this.selector!==undefined){this.element=$(selector);this.style();}
this.element.button();this.element.hide();var that=this;};NotificationWidget.prototype.style=function(){this.element.addClass('notification_widget ui-widget ui-widget-content ui-corner-all');this.element.addClass('border-box-sizing');};NotificationWidget.prototype.set_message=function(msg,timeout,click_callback){var callback=click_callback||function(){return false;};var that=this;this.element.html(msg);this.element.fadeIn(100);if(this.timeout!==null){clearTimeout(this.timeout);this.timeout=null;}
if(timeout!==undefined&&timeout>=0){this.timeout=setTimeout(function(){that.element.fadeOut(100,function(){that.element.html('');});that.timeout=null;},timeout);}else{this.element.click(function(){if(callback()!=false){that.element.fadeOut(100,function(){that.element.html('');});that.element.unbind('click');}
if(that.timeout!==undefined){that.timeout=undefined;clearTimeout(that.timeout);}});}};NotificationWidget.prototype.get_message=function(){return this.element.html();};IPython.NotificationWidget=NotificationWidget;return IPython;}(IPython));var IPython=(function(IPython){"use strict";var utils=IPython.utils;var NotificationArea=function(selector){this.selector=selector;if(this.selector!==undefined){this.element=$(selector);}
this.widget_dict={};};NotificationArea.prototype.temp_message=function(msg,timeout,css_class){var uuid=utils.uuid();if(css_class=='danger'){css_class='ui-state-error';}
if(css_class=='warning'){css_class='ui-state-highlight';}
var tdiv=$('<div>').attr('id',uuid).addClass('notification_widget ui-widget ui-widget-content ui-corner-all').addClass('border-box-sizing').addClass(css_class).hide().text(msg);$(this.selector).append(tdiv);var tmout=Math.max(1500,(timeout||1500));tdiv.fadeIn(100);setTimeout(function(){tdiv.fadeOut(100,function(){tdiv.remove();});},tmout);};NotificationArea.prototype.widget=function(name){if(this.widget_dict[name]==undefined){return this.new_notification_widget(name);}
return this.get_widget(name);};NotificationArea.prototype.get_widget=function(name){if(this.widget_dict[name]==undefined){throw('no widgets with this name');}
return this.widget_dict[name];};NotificationArea.prototype.new_notification_widget=function(name){if(this.widget_dict[name]!=undefined){throw('widget with that name already exists ! ');}
var div=$('<div/>').attr('id','notification_'+name);$(this.selector).append(div);this.widget_dict[name]=new IPython.NotificationWidget('#notification_'+name);return this.widget_dict[name];};NotificationArea.prototype.init_notification_widgets=function(){var knw=this.new_notification_widget('kernel');$([IPython.events]).on('status_idle.Kernel',function(){IPython.save_widget.update_document_title();knw.set_message('Kernel Idle',200);});$([IPython.events]).on('status_busy.Kernel',function(){window.document.title='(Busy) '+window.document.title;knw.set_message("Kernel busy");});$([IPython.events]).on('status_restarting.Kernel',function(){IPython.save_widget.update_document_title();knw.set_message("Restarting kernel",1000);});$([IPython.events]).on('status_interrupting.Kernel',function(){knw.set_message("Interrupting kernel");});$([IPython.events]).on('status_dead.Kernel',function(){var dialog=$('<div/>');dialog.html('The kernel has died, would you like to restart it?'+' If you do not restart the kernel, you will be able to save'+' the notebook, but running code will not work until the notebook'+' is reopened.');$(document).append(dialog);dialog.dialog({resizable:false,modal:true,title:"Dead kernel",close:function(event,ui){$(this).dialog('destroy').remove();},buttons:{"Restart":function(){$([IPython.events]).trigger('status_restarting.Kernel');IPython.notebook.start_kernel();$(this).dialog('close');},"Don't restart":function(){$(this).dialog('close');}}});});$([IPython.events]).on('websocket_closed.Kernel',function(event,data){var kernel=data.kernel;var ws_url=data.ws_url;var early=data.early;var msg;if(!early){knw.set_message('Reconnecting WebSockets',1000);setTimeout(function(){kernel.start_channels();},5000);return;}
console.log('WebSocket connection failed: ',ws_url)
msg="A WebSocket connection to could not be established."+" You will NOT be able to run code. Check your"+" network connection or notebook server configuration.";var dialog=$('<div/>');dialog.html(msg);$(document).append(dialog);dialog.dialog({resizable:false,modal:true,title:"WebSocket connection failed",closeText:"",close:function(event,ui){$(this).dialog('destroy').remove();},buttons:{"OK":function(){$(this).dialog('close');},"Reconnect":function(){knw.set_message('Reconnecting WebSockets',1000);setTimeout(function(){kernel.start_channels();},5000);$(this).dialog('close');}}});});var nnw=this.new_notification_widget('notebook');$([IPython.events]).on('notebook_loading.Notebook',function(){nnw.set_message("Loading notebook",500);});$([IPython.events]).on('notebook_loaded.Notebook',function(){nnw.set_message("Notebook loaded",500);});$([IPython.events]).on('notebook_saving.Notebook',function(){nnw.set_message("Saving notebook",500);});$([IPython.events]).on('notebook_saved.Notebook',function(){nnw.set_message("Notebook saved",2000);});$([IPython.events]).on('notebook_save_failed.Notebook',function(){nnw.set_message("Notebook save failed");});};IPython.NotificationArea=NotificationArea;return IPython;}(IPython));var IPython=(function(IPython){"use strict";var utils=IPython.utils;var Tooltip=function(){var that=this;this.time_before_tooltip=1200;this.tooltip=$('#tooltip');this._hidden=true;this._old_cell=null;this._old_request=null;this._consecutive_counter=0;this._sticky=false;this.buttons=$('<div/>').addClass('tooltipbuttons');this.text=$('<div/>').addClass('tooltiptext').addClass('smalltooltip');var expandlink=$('<a/>').attr('href',"#").addClass("ui-corner-all").attr('role',"button").attr('id','expanbutton').attr('title','Grow the tooltip vertically (press tab 2 times)').click(function(){that.expand()}).append($('<span/>').text('Expand').addClass('ui-icon').addClass('ui-icon-plus'));var morelink=$('<a/>').attr('href',"#").attr('role',"button").addClass('ui-button').attr('title','show the current docstring in pager (press tab 4 times)');var morespan=$('<span/>').text('Open in Pager').addClass('ui-icon').addClass('ui-icon-arrowstop-l-n');morelink.append(morespan);morelink.click(function(){that.showInPager();});var closelink=$('<a/>').attr('href',"#").attr('role',"button").addClass('ui-button');var closespan=$('<span/>').text('Close').addClass('ui-icon').addClass('ui-icon-close');closelink.append(closespan);closelink.click(function(){that.remove_and_cancel_tooltip(true);});this._clocklink=$('<a/>').attr('href',"#");this._clocklink.attr('role',"button");this._clocklink.addClass('ui-button');this._clocklink.attr('title','Tootip is not dismissed while typing for 10 seconds');var clockspan=$('<span/>').text('Close');clockspan.addClass('ui-icon');clockspan.addClass('ui-icon-clock');this._clocklink.append(clockspan);this._clocklink.click(function(){that.cancel_stick();});this.buttons.append(closelink);this.buttons.append(expandlink);this.buttons.append(morelink);this.buttons.append(this._clocklink);this._clocklink.hide();this.arrow=$('<div/>').addClass('pretooltiparrow');this.tooltip.append(this.buttons);this.tooltip.append(this.arrow);this.tooltip.append(this.text);this.tabs_functions=[function(cell,text){that._request_tooltip(cell,text);},function(){that.expand();},function(){that.stick();},function(cell){that.cancel_stick();that.showInPager(cell);}];this.reset_tabs_function=function(cell,text){this._old_cell=(cell)?cell:null;this._old_request=(text)?text:null;this._consecutive_counter=0;}};Tooltip.prototype.showInPager=function(cell){var that=this;var empty=function(){};cell.kernel.execute(that.name+'?',{'execute_reply':empty,'output':empty,'clear_output':empty,'cell':cell},{'silent':false});this.remove_and_cancel_tooltip();}
Tooltip.prototype.expand=function(){this.text.removeClass('smalltooltip');this.text.addClass('bigtooltip');$('#expanbutton').hide('slow');}
Tooltip.prototype._hide=function(){this.tooltip.fadeOut('fast');$('#expanbutton').show('slow');this.text.removeClass('bigtooltip');this.text.addClass('smalltooltip');this.text.scrollTop(0);this._hidden=true;this.code_mirror=null;}
Tooltip.prototype.remove_and_cancel_tooltip=function(force){if(this._sticky==false||force==true){this.cancel_stick();this._hide();}
this.cancel_pending();this.reset_tabs_function();}
Tooltip.prototype.cancel_pending=function(){if(this._tooltip_timeout!=null){clearTimeout(this._tooltip_timeout);this._tooltip_timeout=null;}}
Tooltip.prototype.pending=function(cell){var that=this;this._tooltip_timeout=setTimeout(function(){that.request(cell)},that.time_before_tooltip);}
Tooltip.prototype._request_tooltip=function(cell,func){var matchBracket=/\([^\(\)]+\)/g;var endBracket=/\([^\(]*$/g;var oldfunc=func;func=func.replace(matchBracket,"");while(oldfunc!=func){oldfunc=func;func=func.replace(matchBracket,"");}
func=func.replace(endBracket,"");var re=/[a-z_][0-9a-z._]+$/gi;var callbacks={'object_info_reply':$.proxy(this._show,this)}
var msg_id=cell.kernel.object_info_request(re.exec(func),callbacks);}
Tooltip.prototype.request=function(cell){this.cancel_pending();var editor=cell.code_mirror;var cursor=editor.getCursor();var text=editor.getRange({line:cursor.line,ch:0},cursor).trim();if(editor.somethingSelected()){text=editor.getSelection();}
this.code_mirror=editor;if(this._old_cell==cell&&this._old_request==text&&this._hidden==false){this._consecutive_counter++;}else{this.cancel_stick();this.reset_tabs_function(cell,text);}
if(text===""||text==="("){return;}
this.tabs_functions[this._consecutive_counter](cell,text);if(this._consecutive_counter==this.tabs_functions.length)this.reset_tabs_function(cell,text);return;}
Tooltip.prototype.cancel_stick=function(){clearTimeout(this._stick_timeout);this._stick_timeout=null;this._clocklink.hide('slow');this._sticky=false;}
Tooltip.prototype.stick=function(time){time=(time!=undefined)?time:10;var that=this;this._sticky=true;this._clocklink.show('slow');this._stick_timeout=setTimeout(function(){that._sticky=false;that._clocklink.hide('slow');},time*1000);}
Tooltip.prototype._show=function(reply){this.name=reply.name;var w=$(this.code_mirror.getScrollerElement()).width();var o=$(this.code_mirror.getScrollerElement()).offset();var anchor=this.code_mirror.cursorCoords(false);var head=this.code_mirror.cursorCoords(true);var pos={};pos.y=head.y
pos.yBot=head.yBot
pos.x=(head.x+anchor.x)/2;var xinit=pos.x;var xinter=o.left+(xinit-o.left)/w*(w-450);var posarrowleft=xinit-xinter;if(this._hidden==false){this.tooltip.animate({'left':xinter-30+'px','top':(pos.yBot+10)+'px'});}else{this.tooltip.css({'left':xinter-30+'px'});this.tooltip.css({'top':(pos.yBot+10)+'px'});}
this.arrow.animate({'left':posarrowleft+'px'});this.tooltip.fadeIn('fast');this._hidden=false;var defstring=reply.call_def;if(defstring==null){defstring=reply.init_definition;}
if(defstring==null){defstring=reply.definition;}
var docstring=reply.call_docstring;if(docstring==null){docstring=reply.init_docstring;}
if(docstring==null){docstring=reply.docstring;}
if(docstring==null){docstring="<empty docstring>";}
this.text.children().remove();var pre=$('<pre/>').html(utils.fixConsole(docstring));if(defstring){var defstring_html=$('<pre/>').html(utils.fixConsole(defstring));this.text.append(defstring_html);}
this.text.append(pre);this.text.scrollTop(0);}
IPython.Tooltip=Tooltip;return IPython;}(IPython));var IPython=(function(IPython){var default_config={cell_magic_highlight:{'magic_javascript':{'reg':[/^%%javascript/]},'magic_perl':{'reg':[/^%%perl/]},'magic_ruby':{'reg':[/^%%ruby/]},'magic_python':{'reg':[/^%%python3?/]},'magic_shell':{'reg':[/^%%bash/]},'magic_r':{'reg':[/^%%R/]}},raw_cell_highlight:{'diff':{'reg':[/^diff/]}},tooltip_on_tab:true,};IPython.config={};$.extend(IPython.config,default_config);return IPython;}(IPython));$(document).ready(function(){if(CodeMirror.getMode(1,'text/plain').indent==undefined){console.log('patching CM for undefined indent');CodeMirror.modes.null=function(){return{token:function(stream){stream.skipToEnd();},indent:function(){return 0}}}}
CodeMirror.patchedGetMode=function(config,mode){var cmmode=CodeMirror.getMode(config,mode);if(cmmode.indent==null)
{console.log('patch mode "',mode,'" on the fly');cmmode.indent=function(){return 0};}
return cmmode;}
IPython.mathjaxutils.init();IPython.read_only=$('body').data('readOnly')==='True';$('#ipython-main-app').addClass('border-box-sizing');$('div#notebook_panel').addClass('border-box-sizing');$('div#header').css('border-bottom-style','none');var baseProjectUrl=$('body').data('baseProjectUrl')
IPython.page=new IPython.Page();IPython.markdown_converter=new Markdown.Converter();IPython.layout_manager=new IPython.LayoutManager();IPython.pager=new IPython.Pager('div#pager','div#pager_splitter');IPython.quick_help=new IPython.QuickHelp('span#quick_help_area');IPython.login_widget=new IPython.LoginWidget('span#login_widget',{baseProjectUrl:baseProjectUrl});IPython.notebook=new IPython.Notebook('div#notebook',{baseProjectUrl:baseProjectUrl,read_only:IPython.read_only});IPython.save_widget=new IPython.SaveWidget('span#save_widget');IPython.menubar=new IPython.MenuBar('#menubar',{baseProjectUrl:baseProjectUrl})
IPython.toolbar=new IPython.MainToolBar('#maintoolbar')
IPython.tooltip=new IPython.Tooltip()
IPython.notification_area=new IPython.NotificationArea('#notification_area')
IPython.notification_area.init_notification_widgets();IPython.layout_manager.do_resize();$('body').append('<div id="fonttest"><pre><span id="test1">x</span>'+'<span id="test2" style="font-weight: bold;">x</span>'+'<span id="test3" style="font-style: italic;">x</span></pre></div>')
var nh=$('#test1').innerHeight();var bh=$('#test2').innerHeight();var ih=$('#test3').innerHeight();if(nh!=bh||nh!=ih){$('head').append('<style>.CodeMirror span { vertical-align: bottom; }</style>');}
$('#fonttest').remove();if(IPython.read_only){$('div#pager').remove();$('div#pager_splitter').remove();$('#notebook_name').attr('disabled','disabled')}
IPython.page.show();IPython.layout_manager.do_resize();$([IPython.events]).on('notebook_loaded.Notebook',function(){IPython.layout_manager.do_resize();});IPython.notebook.load_notebook($('body').data('notebookId'));});(function(){"use strict";function forEach(arr,f){for(var i=0,e=arr.length;i<e;++i)f(arr[i]);}
function arrayContains(arr,item){if(!Array.prototype.indexOf){var i=arr.length;while(i--){if(arr[i]===item){return true;}}
return false;}
return arr.indexOf(item)!=-1;}
CodeMirror.contextHint=function(editor){var cur=editor.getCursor(),token=editor.getTokenAt(cur),tprop=token;var list=new Array();var clist=getCompletions(token,editor);for(var i=0;i<clist.length;i++){list.push({str:clist[i],type:"context",from:{line:cur.line,ch:token.start},to:{line:cur.line,ch:token.end}})}
return list;}
var getAllTokens=function(editor){var found=[];function maybeAdd(str){if(!arrayContains(found,str))found.push(str);}
var lineCount=editor.lineCount();for(var l=0;l<lineCount;l++){var line=editor.getLine(l);for(var c=1;c<line.length;c++){var tk=editor.getTokenAt({line:l,ch:c});if(tk.className!=null){maybeAdd(tk.string);}
c=tk.end;}}
return found;}
function getCompletions(token,editor){var candidates=getAllTokens(editor);var lambda=function(x){return(x.indexOf(token.string)==0&&x!=token.string)};var filterd=candidates.filter(lambda);return filterd;}})();(function(IPython){"use strict";var CellToolbar=IPython.CellToolbar;var raw_edit=function(cell){var md=cell.metadata
var error_div=$('<div/>').css('color','red')
var textarea=$('<textarea/>').attr('rows','13').attr('cols','75').attr('name','metadata').text(JSON.stringify(md,null,4)||'');var dialogform=$('<div/>').attr('title','Edit the metadata').append($('<form/>').append($('<fieldset/>').append($('<label/>').attr('for','metadata').text("Manually edit the JSON below to manipulate the metadata for this cell. This assumes you know what you are doing and won't complain if it breaks your notebook. We also recommend putting your metadata attributes in an appropriately named sub-structure, so they don't conflict with those of others.")).append(error_div).append($('<br/>')).append(textarea)));var editor=CodeMirror.fromTextArea(textarea[0],{lineNumbers:true,matchBrackets:true,});$(dialogform).dialog({autoOpen:true,height:300,width:650,modal:true,buttons:{"Ok":function(){try{var json=JSON.parse(editor.getValue());cell.metadata=json;$(this).dialog("close");}
catch(e)
{error_div.text('Warning, invalid json, not saved');}},Cancel:function(){$(this).dialog("close");}},close:function(){$(this).remove();}});editor.refresh();}
var add_raw_edit_button=function(div,cell){var button_container=div
var button=$('<div/>').button({label:'Raw Edit'}).click(function(){raw_edit(cell);return false;})
button_container.append(button);}
CellToolbar.register_callback('default.rawedit',add_raw_edit_button);var example_preset=[]
example_preset.push('default.rawedit');CellToolbar.register_preset('Default',example_preset);console.log('Default extension for metadata editing loaded.');}(IPython));(function(IPython){"use strict";var CellToolbar=IPython.CellToolbar;var slideshow_preset=[];var select_type=CellToolbar.utils.select_ui_generator([["-",undefined],["Slide","slide"],["Sub-Slide","subslide"],["Fragment","fragment"],["Skip","skip"],["Notes","notes"],],function(cell,value){if(cell.metadata.slideshow==undefined){cell.metadata.slideshow={}}
cell.metadata.slideshow.slide_type=value},function(cell){var ns=cell.metadata.slideshow;return(ns==undefined)?undefined:ns.slide_type},"Slide Type");CellToolbar.register_callback('slideshow.select',select_type);slideshow_preset.push('slideshow.select');CellToolbar.register_preset('Slideshow',slideshow_preset);console.log('Slideshow extension for metadata editing loaded.');}(IPython));